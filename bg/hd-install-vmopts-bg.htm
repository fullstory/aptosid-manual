<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>sidux Manuals - VM Installation Options</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<!-- Last translation revision by bluewater 22/04/2009 1350hrs UTC -->
<div id="menu"> <!-- menu starts here bg lang maintainer manul-->
<!--sidux-manual Operating System Manual menu-version-02.05.2010.04.10 -->
<!-- menu last updated by bluewater 2010.04.10 1300 hrs UTC -->
	<div id="menu-header">
<a href="http://sidux.com/"><img src="../lib/logos/manual-sidux-logo.png" title="Главна страница на sidux.com, форуми и вики" alt="sidux.com лого" /></a>
	</div>
	<ul id="top-list">
		<li><a href="manual-search-bg.htm#search-on"> <img src="../lib/logos/manual-search-22x22.png" title="Търсене в ръководството" alt="Търсене" />Търсене</a> </li>
		<li><a href="http://manual.sidux.com/meta-manual">Community Software Selections</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-lang-100x64.png" title="Избор на друг език - choose another language" alt="превключване на езика" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-bg.htm">Ръководство за sidux</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-bg.htm#welcome-gen">Добре дошли!</a></li>
				<li><a href="welcome-bg.htm#how-to">Как да използваме ръководството</a></li>
				<li><a href="welcome-bg.htm#table-contents">Съдържание</a></li>
				<li><a href="help-bg.htm#help-gen">Къде да получим помощ</a></li>
				<li><a href="help-bg.htm#paste">IRC !paste</a></li>
				<li><a href="credits-bg.htm#cred-team">Благодарности</a></li>
				<li><a href="wel-quickstart-bg.htm#welcome-quick">Кратко ръководство за sidux</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-dl-burning-bg.htm">ISO Content, Releases, Download Mirrors and Burning</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-bg.htm#cd-content">ISO Content and system requirements</a></li>
				<li><a href="sys-admin-release-bg.htm#rolling">Забележки (Release Notes)</a></li>
				<li><a href="cd-dl-burning-bg.htm#download-sidux">Сървъри на sidux, сваляне на образа и създаване на инсталационно CD</a></li>
				<li><a href="cd-dl-burning-bg.htm#md5">Контролна сума md5</a></li>
				<li><a href="cd-dl-burning-bg.htm#burn-nero">Създаване на инсталационно CD в Windows</a></li>
				<li><a href="cd-dl-burning-bg.htm#burn-linux">Създаване на инсталационно CD в Linux</a></li>
				<li><a href="cd-no-gui-burn-bg.htm#burning-bg-gui">Скрипт burniso за създаване на инсталационно CD</a></li>
				<li><a href="cd-no-gui-burn-bg.htm#burn-no-gui-gen">Създаване на инсталационно CD в терминален режим</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="live-mode-bg.htm">Режим LiveCD</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="live-mode-bg.htm#rootpw">root парола в LiveCD режим</a></li>
				<li><a href="live-mode-bg.htm#live-cd-installsoft">Инсталиране на софтуер в LiveCD режим</a></li>
				<li><a href="live-mode-bg.htm#ntfs-3g">Достъп към NTFS-форматирани раздели: ntfs-3g</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="term-konsole-bg.htm">Терминал (Конзола)</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="term-konsole-bg.htm#sux">Командата  sux / sudo</a></li>
				<li><a href="term-konsole-bg.htm#term-kon">Терминал (Конзола)</a></li>
				<li><a href="term-konsole-bg.htm#cli-help">Помощ в терминален режим</a></li>
				<li><a href="help-bg.htm#init3-tools">Tools to know in text mode (tty) - init 3</a></li>
				<li><a href="term-konsole-bg.htm#term-cmds">Команди в терминален режим</a></li>
				<li><a href="term-konsole-bg.htm#shell-scripts">Скриптове</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="cheatcodes-bg.htm">Опции при стартиране</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="cheatcodes-bg.htm#cheatcodes">Специфични за sidux LiveCD опции при стартиране на системата</a></li>
				<li><a href="cheatcodes-bg.htm#cheatcodes-linux">Общи за Linux опции при стартиране на системата</a></li>
				<li><a href="cheatcodes-vga-bg.htm#vga">VGA опции при стартиране</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="part-gparted-bg.htm">Разделяне на диска</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="part-gparted-bg.htm#partition">Разделяне на хард-диска с помощта на GParted</a></li>
				<li><a href="part-gparted-bg.htm#ntfs">Промяна на размерите на NTFS-раздели с GParted</a></li>
				<li><a href="part-uuid-bg.htm#uuid">Раздели: идентификатори и псевдоними, файл fstab</a></li>
				<li><a href="part-cfdisk-bg.htm#disknames">Конвенция за имената на дисковете в Linux</a></li>
				<li><a href="part-cfdisk-bg.htm#partition">Разделяне на хард-диска с помощта на cfdisk</a></li>
				<li><a href="part-cfdisk-bg.htm#formating">Форматиране на разделите с помощта на cfdisk след разделяне</a></li>
				<li><a href="part-size-examp-bg.htm#part-example">Примери за разделяне на хард-диска</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="hd-install-bg.htm">Инсталиране на sidux</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="hd-install-bg.htm#Inst-prep">Подготовка</a></li>
				<li><a href="hd-install-bg.htm#Installation">Инсталиране върху хард-диска</a></li>
				<li><a href="hd-install-bg.htm#first-hd-boot">Първо стартиране на системата</a></li>
				<li><a href="hd-install-opts-bg.htm#fromiso">Стартиране от iso-образ - Overview</a></li>
				<li><a href="hd-install-opts-bg.htm#fromiso-grub-leg">Booting 'fromiso' with grub-legacy</a></li>
				<li><a href="hd-install-opts-bg.htm#grub2-fromiso">Booting 'fromiso' with Grub 2</a></li>
				<li><a href="hd-install-opts-bg.htm#fromiso-persist">Методи fromiso и persist</a></li>
				<li><a href="hd-install-opts-bg.htm#usb-hd">Инсталиране върху USB-диск (флаш) - sidux specific - sidux-on-stick</a></li>
				<li><a href="hd-ins-opts-oos-bg.htm#raw-usb">Writing sidux to a USB/SSD stick with any Linux, MS Windows or Mac OS X system</a></li>
				<li><a href="nbdboot-bg.htm#nbd1">Booting sidux over a network</a></li>
				<li><a href="hd-install-vmopts-bg.htm#vm">Virtual Machine installation options</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-bg.htm">Видеокарти, монитори, Xorg и други драйвери</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hw-dev-hw-dri-bg.htm#hd-ntfs3g">Достъп към NTFS-форматирани раздели: ntfs-3g</a></li>
				<li><a href="hw-dev-mon-bg.htm#mon-res">Разделителна способност на екрана и монитори</a></li>
				<li><a href="hw-dev-mon-bg.htm#xrandr">Двумониторен режим и xrandr</a></li>
				<li><a href="hw-dev-mon-bg.htm#mon-binary">Двумониторен режим (несвободни драйвери)</a></li>
				<li><a href="hw-dev-hw-dri-bg.htm#non-free-3d">Несвободни бинарни драйвери за Nvidia  видеокарти &amp; xorg.conf</a></li>
				<li><a href="hw-dev-hw-dri-bg.htm#non-free-3d-2">non-free drivers for ATI, Radeon and others</a></li>
				<li><a href="hw-dev-hw-dri-bg.htm#non-free-firmware">Hardware needing non-free firmware drivers</a></li>
				<li><a href="hw-dev-hw-dri-bg.htm#non-free">Adding non-free to Sources List</a></li>
				<li><a href="hw-dev-hw-dri-bg.htm#native-nv-ati">FOSS xorg drivers for nVidia, ATI, Radeon, Intel &amp; xorg.conf</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="wm-kde-bg.htm">Прозоречни мениджъри</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="wm-xfce-bg.htm#xfce-notes">Полезни съвети за Xfce</a></li>
				<li><a href="wm-kde-bg.htm#install-add">Полезни съвети за KDE</a></li>
				<li><a href="wm-kde-bg.htm#desk-freeze">KDE "зависва"</a></li>
				<li><a href="wm-kde-bg.htm#kde-login">Проблеми с логване в KDE</a></li>
				<li><a href="wm-kde-bg.htm#ch-th">Сменяне на темите</a></li>
				<li><a href="wm-kde-bg.htm#dm">Display Managers - dm</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="lamp-apache-bg.htm">Програмен комплекс LAMP в sidux</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="lamp-apache-bg.htm#serv-apache">Какво е LAMP</a></li>
				<li><a href="lamp-apache-bg.htm#serv-ftp">FTP клиенти</a></li>
				<li><a href="lamp-apache-bg.htm#serv-sec">Защитени протоколи</a></li>
				<li><a href="lamp-apache-bg.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-bg.htm#serv-mysql">MySQL настройка</a></li>
				<li><a href="lamp-ppp-bg.htm#serv-php">PHP и Apache</a></li>
				<li><a href="ntp-server-bg.htm#ntp-server">Синхронизация на времето</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="internet-connecting-bg.htm">Интернет и Мрежи</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="tor-privoxy-bg.htm#tor">Анонимизиращ маршрутизатор Tor</a></li>
				<li><a href="tor-privoxy-bg.htm#privoxy">Прокси Privoxy</a></li>
				<li><a href="internet-connecting-bg.htm#firewalls">Защитна стена (firewall)</a></li>
				<li><a href="samba-bg.htm#configure">Интеграция в Windows мрежа</a></li>
				<li><a href="samba-bg.htm#setup">Мрежов сървър Samba - настройки</a></li>
				<li><a href="ssh-bg.htm#ssh-fs">Монтиране през мрежата чрез SSH</a></li>
				<li><a href="ssh-bg.htm#ssh-x">Десктоп програми през мрежата чрез SSH</a></li>
				<li><a href="ssh-bg.htm#ssh-f">SSH и Konqueror</a></li>
				<li><a href="ssh-bg.htm#ssh-w">SSH десктоп-пренасочване към Windows-PC</a></li>
				<li><a href="ssh-bg.htm#ssh">SSH и безопасност</a></li>
				<li><a href="internet-connecting-bg.htm#dial-mod">56k модеми</a></li>
				<li><a href="inet-wpagui-bg.htm#wpa-roaming-gui">WiFi - WPA_GUI</a></li>
				<li><a href="inet-setup-bg.htm#net-set1">WiFi - Setting up for WiFi Roaming</a></li>
				<li><a href="internet-connecting-wpa-bg.htm#wpa">WiFi - wpasupplicant</a></li>
				<li><a href="inet-ifplug-bg.htm#hotswitch">Network switching between WiFi and Cable</a></li>
				<li><a href="internet-connecting-bg.htm#netcardconfig">Включване към интернет - Ceni</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="sys-admin-apt-bg.htm">Инсталиране на програми и обновяване на системата</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="sys-admin-apt-bg.htm#apt-cook">APT, хранилища и указатели към хранилищата</a></li>
				<li><a href="sys-admin-apt-bg.htm#apt-install">Инсталиране на нови пакети</a></li>
				<li><a href="sys-admin-apt-bg.htm#apt-delete">Премахване на пакети</a></li>
				<li><a href="sys-admin-apt-bg.htm#apt-downgrade">Забрана за обновяване на пакети, понижаване на версия</a></li>
				<li><a href="sys-admin-apt-bg.htm#apt-cache">Търсене в пакетите с apt-cache</a></li>
				<li><a href="sys-admin-apt-bg.htm#gui-pacsea">GUI Package searching</a></li>
				<li><a href="sys-admin-upgrade-bg.htm#live-cd-upgrade">Обновяване от Live-CD</a></li>
				<li><a href="sys-admin-apt-locarmirr-bg.htm#approx">dist-upgrade of multiple PCs on a LAN</a></li>
				<li><a href="sys-admin-kern-upg-bg.htm#kern-upgrade">Обновяване на ядрото</a></li>
				<li><a href="sys-admin-kern-upg-bg.htm#dmakms">Installing kernel modules dynamically with dmakms</a></li>
				<li><a href="sys-admin-apt-bg.htm#apt-upgrade">Обновяване на инсталирана система - dist-upgrade - Overview</a></li>
				<li><a href="sys-admin-apt-bg.htm#du-st">Обновяване на инсталирана система -  dist-upgrade - The Steps</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-gen-bg.htm">Системно  администриране</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="hd-install-bg.htm#adduser">Adding a new user</a></li>
				<li><a href="home-bg.htm#home-bu">Преместване на /home</a></li>
				<li><a href="sys-admin-rdiff-bg.htm#rdiff">Резервни копия - rdiff</a></li>
				<li><a href="sys-admin-rsync-bg.htm#rsync">Резервни копия - rsync</a></li>
				<li><a href="vir-rkits-bg.htm#virus-rkits">Скeнери за вируси и вредоносен софтуер</a></li>
				<li><a href="sys-admin-gen-bg.htm#start-services">Демони (фонови програми) - включване и изключване</a></li>
				<li><a href="sys-admin-gen-bg.htm#pw-lost">Забравена root парола</a></li>
				<li><a href="sys-admin-gen-bg.htm#fonts">Шрифтове</a></li>
				<li><a href="sys-admin-gen-bg.htm#cups">CUPS (принтери)</a></li>
				<li><a href="sys-admin-gen-bg.htm#sound">Sound Mixers</a></li>
				<li><a href="sys-admin-gen-bg.htm#init">sidux нива на работа - init</a></li>
				<li><a href="bios-freedos-bg.htm#bois-prep">Обновяване на BIOS-а през FreeDOS</a></li>
				<li><a href="sys-admin-grub-bootman2-bg.htm#boot-grub-floppy">Създаване на стартиращ флопи-диск</a></li>
				<li><a href="sys-admin-grub-bootman2-bg.htm#mbr-grub-boot">Grub1 - Възстановяване на стартиращия сектор MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-bg.htm#dual-boot">Grub1 - Две и повече операционни системи</a></li>
				<li><a href="sys-admin-grub-bootman2-bg.htm#remove-grub">Премахване на grub от MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-bg.htm#what-is-grub">Стартиращ мениджър grub</a></li>
				<li><a href="sys-admin-grub2-bg.htm#mbr-over-grub2">Grub2 - MBR Overwritten</a></li>
				<li><a href="sys-admin-grub2-bg.htm#multi-os">Grub2 - Dual and Multibooting</a></li>
				<li><a href="sys-admin-grub2-bg.htm#grub1-grub2">Grub2 -Upgrading from Grub1</a></li>
				<li><a href="sys-admin-grub2-bg.htm#grub2">Grub2 - Overview</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
		<div class="divider" id="vmopts">
				<h2 id="top-header">Virtual Machine options</h2>

						<ul>
							<li><a href="hd-install-vmopts-bg.htm#kvm">KVM for Intel VT or AMD-V</a></li>
							<li><a href="hd-install-vmopts-bg.htm#vbox">Virtualbox</a></li>
							<li><a href="hd-install-vmopts-bg.htm#qemu">QEMU</a></li>

						</ul>
		      </div>
		      <div class="divider" id="kvm">
				<h2>Booting and installing sidux to a KVM Virtual Machine</h2>
							<p>KVM is a full virtualisation solution for Linux on x86 hardware containing virtualisation extensions (Intel VT or AMD-V).</p>

				      <h3>Prerequisites</h3>

							<p>To ascertain whether your hardware supports KVM, ensure that KVM is enabled in the BIOS (in some cases on an Intel VT or AMD-V system it may not evident as to where the switch is, therefore assume that it is in a KVM state). The way to check is in a console run:</p>
<pre>
cat /proc/cpuinfo | egrep --color=always 'vmx|smx'
</pre>
							<p>If you see <span class="highlight-3">smx</span> or <span class="highlight-3">vmx</span> in the cpu flags field, your system supports KVM. (Otherwise go back to the BIOS if you believe it is supported and check again, else search the internet as to where in the BIOS menus KVM 'enable' could be hiding).</p>

							<p>Should your BIOS not support KVM refer to <a href="hd-install-vmopts-bg.htm#vbox">Virtualbox</a>
							 or <a href="hd-install-vmopts-bg.htm#qemu">QEMU</a></p>

							<p>To install and run KVM, firstly ensure that Virtualbox modules are not loaded, (--purge them is the best option), then depending on your chipset:</p>

							<p>For <span class="highlight-3">vmx</span>:</p>
<pre>
apt-get install qemu-kvm
modprobe kvm_intel
</pre>
							<p>For <span class="highlight-3">smx</span>:</p>
<pre>
apt-get install qemu-kvm
modprobe kvm_amd
</pre>
							 <p>Another option is reboot as the qemu-kvm initscripts will take care of loading the modules.</p>

					  <h4>Using KVM to boot a sidux-*.iso</h4>

							<p><span class="highlight-2">As user:</span></p>
<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -cdrom &lt;sidux.iso&gt;
</pre>

				<h5>Installing a sidux-*.iso to a KVM image</h5>
							<p>First create a hard disk image, (this image will be minimal and only grow as required due to qcow2 compression ratios):</p>
<pre>
$ qemu-img create -f qcow2 sidux-2010-*-.img 12G
</pre>

							<p>Boot the sidux-*.iso with the following parameters to enable KVM to recognise that there is an QEMU hard disk image available:</p>
<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -cdrom &lt;/path/to/sidux.iso&gt; -boot d &lt;/path/to/sidux-20xx-*-.img&gt;
</pre>

							<p>Once the cdrom has booted up click on the sidux installer icon to activate the installer, (or use the menu), click on the Partitioning tab and you should see on the left hand side a box that has a disk ready for partitioning and formatting, most likely noted as <span class="highlight-3"> /dev/sda</span>. Underneath that are the options for partitioning, choose gparted.</p>

	<div class="screenshot"><img src="../lib/images-common/images-vm/kvm-gparted02.png" title="gparted kvm hard disk naming" alt="gparted kvm hard disk naming" /></div>
	<div class="spacer02"></div>

							<p>In the Gparted menu you can confirm that Gparted sees the image with <span class="highlight-3">View>Device Information</span> which should state it is a <span class="highlight-3">ATA QEMU Harddisk</span> and most likely noted as <span class="highlight-3"> /dev/sda</span>,(in this example), as this will be crucial when moving back to the installer and choosing where to put Grub, as it needs to go to <span class="highlight-3"> /dev/sda</span>.</p>

							<p>Next, in the <span class="highlight-3">Partition</span> menu choose <span class="highlight-3"> Device>Create Partiton Table</span> and create the partition table. </p>

							<p>Then format the partition table with ext4 and also include a swap of 2 gig. The formatting will take time so be patient.</p>

							<p>After formatting has completed, click OK to be returned to the installer and proceed as if you are performing a standard install, (again, be patient). <span class="highlight-2">Note: Install the Grub to /dev/sda</span>.</p>

							<p>You now have a sidux-*-VM ready for use:</p>

<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -drive if=virtio,boot=on,file=&lt;absolute/path/to/sidux-20xx-*.img&gt;
</pre>

							<p>If the guest does not support virtio, or you do not specify an absolute path,  use:</p>
<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -hda &lt;/path/to/sidux-20xx-*.img&gt;
</pre>
							<p>See also:</p>
<pre>
$ man kvm
</pre>
				<h5>Managing your KVM virtual machine installations</h5>
<pre>
apt-get install aqemu
</pre>
							<p>When using AQEMU ensure that you choose the KVM mode from the drop down box for 'Emulator Type' in the 'General' tab. (Documentation for AQEMU is basically non existent, therefore a few 'trials by error' will be required to figure out the easy to use GUI, however a good start is to use first use the 'VM' menu followed by the 'General' tab.</p>

	</div>
	<div class="divider" id="vbox">
		<h2>Booting and installing sidux to a VirtualBox Virtual Machine</h2>
							<p>The Steps:</p>
						<ul>
 							<li>1. Създайте файл за образ за виртуалния хард-диск във VirtualBox</li>
 							<li>2. Стартирайте sidux iso-образа във VirtualBox</li>
 							<li>3. Инсталирайте системата върху виртуалния хард-диск</li>
						</ul>

				<h4>Изисквания</h4>
							<p><span class="highlight-3">Препоръчвана оперативна памет (RAM): 1 gig </span>: най-добре 512 MB за операционната система на "госта" (виртуалната машина, guest), и 512 MB за операционната система на "домакина" (базовата машина във която се стартира виртуалната, host). Ще може да работи и с по-малко оперативна памет, но в такъв случай не очаквайте кой знае каква  производителност.</p>

							<p><span class="highlight-3">Дисково пространство:</span> Докато самата VirtualBox е много икономична (типичната инсталация се нуждае само от 30 MB дисково пространство), за виртуалните машини ще трябват доста големи файлове, които да имитират техните хард-дискове. Така че, за да инсталирате например MS Windows XP (TM) като виртуална машина, използвания файл с лекота ще "порасне" до десетки GB. За да използвате sidux във VirtualBox, трябва да предвидите 5 gig файл плюс място за swap.</p>

				<h3>Installation:</h3>

<pre>
apt-get update
apt-get install virtualbox-ose-qt virtualbox-ose-source dmakms module-assistant
</pre>
							<p>Then prepare the module:</p>
<pre>
m-a prepare
m-a a-i virtualbox-ose-source
</pre>
							<p>Then activate Dynamic Module-Assistant Kernel Module Support for virtualbox, so that the next time the Linux kernel is updated a virtualbox module is prepared for it too, without manual intervention. To do that, add <span class="highlight-3">virtualbox-ose-source</span> to the <span class="highlight-3">/etc/default/dmakms </span>configuration file. </p>
<pre>
mcedit /etc/default/dmakms
virtualbox-ose-source
</pre>

							<p>Then reboot the computer.</p>

							<p><a href="sys-admin-kern-upg-bg.htm#dmakms">This is essential reading on dmakms</a></p>

					<h3>Инсталиране на sidux като виртуална машина</h3>
							<p>Използвайте графичните средства на virtualbox (wizard) за създаването на нова виртуална машина за sidux. След като я стартирате от sidux iso-образ или live-CD, следвайте инструкциите за стандартна инсталация на sidux.</p>

							<p><a href="http://www.virtualbox.org/">VirtualBox има изчерпателно PDF ръководство, което можете да свалите</a> </p>

	</div>
	<div class="divider" id="qemu">
		<h2>Booting and installing sidux to a QEMU Virtual Machine</h2>

		<ul>
 			<li>1. Създайте файл - образ за виртуалния хард-диск за QEMU</li>
 			<li>2. Стартирайте iso-образа с QEMU</li>
 			<li>3. Инсталирайте системата върху виртуалния хард-диск</li>

		</ul>

							<p>A QT GUI tool is available to help you configure QEMU:</p>
<pre>
apt-get install qtemu
</pre>

 				<h4>Създаване на файла - образ за виртуалния хард-диск</h4>

				<p>За да използвате qemu ще ви трябва файл-образ на виртуалния хард-диск. Този файл представлява хард-диска на виртуалната машина.</p>

				<p>За създаването му, използвайте командата:</p>
<pre>
qemu-img create -f qcow sidux.qcow 3G
</pre>
				<p>за да създадете файл-образ с името "sidux.qcow". Параметърът "3G" задава големината на диска - в дадения случай 3 GB. Използвайте суфикса M за мегабайти (например "256M"). Не се безпокойте особено за големината на диска - qcow формата компресира образа, така че празното място на виртуалния диск, не се включва в размера на реалния файл.</p>


			<h4>Инсталиране на виртуалната операционна система</h4>

				<p>Тук за първи път стартираме самия емулатор.<span class="highlight-3">Имайте предвид че когато цъкнете с мишката в qemu прозореца където върви виртуалната машина, курсорът се "прихваща" в нея. За да го освободите:</span></p>
<pre>
Ctrl+Alt
</pre>

				<p>Ако искате да използвате iso образ като стартируемо флопи на виртуалната машина, пуснете Qemu съответно:</p>
<pre>
qemu -floppy sidux.iso -net nic -net user -m 512 -boot d sidux.qcow
</pre>
				<p>За да използвате iso образ като стартируем CD диск на виртуалната машина, пуснете Qemu съответно:</p>
<pre>
qemu -cdrom sidux.iso -net nic -net user -m 512 -boot d sidux.qcow
</pre>
				<p>Сега инсталирайте sidux, както ако го инсталирате на истински хард-диск</p>


			<h4>Използване на системата</h4>

				<p>За да стартирате системата, просто напишете в терминала:</p>
<pre>
qemu [hd_image]
</pre>
				<p>Не е лоша идея да използвате т.нар. "образи на пластове" (overlay images). По този начин системата на виртуалния диск се създава само веднъж, а всички по-нататъшни изменения се съхраняват от Qemu във външен файл. Така е много по-лесно да се върнете към предишно състояние на системата ако нещо се обърка -  което допринася за стабилността като цяло.</p>

				<p>За да създадете "следващ пласт" (overlay image):</p>
<pre>
qemu-img create -b [[базов-образ]] -f qcow [[overlay-образ]]
</pre>
				<p>В този ред заменете "базов-образ" с името на файла на виртуалния диск (в нашия пример sidux.qcow). После можете да стартирате qemu със :</p>
<pre>
qemu [overlay-образ]
</pre>
				<p>и по-нататък, оригиналния образ ще остане недокоснат. Имайте предвид че системата все още се нуждае от базовия образ - не бива да го преименовате или местите, тъй като overlay-образа "е запомнил" пълния път и име на базовия образ.</p>


			<h4>Използване на произволен реален раздел на домакина, като единствен първичен раздел от виртуалния диск на госта</h4>

				<p>Понякога може да искате да използвате някой от вашите истински раздели във виртуалната машина в qemu (напр. ако искате да стартирате и вашия компютър, и виртуалния - с един и същ раздел монтиран в корена на файловата система). Това може да бъде направено с помощта на софтуерен RAID в "линеен режим" (linear mode; драйвера за ядрото е linear.ko) и loopback устройство. Номерът тук е  динамично да "съединим последователно" master boot record (MBR), със реалния раздел, който ще бъде включен в "директния образ на диска" (raw disk image файла за виртуален диск), подаден по-нататък на qemu.</p>

				<p>Нека имаме обикновен, размонтиран раздел /dev/sdaN с някаква файлова система, който раздел ще бъде част от образа на виртуалния диск на госта. Първо, правим малък файл съдържащ само MBR:</p>
<pre>
dd if=/dev/zero of=/path/to/mbr count=32
</pre>
				<p>Така се създава 16 KB (32 * 512 байта) файл. Важно е да не е съвсем малък (макар че MBR се нуждае само от един 512 байтов блок), тъй като колкото по-малък е той, толкова по-малък ще бъде chunk-size (размера на "порциите") използван от софтуерния RAID, което ще се отрази негативно на производителността. После, създаваме loopback устройство (псевдо-дисково устройство), представено от MBR файла:</p>
<pre>
losetup -f /path/to/mbr
</pre>
				<p>Нека резултиращото устройство e /dev/loop0, понеже засега не използваме други loopback устройства. Следващата стъпка е да създадем "смесено" "над"-псевдоустройство MBR + /dev/sdaN , използвайки линеен софтуерен RAID за да "съединим" двете устройства - псевдо-устройството с реалния раздел, в едно ново устройство:</p>
<pre>
 modprobe linear
 mdadm --build --verbose /dev/md0 --chunk=16 --level=linear --raid-devices=2 /dev/loop0 /dev/sdaN
</pre>
				<p>Резултантното /dev/md0 устройство е това, което ще използвате като qemu raw disk образ за госта (не забравяйте да конфигурирате правата така че емулатора да има достъп). Последният "хакерски фокус" е да променим конфигурацията на диска (геометрията на диска и таблицата с разделите) така, че началната точка на първичния раздел в MBR, да съвпада с тази на /dev/sdaN който е част от (вътре във) /dev/md0 (отместването е точно 16 * 512 = 16384 байта в нашия пример). Направете го използвайки fdisk на домакинската операционна система (host machine), а не във емулатора: raw disc детекцията на qemu по подразбиране често ползва незакръгляеми до килобайт отмествания (като 31.5 KB, както в предишната секция)  които не се поддържат от софтуерния RAID code. Така че, в домакина:</p>
<pre>
 fdisk /dev/md0
</pre>
				<p>Тук създайте единствен първичен раздел съответстващ на /dev/sdaN, и си поиграйте със 's'ector командата от 'x'pert менюто, докато първия цилиндър (където раздела започва), съвпадне с размера на MBR. Накрая, запишете с 'w' (write) резултата - и сте готови:) Сега имате раздел, който можете да монтирате както директно на домакинската операционна система, така и като образ на виртуален диск за qemu:</p>
<pre>
 qemu -hdc /dev/md0 [...]
</pre>
				<p>Разбира се, на така "сглобеното" устройство можете безопасно да инсталирате произволен стартиращ мениджър (bootloader, напр. grub - той ще бъде физически записан на първото псевдо-устройство от комбинацията съдържащо MBR  - което псевдо-устройство е просто файл), при условие че оригиналния раздел sdaN partition съдържа нужните за това средства.</p>



			<h4>Използване на модула за ускоряване на QEMU (QEMU Accelerator Module)</h4>

				<p>Програмистите на qemu са създали незадължителен модул към ядрото, който ускорява виртуалните машини почти до равнището на реални системи. Модулът може да се зареди с опцията към него</p>
<pre>
major=0
</pre>
				<p>, за да се автоматизира създаването на нужното /dev/kqemu устройство. В този случай е задължителна следващата команда</p>
<pre>
echo "options kqemu major=0" >> /etc/modprobe.conf
</pre>
				<p>която фактически ще добави ред във файла modprobe.conf, за да обезпечи използването на тази опция всеки път при зареждането на модула.</p>

<pre>
qemu [...] -kernel-kqemu
</pre>
				<p> - стартиран с тази опция, сега qemu включва пълната виртуализация, и значително подобрява скоростта.</p>

			<h4>За да стартирате виртуалната машина в qemu:</h4>
<pre>
qemu -cdrom /tmp/pkg/sidux-debug.iso -net nic -net user -m 512
</pre>
							<p><a href="http://www.nongnu.org/qemu/user-doc.html">Официалната документация за проекта QEMU</a> </p>

							<p><a href="http://wiki.archlinux.org/index.php/Qemu">Част от съдържанието на документацията за  QEMU беше преработена и включена в ръководстото за sidux при условията на GNU Free Documentation License 1.2</a> </p>


	</div>
	<div id="rev">Page last revised 13/04/2010 1450 UTC</div>

</div>
</body>
</html>
