<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="dk">
<head>
	<title>sidux Manuals - rdiff</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<!-- Last translation revision by zonker 23/08/2008 2000 UTC -->
<div id="menu"> <!-- menu starts here da lang maintainer zonker -->
<!--Welcome to the  sidux-manual Operating System Manual version-01.80.2008.01.10 -->
<!-- menu last updated by bluewater 10/01/2009 10400 hrs UTC -->
<a href="http://sidux.com/"><img src="../lib/logos/sidux-logo.png" title="To sidux.com forums and wiki" alt="sidux.com logo" id="menu-header" /></a>
	<ul id="top-list">
		<li><a href="manual-search-da.htm#search-on"> <img src="../lib/logos/kappfinder.png" title="Search Manual" alt="Search" />Søg online - offline</a> </li>
		<li><a href="http://manual.sidux.com/meta-manual">sidux Meta-Manual</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-language-64.png" title="Choose another language" alt="lang-switch" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-da.htm">sidux OS Manual</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-da.htm#welcome-gen">sidux OS Manual</a></li>
				<li><a href="welcome-da.htm#how-to">Anvendelse af manualen</a></li>
				<li><a href="welcome-da.htm#table-contents">Index</a></li>
				<li><a href="help-da.htm#help-gen">Hvor finder du hjælp</a></li>
				<li><a href="help-da.htm#paste">IRC !paste</a></li>
				<li><a href="credits-da.htm#cred-team">Tak til</a></li>
				<li><a href="wel-quickstart-da.htm#welcome-quick">sidux Kvik Start Guide</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-content-da.htm">ISO Releases</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-da.htm#cd-content">ISO and system requirements</a></li>
				<li><a href="sys-admin-release-da.htm#rolling">Rolling Notes</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="cd-dl-burning-da.htm">Download og br&#230;nd CD'en</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="cd-dl-burning-da.htm#download-sidux">sidux fil-spejle, Download og Br&#230;nd CD'en</a></li>
				<li><a href="cd-dl-burning-da.htm#md5">md5 Checksum</a></li>
				<li><a href="cd-dl-burning-da.htm#burn-nero">Br&#230;nd i windows</a></li>
				<li><a href="cd-dl-burning-da.htm#burn-linux">Br&#230;nd i Linux</a></li>
				<li><a href="cd-dl-burning-da.htm#xdelta">xdelta Patching</a></li>
				<li><a href="cd-no-gui-burn-da.htm#burning-no-gui">Br&#230;nd uden GUI</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="live-mode-da.htm">Live Mode</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="live-mode-da.htm#rootpw">Root-password p&#229; sidux-LiveCD'en?</a></li>
				<li><a href="live-mode-da.htm#live-cd-installsoft">Installering af software med Live-CD'en</a></li>
				<li><a href="live-mode-da.htm#ntfs-3g">Skriv til NTFS-partitioner med ntfs-3g</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="term-konsole-da.htm">Terminalen/Konsollen</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="term-konsole-da.htm#sux"> sux</a></li>
				<li><a href="term-konsole-da.htm#term-kon"> Terminalen/Konsollen</a></li>
				<li><a href="term-konsole-da.htm#cli-help">Kommando Linie Hj&#230;lp</a></li>
				<li><a href="term-konsole-da.htm#term-cmds">liste over Linux Terminal Kommandoer</a></li>
				<li><a href="term-konsole-da.htm#shell-scripts">Installering af Scripts.sh</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="cheatcodes-da.htm">CheatCodes</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="cheatcodes-da.htm#cheatcodes">sidux specifikke Live-CD Cheatcodes</a></li>
				<li><a href="cheatcodes-da.htm#cheatcodes-linux">Linux generic Cheatcodes</a></li>
				<li><a href="cheatcodes-vga-da.htm#vga">VGA Codes</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="part-gparted-da.htm">Partitionering af harddiske</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="part-gparted-da.htm#partition">Partitioner harddiske med GParted</a></li>
				<li><a href="part-gparted-da.htm#ntfs">&#198;ndre st&#248;rrelse p&#229; NTFS partitioner med GParted</a></li>
				<li><a href="part-uuid-da.htm#uuid">UUID, Partitions betegndlser og fstab</a></li>
				<li><a href="part-cfdisk-da.htm#disknames">Kort om disk navngivning</a></li>
				<li><a href="part-cfdisk-da.htm#partition">Partitioner harddiske med cfdisk</a></li>
				<li><a href="part-cfdisk-da.htm#formating">Formater partitioner efter partitionering med cfdisk</a></li>
				<li><a href="part-size-examp-da.htm#part-example">Eksempler p&#229; partitions st&#248;rrelser</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hd-install-da.htm">Installations valg</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hd-install-da.htm#Inst-prep">Installations forberedelser</a></li>
				<li><a href="hd-install-da.htm#Installation">Installer til harddisk</a></li>
				<li><a href="hd-install-da.htm#first-hd-boot">F&#248;rste opstart</a></li>
				<li><a href="hd-install-opts-da.htm#fromiso">Opstart 'fromiso'</a></li>
				<li><a href="hd-install-opts-da.htm#fromiso-persist">fromiso og persist</a></li>
				<li><a href="hd-install-opts-da.htm#usb-hd">Installering p&#229; en USB-HD</a></li>
				<li><a href="hd-install-opts-da.htm#vtbox">Installering af sidux med VirtualBox</a></li>
				<li><a href="hd-install-opts-da.htm#qemu">Installering af sidux med QEMU</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-da.htm">Grafikkort, Hardware Enheder og Drivere</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="hw-dev-hw-dri-da.htm#hd-ntfs3g">Skriv til NTFS-partitioner med ntfs-3g</a></li>
				<li><a href="hw-dev-mon-da.htm#mon-res">Skærmopløsning og Monitors</a></li>
				<li><a href="hw-dev-mon-da.htm#xrandr">Dual Monitors og xrandr</a></li>
				<li><a href="hw-dev-mon-da.htm#mon-binary">Dual Monitors (med binære)</a></li>
				<li><a href="hw-dev-hw-dri-da.htm#non-free-3d">Binære, non-free drivere til: Nvidia / ATI</a></li>
				<li><a href="hw-dev-hw-dri-da.htm#native-nv-ati">Free xorg drivere til nVidia, ATI, Radeon, Intel</a></li>
				<li><a href="hw-dev-hw-dri-da.htm#non-free">Hardware med non-free behov</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="wm-kde-da.htm">Window Managers</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="wm-kde-da.htm#desk-freeze">KDE Desktop Fryser</a></li>
				<li><a href="wm-kde-da.htm#kde-login">Kan ikke logge ind i KDE</a></li>
				<li><a href="wm-kde-da.htm#ch-th">&#198;ndre Themes</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="lamp-apache-da.htm">sidux LAMP Stack</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="lamp-apache-da.htm#serv-apache">sidux LAMP Stack</a></li>
				<li><a href="lamp-apache-da.htm#serv-ftp">FTP Klienter</a></li>
				<li><a href="lamp-apache-da.htm#serv-sec">Sikkerhedsprotokoller</a></li>
				<li><a href="lamp-apache-da.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-da.htm#serv-mysql">MySQL Opsætning</a></li>
				<li><a href="lamp-ppp-da.htm#serv-php">PHP i Apache</a></li>
				<li><a href="ntp-server-da.htm#ntp-server">Ops&#230;tning af Timeserver</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide(12 );" onmouseout="startTime();" ><a href="internet-connecting-da.htm">Internet og Netv&#230;rk</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="tor-privoxy-da.htm#tor">Tor</a></li>
				<li><a href="tor-privoxy-da.htm#privoxy">Privoxy</a></li>
				<li><a href="internet-connecting-da.htm#firewalls">Firewalls</a></li>
				<li><a href="samba-da.htm#configure">Konfigurer SAMBA (Windows)</a></li>
				<li><a href="samba-da.htm#setup">Ops&#230;tning af Samba-Server</a></li>
				<li><a href="ssh-da.htm#ssh-fs">SSH og Fjern-montering</a></li>
				<li><a href="ssh-da.htm#ssh-x">X Window programmer via SSH</a></li>
				<li><a href="ssh-da.htm#ssh-f">GUI SSH med Konqueror</a></li>
				<li><a href="ssh-da.htm#ssh-w">SSH X-Forwarding fra Windows-PC</a></li>
				<li><a href="ssh-da.htm#ssh-s">SSH Sikkerhed</a></li>
				<li><a href="internet-connecting-da.htm#dial-mod">56k Modems</a></li>
				<li><a href="internet-connecting-ndis-da.htm#ndiswrapper-basic">Aktiver Ndiswrapper</a></li>
				<li><a href="internet-connecting-ndis-da.htm#ndiswrapper-advanced">Aktiver Ndiswrapper - Udvidet</a></li>
				<li><a href="internet-connecting-wpagui-da.htm#wpa-roaming-gui">WiFi - roaming WPA-GUI</a></li>
				<li><a href="internet-connecting-wpa-da.htm#wpa-basic">WiFi - Basic setup guide</a></li>
				<li><a href="internet-connecting-wpa-da.htm#wpa">WiFi - wpasupplicant</a></li>
				<li><a href="internet-connecting-da.htm#netcardconfig">Kom Online - Ceni</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-apt-da.htm">Installere nye pakker/Afinstallere pakker</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="sys-admin-apt-da.htm#apt-cook">APT-Guide og Sources List</a></li>
				<li><a href="sys-admin-meta-da.htm#meta-pack">Installere Meta-Pakker </a></li>
				<li><a href="sys-admin-meta-da.htm#meta-proxy">Meta-Pakker og Proxies</a></li>
				<li><a href="sys-admin-apt-da.htm#apt-install">Installere nye pakker</a></li>
				<li><a href="sys-admin-apt-da.htm#apt-delete">Afinstallere pakker</a></li>
				<li><a href="sys-admin-apt-da.htm#apt-downgrade">Nedgradere eller 'Hold' en pakke</a></li>
				<li><a href="sys-admin-apt-da.htm#apt-cache">Søgning efter pakker med apt-cache</a></li>
				<li><a href="sys-admin-apt-da.htm#apt-kio">Søgning efter pakker med kio-apt</a></li>
				<li><a href="sys-admin-apt-da.htm#apt-upgrade">Opgradering af Systemet - dist-upgrade</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 14 );" onmouseout="startTime();" ><a href="sys-admin-gen-da.htm">System Administration</a>
			<ul class="sub-menu" id="sm14">
				<li><a href="home-da.htm#home-bu">Moving /home</a></li>
				<li><a href="siduxcc-da.htm#siduxcc">siduxcc Kontrol Centret</a></li>
				<li><a href="sys-admin-apt-da.htm#apt-upgrade">Opgradering af Systemet - dist-upgrade</a></li>
				<li><a href="sys-admin-upgrade-da.htm#live-cd-upgrade">Opgradering med Live-CD</a></li>
				<li><a href="sys-admin-kern-upg-da.htm#kern-upgrade">Opgradere kernel</a></li>
				<li><a href="sys-admin-rdiff-da.htm#rdiff">Sikkerhedskopiering med rdiff</a></li>
				<li><a href="sys-admin-rsync-da.htm#rsync">Sikkerhedskopiering med rsync</a></li>
				<li><a href="vir-rkits-da.htm#virus-rkits">Virus og Rootkit skannere</a></li>
				<li><a href="sys-admin-gen-da.htm#start-services">Aktiver/ deaktiver tjenester</a></li>
				<li><a href="sys-admin-gen-da.htm#pw-lost">Mistet root password</a></li>
				<li><a href="sys-admin-gen-da.htm#fonts">Fonte</a></li>
				<li><a href="sys-admin-gen-da.htm#cups">CUPS</a></li>
				<li><a href="sys-admin-gen-da.htm#init">sidux runlevels - init</a></li>
				<li><a href="sys-admin-grub-bootman2-da.htm#mbr-grub-boot">MBR Overskrevet bootsector</a></li>
				<li><a href="sys-admin-grub-bootman2-da.htm#dual-boot">Dual og Multiple Booting</a></li>
				<li><a href="bios-freedos-da.htm#bois-prep">Upgrading the BIOS with FreeDOS</a></li>
				<li><a href="sys-admin-grub-bootman2-da.htm#boot-grub-floppy">Skriv en Boot-Floppy</a></li>
				<li><a href="sys-admin-grub-bootman2-da.htm#remove-grub">Fjern grub fra MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-da.htm#what-is-grub">Grub; bootmanageren</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
	<div class="divider" id="rdiff">
			<h2 id="top-header">Opret sikkerhedskopier med rdiff-backup</h2>
				<p>rdiff-backup er et værktøj til at oprette sikkerhedskopier af dine filer med. (det kan køre på flere *nix systemer).<br />
				Under Sidux kan du vælge hvordan du vil gøre dette; på den klassiske gør-det-selv måde, eller ved hjælp af et script</p>

				<h3><a href="http://techpatterns.com/forums/about831.html">Dette er metoden der følger h2's script</a></h3>
	<div class="spacer02"></div>

			<h5>Hvad der følger her er Gør-det-selv versionen</h5>

			<h6>rdiff-backup</h6>

				<p class="highlight-2">Du skal køre alle kommandoerne som root i konsollen/ terminalen, -medmindre andet er angivet</p>

				<p>* fantastisk til at redde dist-upgrades eller kernel-upgrades, der gik grueligt galt, osv. (og kan også bruges til bare at genskabe personlige filer).<br /></p>
				<p>* sikkerhedskopierer kun det der er ændret siden sidst, ligesom rsync gør (så hver backup går hurtig).<br /></p>
				<p>* indeholder oversigt over ændringer (history of changes) (så du kan genskabe en fil du slettede for 3 uger siden!)<br /></p>
				<p>* kan udføre sikre sikkerhedskopieringer over nettet (med ssh).<br /></p>
				<p>* Sikkerhedskopierer partitioner imens de er monterede (så deter nemt at automatisere en daglig sikkerhedskopi...ingen brug for at afmontere).<br /></p>
				<p>* kan gendanne alt hvis din harddisk står af, og du skal købe en helt ny.<br /></p>
				<p>* scales to backup large networks (problemløst i linux netværk, Windows-netværk er mere komplekst at arbejde med) og bruges af firmaer.<br /></p>
				<p>* kommandolinie drevet program, perfekt for dem der kan lide at udføre ting som automatiseret sikkerhedskopi på den 'stærkeste' måde (bash script der kaldes af cron).<br /></p>
				<p>* husker og håndterer fil-ejerskab og -tilladelser, kan også håndtere symbolske links (og andet i den dur), så når du gendanner, så er tingene nøjagtigt som de var.</p>

			<h6>Hvad skal du bruge</h6>
				<p>rdiff-backup gemmer en komplet (ikke komprimeret) kopi af filerne som du sikkerhedskopierer, og den gemmer også en oversigt over ændringerne (incremental backups), dette betyder at pladsen til dine sikkerhedskopier skal være større end det du gerne vil lave sikkerhedskopierne af. Så hvis du vil sikkerhedskopiere 100 GB kan det være at du skal bruge helt op til 120 GB (på en separat harddisk, om muligt!).</p>

			<h6>Opsætning</h6>
				<p>lad os antage at din maskine har det følgende:<br />
				* en 100 gb harddisk (hda) i anvendelse, hvor monteringspunkterne hda1 er root partitionen, hda5 bruges til at gemme musik og andre filer, og hda6 er swap partitionen.<br />
				* en overskydende 200 gb harddisk (hdb) som du ikke bruger endnu, med et monteringspunkt hdb1 ... den vil vi bruge til vores sikkerhedskopier.<br />
				* IP addressen 192.168.0.1</p>

				<p>Det første du skal gøre er at installere rdiff-backup:</p>
<pre>
# apt-get install rdiff-backup
</pre>
				<p>Selv om du sagtens kan tage backups af enkelte mapper er denne guide møntet på at sikkerhedskopiere hele partitioner... vi vil sikkerhedskopiere hda1 og hda5 (vi vil ikke tage en backup af hda6), og derfor skal vi have oprettet nogle mapper til vores data:</p>
<pre>
# mkdir -p /media/hdb1/rdiff-backups/192.168.0.1/root
# mkdir -p /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>Du skal specificere IP-adressen fordi det er denne maskine du vil oprette en sikkerhedskopi fra (og senere vil vi se på hvordan du også opretter sikkerhedskopier fra andre maskiner på netværket).</p>

			<h6>Oprette sikkerhedskopier</h6>

				<p>rdiff-backup bruger syntaksen <span class="highlight-3">rdiff-backup source-dir dest-dir</span>. OBS: always specify directory names, not file names.</p>

				<p>For at sikkerhedskopiere hda5, kør:</p>
<pre>
# rdiff-backup /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>Og for at sikkerhedskopiere root partitionen, kør:</p>
<pre>
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/hdb1/rdiff-backups/192.168.0.1/root
</pre>
				<p>Alle "AF_UNIX path too long" fejl kan ignoreres. Det kan tage lidt tid hvis det er første gang der oprettes sikkerhedskopi af denne partition, idet rdiff-backup så skal kopiere hele partitionen (ikke bare ændringerne). Bemærk at vi ikke inkluderer /tmp, eftersom dette hele tiden ændres, heller ikke /proc eller /sys eftersom de ikke indeholder rigtige filer, og vi vil heller ikke kopiere monteringer (mounts). Hvis du vælger at sikkerhedskopiere monteringer, så kopierer du hdb1 og det kan føre til en endeløs løkke (infinite loop!). En måde at omgå dette på er at sikkerhedskopiere monteringer separat.</p>

				<p>Grunden til at du udelader '/proc/*' og ikke bare '/proc' er at dette på snedig vis vil tage en sikkerhedskopi af mappen /proc, men udelade alle filerne i den. Det samme gælder for /tmp, /sys, og, allermest listigt, alle monteringspunkternes navne.</p>

				 <p>På denne måde vil du få genskabt dine /tmp, /proc, /sys og monteringspunkters navne hvis du skulle destruere din root partition og have brug for en fuld gendannelse. Hvis /tmp ikke findes når X starter, brokker X sig muligvis over dette. Se man page for mere omkring --exclude og --include).</p>

			<h6>Genoprettelse af mapper fra sikkerhedskopier</h6>

				<p>rdiff-backup bruger syntaksen:</p>
<pre>
rdiff-backup -r &lt;from-when&gt; &lt;source-dir&gt; &lt;dest-dir&gt;
</pre>
				<p>Hvis du ved en fejl er kommet til at slette mappen /media/hda7/photos, så gendanner du den med:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5/photos /media/hda5/photos
</pre>
				<p>Her betyder"-r now" parameteren 'genskab fra sidste sikkerhedskopi'. Hvis du periodisk sikkerhedskopierer alt (via crontab, for eksempel), og du ikke havde opdaget at photos mappen manglede før nogle dage senere, så ville du skulle genskabe den fra en sikkerhedskopi der er nogle dage gammel (og ikke "now", eftersom den seneste sikkerhedskopi ikke indeholder mappen). Eller måske vil du bare gerne tilbage til en tidligere version af noget.</p>

				<p>Hvis du vil genskabe systemet som for tre dage siden, så bruger du"-r 3D" ... men, som man page siger, bemærk at:</p>

				<p class="highlight-1">"3D" henviser til øjeblikket 72 timer før nu. Og hvis der ikke blev taget en sikkerhedskopi på det tidspunkt, så vil rdiff-backup genskabe fra den første tidligere kopi den finder. Hvis for eksempel som ovennævnt, man anvender "3D", og der ikke findes nogen sikkerhedskopi oprettet for 3 dage siden, men der er sikkerhedskopier oprettet hhv. for 2 og for 4 dage siden, da vil rdiff-backup genskabe til tilstanden som den var for 4 dage siden. Du skal altså lige tænke over dette, inden du genskaber noget med rdiff-backup.</p>

				<p>Ved at skrive følgende kommando kan du få rdiff til at skrive en liste over datoer og tidspunkter hvor der er blevet oprettet sikkerhedskopier af hda5:</p>
<pre>
# rdiff-backup -l /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
			<h5>Genoprettelse af partitioner</h5>

				<p>Du kan også genoprette hele partitioner (mounts); når det kommer til stykket er monteringspunkter egentlig blot mapper.</p>

				<p class="highlight-2">ADVARSEL: Genopret ikke root partitionen (/) mens du er bootet ind i den! Med en kommando vil du miste alle filerne på alle dine partitioner, inklusiv alle sikkerhedskopier på separate harddiske!! rdiff-backup gør nemlig det du siger den skal gøre ... hvis din sikkerhedskopi for root partitionen har tomme monteringspunkter, så vil rdiff-backup slette alt hvad der er i monteringspunkterne for at få dem genoprettet til tilstanden i sikkerhedskopien.</p>

				<p>For at genoprette hda5 fra den sidste sikkerhedskopi, skriver vi:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5 /media/hda5
</pre>
			<h5>Genoprettelse af root partitionen</h5>

				<p>Dette er ikke helt simpelt. Forsøg aldrig på dette hvis partitionen er monteret (se ovenstående advarsel). Det er enormt nyttigt at kunne genoprette root partitionen, eftersom hvis noget går galt med installation/afinstallation eller kernel-upgrades, så kan du med fred i sindet bare gendanne systemet til en tidligere tilstand i løbet af kun 20 minutter.</p>

				<p>En måde at genoprette en root partition på er ved at boot ind i en overskydende linux partition, hvis du har en såden på din maskine. Herfra vil du være i stand til at genskabe din root partition da den så ikke vil være monteret som root. Når du igen booter ind i den vil partitionen være præcis som da du tog en sikkerhedskopi af den. Dette er langt den nemmeste metode til at gendanne root partitionen.</p>

				<p>En anden måde er genoprette root partitionen på er ved at opstarte med Sidux live-CD'en og udføre kommandoen derfra. rdiff-backup er inkluderet i sidux. I det tilfælde at den version du har af sidux CD'en ikke inkluderer rdiff, kan du anvende cheatcoden "unionfs" i Grubs kommandolinie, den betyder at du så kan installere yderligere software mens du kører live-CD'en. Boot Live-CD'en med denne cheatcode og udfør følgende kommandoer:</p>
<pre>
$ sudo su
# wget -O /etc/apt/sources.list http://sidux.com/files/misc/sources.list
# apt-get update
# apt-get install rdiff-backup
</pre>
				<h6>Lad os så genoprette:</h6>
<pre>
# mount /dev/hda1 /media/hda1
# mount /dev/hdb1 /media/hdb1
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>OBS: Hvis du ikke har en Sidux-CD kan du benytte en anden Live-CD hvis denne understøtter installation via 'klik'. Du kan så installere rdiff-backup med Klik og kalde:</p>
<pre>
$ sudo ~/.zAppRun ~/Desktop/rdiff-backup_0.13.4-5.cmg rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>Det kan anbefales alle, der opretter en sikkerhedskopi af root partitionen (med den intention at genoprette fra den), at de tester processen med genopretning fra sikkerhedskopien. Der er næsten intet der er værre, end at tro at alt stadig kan ordnes og så få sig en ubehagelig overraskelse, når uheldet virkelig er ude.</p>

			<h5>Sikkerhedskopiering af andre maskiner</h5>

				<p>Du kan sikkerhedskopiere andre maskiner til din lokal-maskine, så længe din lokale maskine kan afvikle ssh forbindelser til de andre maskiner (og så længe som du har plads på dine harddiske). ssh server'en (sshd) skal køre på fjern-maskinen. De andre maskiner skal ikke nødvendigvis være i dit LAN, -de kan være placeret hvor som helst i verden.</p>

				<p>Lad os antage at fjern-maskinen har følgende:<br />
				1) en 100 gb harddisk (hda) som er i brug, med fgl. monteringspunkter,<br />
				2) hda1 anvendt som root partition(/),<br />
				3) hda5 hvor vi gemmer midlertidige data, som vi ikke vil sikkerhedkopiere,<br />
				4) og hda6 som er swap, <br />
				5) samt IP-addressen 192.168.0.2</p>

				<p>OBS: Begge 100 gb drev kan ikke normalt blive sikkerhedskopieret til en 200 gb harddisk med rdiff-backup (eftersom dette ikke ville efterlade noget plads til ændringer), men eftersom du ikke vil sikkerhedskopiere hda5 på fjern-maskinen (og siden harddiske sjældent er helt fulde, -det kan du dog ikke regne med som standard) så antager vi at du har plads nok. For hver gang rdiff-backup opretter en ny sikkerhedskopi, dannes der flere filer (incremental files), og mere og mere plads anvendes.</p>

				<p>Du kan fortælle rdiff-backup at den kun skal gemme den sidste måneds sikkerhedskopier (kommandoen til dette viser vi senere), og dette vil naturligvis gøre at rdiff-backup bruger mindre plads end hvis den skal beholde sikkerhedskopierne fra et helt år.</p>

				<p>Først installerer du også rdiff-backup på fjern-maskinen (enhver computer du du vil sikkerhedskopiere fra, inklusiv backup serveren, skal have rdiff-backup installeret).</p>

				<p>For at sikkerhedskopiere fjern-maskinen til lokal-maskinen, kør fgl. på lokal-maskinen (ie 192.168.0.1): <span class="highlight-4">Bemærk anvendelsen af dobbelt kolon :: </span></p>
<pre>
# mkdir /media/hdb1/rdiff-backups/192.168.0.2/root
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' 192.168.0.2::/ /media/hdb1/rdiff-backups/192.168.0.2/root 
</pre>
				<p>Hvis du vil genoprette en mappe på fjern-maskinen, kan du enten starte processen fra lokal- eller fra fjern-maskinen.</p>

				<p>Dette er hvordan du ville genoprette mappen /usr/local/games på fjern-maskinen, ved at initiere det fra fjern-maskinen:</p>
<pre>
# rdiff-backup -r now 192.168.0.1::/media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games /usr/local/games
</pre>
				<p>Dette er hvordan du ville genoprette mappen /usr/local/games på fjern-maskinen, ved at initiere det fra den lokale maskine:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games 192.168.0.2::/usr/local/games
</pre>
				<p>Brug den samme slags syntaks hvis du genopretter din root partition fra en Live-CD (hvor fjern-maskinen er booted op med Live-CD... se ovenstående).</p>

			<h5>Automatisering af sikkerhedskopiering:</h5>

				<p>Hvis du sikkerhedskopierer fra en anden maskine til din egen lokale maskine, så er det første du skal gøre at aktivere password-frie ssh logins med ssh keys. <span class="highlight-2">Bemærk at der menes password-frie ssh-logins som root. Dette kan indskrænkes såldes at der kun kan udføres kommandoer til rdiff-backup, men det er uden for denne sides område, se venligst <a href="ssh-da.htm#ssh-s">SSH Configuration</a>.</span> Vi antager at der er fuldstændig tillid, og viser den mest simple måde hvorpå man kan opsætte password-frie ssh logins.</p>

				<p>Fra den lokale maskine gør du følgende:</p>
<pre>
# [ -f /root/.ssh/id_rsa ] || ssh-keygen -t rsa -f /root/.ssh/id_rsa
</pre>
				<p>Og tryk retur to gange for blanke passwords. Så gør du:</p>
<pre>
# cat /root/.ssh/id_rsa.pub | ssh 192.168.0.2 'mkdir -p /root/.ssh;\<!--dunno if this is wrong-->
> cat - >>/root/.ssh/authorized_keys2'
</pre>
				<p>Der vil blive spurgt efter dit root password.</p>

				<p>Nu kan du ssh til fjern-maskinen som root uden at skulle skrive et password, og rdiff-backup kan automatiseres.</p>

				<p>Som det næste skal du oprette et bash script der indeholder alle rdiff-backup kommandoerne. Vores bash script kan ligne det følgende eksempel:</p>


<pre>
#!/bin/bash
RDIFF=/usr/bin/rdiff-backup
echo
echo "=======Backing up 192.168.0.1 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/hdb1/rdiff-backups/192.168.0.1/root
echo "(and purge increments older than 1 month)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/root
echo
echo "=======Backing up 192.168.0.1 mount hda5======="
${RDIFF} --ssh-no-compression --exclude /media/hda5/myjunk /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo
echo "=======Backing up 192.168.0.2 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' --exclude '/mnt/*/*' 192.168.0.2::/media/hdb1/rdiff-backups/192.168.0.2/root
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.2/root
</pre>


				<p>Nu kan du ændre navnet af dette bash script til "myrdiff-backups.bash" og flytte det til /usr/local/bin på din lokale (backup server) maskine, og ændre det til at kunne køres. Kør script'et for at sikre dig at det virker.</p>

				<p>Til sidst kan du få cron til at kalde det hver aften klokken 20. Den følgende linie i root's crontab vil sørge for dette, kald</p>
<pre>
# crontab -e
og indsæt følgende linie
0 20 * * * /usr/local/bin/myrdiff-backups.bash
</pre>

	<div class="spacer05"></div>
			<div id="rev">Content last revised 05/12/2007 1230 UTC</div>

</div>
</div>
</body>
</html>
