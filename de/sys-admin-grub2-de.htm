<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>sidux Manuals - Grub2</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<!-- Last translation revision by hubi Wed, 23 Dec 2009 19:23:17 +0000 -->
<div id="menu"> <!-- menu starts here de lang maintainers hubi -->
<!--sidux-manual Operating System Manual menu-version-01.99.2009.12.21 -->
<!-- menu last updated by bluewater 2009.12.21 1235 hrs UTC -->
	<div id="menu-header">
	      <a href="http://sidux.com/"><img src="../lib/logos/manual-sidux-logo.png" title="Zu sidux.com (Forum und Wiki)" alt="sidux.com logo" /></a>
	</div>
	<ul id="top-list">
		<li><a href="manual-search-de.htm#search-on"> <img src="../lib/logos/manual-search-22x22.png" title="Handbuch Suche" alt="Suche" />Suche online - offline</a> </li>
		<li><a href="http://manual.sidux.com/meta-manual">Softwaretipps der Community</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-lang-100x64.png" title="Wählen Sie eine andere Sprache - Choose another language" alt="lang-switch" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-de.htm">Über das sidux-Handbuch</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-de.htm#welcome-gen">Willkommen</a></li>
				<li><a href="welcome-de.htm#how-to">Tipps zum Handbuch</a></li>
				<li><a href="welcome-de.htm#table-contents">Index</a></li>
				<li><a href="help-de.htm#help-gen">Wo es Hilfe gibt</a></li>
				<li><a href="help-de.htm#paste">IRC !paste</a></li>
				<li><a href="credits-de.htm#cred-team">Danksagungen</a></li>
				<li><a href="wel-quickstart-de.htm#welcome-quick">sidux Kurzanleitung</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-dl-burning-de.htm">Inhalt der ISO, Veröffentlichungen, Download-Server, Brennvorgang</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-de.htm#cd-content">Inhalt der ISO und Systemanforderungen</a></li>
				<li><a href="sys-admin-release-de.htm#rolling">Aktuelle Hinweise zum Versionsupgrade</a></li>
				<li><a href="cd-dl-burning-de.htm#download-sidux">Spiegelserver, ISO herunterladen</a></li>
				<li><a href="cd-dl-burning-de.htm#md5">md5-Prüfsummen</a></li>
				<li><a href="cd-dl-burning-de.htm#burn-nero">Brennen in Windows</a></li>
				<li><a href="cd-dl-burning-de.htm#burn-linux">Brennen in Linux</a></li>
				<li><a href="cd-no-gui-burn-de.htm#burning-no-gui">burniso-Skript</a></li>
				<li><a href="cd-no-gui-burn-de.htm#burning-no-gen">Brennen ohne GUI</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="live-mode-de.htm">Live-ISO-Modus</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="live-mode-de.htm#rootpw">Das Rootpasswort der sidux-Live-ISO</a></li>
				<li><a href="live-mode-de.htm#live-cd-installsoft">Installieren von Software während einer Live-ISO-Sitzung</a></li>
				<li><a href="live-mode-de.htm#ntfs-3g">Schreiben auf NTFS-Partitionen mit ntfs-3g</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="term-konsole-de.htm">Das Terminal / Die Konsole</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="term-konsole-de.htm#sux">  sux / sudo</a></li>
				<li><a href="term-konsole-de.htm#term-kon"> Terminal/Konsole</a></li>
				<li><a href="term-konsole-de.htm#cli-help">Kommadozeilenhilfe</a></li>
				<li><a href="help-de.htm#init3-tools">Nützliche Helfer im Textmodus (tty) - init 3</a></li>
				<li><a href="term-konsole-de.htm#term-cmds">Linux-Konsolenbefehle</a></li>
				<li><a href="term-konsole-de.htm#shell-scripts">Installation von Shellskripten</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="cheatcodes-de.htm">Boot-Cheatcodes</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="cheatcodes-de.htm#cheatcodes">sidux spezifische Parameter (nur Live-ISO)</a></li>
				<li><a href="cheatcodes-de.htm#cheatcodes-linux">Allgemeine Parameter des Linux-Kernel</a></li>
				<li><a href="cheatcodes-vga-de.htm#vga">VGA-Codes</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="part-gparted-de.htm">Partitionieren der Festplatte</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="part-gparted-de.htm#partition">mit GParted</a></li>
				<li><a href="part-gparted-de.htm#ntfs">NTFS-Partitionen mit GParted ändern</a></li>
				<li><a href="part-uuid-de.htm#uuid">UUID, Partitionsbezeichnung und fstab</a></li>
				<li><a href="part-cfdisk-de.htm#disknames">Bezeichnungsschema von Festplatten</a></li>
				<li><a href="part-cfdisk-de.htm#partition">Partitionieren mit cfdisk</a></li>
				<li><a href="part-cfdisk-de.htm#formating">Formatieren mit cfdisk</a></li>
				<li><a href="part-size-examp-de.htm#part-example">Beispiele für Partitionsgrößen</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="hd-install-de.htm">Installationsoptionen</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="hd-install-de.htm#Inst-prep">Vorbereiten der Installation</a></li>
				<li><a href="hd-install-de.htm#Installation">Installation auf die Festplatte</a></li>
				<li><a href="hd-install-de.htm#first-hd-boot">Erstes Booten von der Festplatte</a></li>
				<li><a href="hd-install-opts-de.htm#fromiso">'fromiso' - Überblick</a></li>
				<li><a href="hd-install-opts-de.htm#fromiso-grub-leg">'fromiso' mit grub-legacy</a></li>
				<li><a href="hd-install-opts-de.htm#grub2-fromiso">'fromiso' mit Grub2</a></li>
				<li><a href="hd-install-opts-de.htm#fromiso-persist">Beschreibbares Live-System - fromiso</a></li>
				<li><a href="hd-install-opts-de.htm#usb-hd">Installation auf eine USB-Festplatte</a></li>
				<li><a href="hd-install-opts-de.htm#vtbox">Installation sidux über VirtualBox</a></li>
				<li><a href="hd-install-opts-de.htm#qemu">Installation sidux über qemu</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-de.htm">Grafikkarten, Hardware, Geräte, Xorg &amp; verschiedene Treiber</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hw-dev-hw-dri-de.htm#hd-ntfs3g">Schreiben auf NTFS-Partitionen mit ntfs-3g</a></li>
				<li><a href="hw-dev-mon-de.htm#mon-res">Ändern der Bildschirmauflösung</a></li>
				<li><a href="hw-dev-mon-de.htm#xrandr">Zwei Monitore und xrandr</a></li>
				<li><a href="hw-dev-mon-de.htm#mon-binary">Zwei Monitore mit binären Grafiktreibern</a></li>
				<li><a href="hw-dev-hw-dri-de.htm#non-free-3d">Binäre, nicht freie Treiber für Nvidia &amp; xorg.conf</a></li>
				<li><a href="hw-dev-hw-dri-de.htm#non-free-3d-2">Nicht freie Treiber für ATI, Radeon und andere</a></li>
				<li><a href="hw-dev-hw-dri-de.htm#non-free-firmware">Hardware mit nicht freier Firmware</a></li>
				<li><a href="hw-dev-hw-dri-de.htm#non-free">non-free der Sources List zufügen</a></li>
				<li><a href="hw-dev-hw-dri-de.htm#native-nv-ati">FOSS xorg-Treiber für nVidia, ATI, Radeon, Intel &amp; xorg.conf</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="wm-kde-de.htm">Fenstermanager</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="wm-xfce-de.htm#xfce-notes">Nützliche Xfce-Extras</a></li>
				<li><a href="wm-kde-de.htm#install-add">Nützliche KDE-Extras</a></li>
				<li><a href="wm-kde-de.htm#desk-freeze">Falls der Desktop einfriert</a></li>
				<li><a href="wm-kde-de.htm#kde-login">Kein Login in KDE möglich</a></li>
				<li><a href="wm-kde-de.htm#ch-th">Themes ändern</a></li>
				<li><a href="wm-kde-de.htm#dm">Sitzungsmanager</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="lamp-apache-de.htm">sidux LAMP-Stack</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="lamp-apache-de.htm#serv-apache">sidux LAMP-Paket</a></li>
				<li><a href="lamp-apache-de.htm#serv-ftp">FTP-Clients</a></li>
				<li><a href="lamp-apache-de.htm#serv-sec">Sichere Protokolle</a></li>
				<li><a href="lamp-apache-de.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-de.htm#serv-mysql">MySQL-Setup</a></li>
				<li><a href="lamp-ppp-de.htm#serv-php">PHP in Apache</a></li>
				<li><a href="ntp-server-de.htm#ntp-server">Zeitserver-Setup</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="internet-connecting-de.htm">Internet und Netzwerk</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="tor-privoxy-de.htm#tor">Tor</a></li>
				<li><a href="tor-privoxy-de.htm#privoxy">Privoxy</a></li>
				<li><a href="internet-connecting-de.htm#firewalls">Firewalls</a></li>
				<li><a href="samba-de.htm#configure">SAMBA: Windows-Freigaben nutzen</a></li>
				<li><a href="samba-de.htm#setup">Einen Samba-Server aufsetzen</a></li>
				<li><a href="ssh-de.htm#ssh-fs">SSH: Einbindung eines entfernten Computers</a></li>
				<li><a href="ssh-de.htm#ssh-x">X-Window-Programme via SSH verwenden</a></li>
				<li><a href="ssh-de.htm#ssh-f">SSH: GUI mit Konqueror</a></li>
				<li><a href="ssh-de.htm#ssh-w">SSH: X-Forwarding von Windows</a></li>
				<li><a href="ssh-de.htm#ssh">SSH: Sicherheit</a></li>
				<li><a href="internet-connecting-de.htm#dial-mod">56k-Modems</a></li>
				<li><a href="internet-connecting-wpagui-de.htm#wpa-roaming-gui">WiFi - Roaming und WPA-GUI</a></li>
				<li><a href="internet-connecting-wpa-de.htm#wpa-basic">WiFi - Aufsetzen einer WLAN-Verbindung</a></li>
				<li><a href="internet-connecting-wpa-de.htm#wpa">WiFi - wpasupplicant</a></li>
				<li><a href="internet-connecting-de.htm#netcardconfig">Internet &amp; Netzwerk - Ceni</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="sys-admin-apt-de.htm">Systemaktualisierung und Paketverwaltung</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="sys-admin-apt-de.htm#apt-cook">APT-Kochbuch, sources.list</a></li>
				<li><a href="sys-admin-apt-de.htm#apt-install">Neue Pakete installieren</a></li>
				<li><a href="sys-admin-apt-de.htm#apt-delete">Pakete löschen</a></li>
				<li><a href="sys-admin-apt-de.htm#apt-downgrade">Downgraden bzw. "Hold" eines Pakets</a></li>
				<li><a href="siduxcc-de.htm#hermes">sidux-hermes</a></li>
				<li><a href="sys-admin-upgrade-de.htm#live-cd-upgrade">Aktualisierung durch die Live-ISO</a></li>
				<li><a href="sys-admin-kern-upg-de.htm#kern-upgrade">Aktualisierung des Kernels</a></li>
				<li><a href="sys-admin-apt-de.htm#apt-cache">Programmsuche mit apt-cache</a></li>
				<li><a href="sys-admin-apt-de.htm#gui-pacsea">GUI-Paketsuche mit packagesearch</a></li>
				<li><a href="sys-admin-apt-locarmirr-de.htm#approx">Upgrade mehrerer PCs via LAN</a></li>
				<li><a href="sys-admin-apt-de.htm#apt-upgrade">Upgrade eines installierten Systems - dist-upgrade - Überblick</a></li>
				<li><a href="sys-admin-apt-de.htm#du-st">Upgrade eines installierten Systems - dist-upgrade - Die einzelnen Schritte</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-gen-de.htm">Systemadministration</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="hd-install-de.htm#adduser">Einen neuen Benutzer hinzufügen</a></li>
				<li><a href="home-de.htm#home-bu">/home verschieben</a></li>
				<li><a href="siduxcc-de.htm#siduxcc">sidux Kontrollzentrum</a></li>
				<li><a href="sys-admin-rdiff-de.htm#rdiff">Backup mit rdiff</a></li>
				<li><a href="sys-admin-rsync-de.htm#rsync">Backup mit rsync</a></li>
				<li><a href="vir-rkits-de.htm#virus-rkits">Virus- und Rootkitscanner</a></li>
				<li><a href="sys-admin-gen-de.htm#start-services">Dienste starten und stoppen</a></li>
				<li><a href="sys-admin-gen-de.htm#init">sidux-Runlevels - init</a></li>
				<li><a href="sys-admin-gen-de.htm#pw-lost">Rootpasswort vergessen</a></li>
				<li><a href="sys-admin-gen-de.htm#fonts">Schriftarten</a></li>
				<li><a href="sys-admin-gen-de.htm#cups">CUPS - Druckerserver und -client</a></li>
				<li><a href="sys-admin-gen-de.htm#sound">Mischpulte (sound mixer)</a></li>
				<li><a href="bios-freedos-de.htm#bois-prep">Aktualisieren des BIOS mit FreeDOS</a></li>
				<li><a href="sys-admin-grub-bootman2-de.htm#boot-grub-floppy">Eine Boot-Floppy erstellen</a></li>
				<li><a href="sys-admin-grub-bootman2-de.htm#mbr-grub-boot">Grub1 - MBR-Bootsektor überschreiben</a></li>
				<li><a href="sys-admin-grub-bootman2-de.htm#dual-boot">Grub1 - Dualboot und Multiboot</a></li>
				<li><a href="sys-admin-grub-bootman2-de.htm#what-is-grub">Grub: der Bootmanager</a></li>
				<li><a href="sys-admin-grub-bootman2-de.htm#remove-grub">Grub aus MBR entfernen</a></li>
				<li><a href="sys-admin-grub2-de.htm#mbr-over-grub2">Grub2 - MBR überschrieben</a></li>
				<li><a href="sys-admin-grub2-de.htm#multi-os">Grub2 - Dualboot und Multiboot</a></li>
				<li><a href="sys-admin-grub2-de.htm#grub1-grub2">Grub2 - Aktualisierung von Grub1</a></li>
				<li><a href="sys-admin-grub2-de.htm#grub2">Grub2 - Überblick</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
		<div class="divider" id="grub2">
			<h2 id="top-header">GRUB 2</h2>
				<h6>Zusammenfassung der wesentlichen Unterschiede zwischen GRUB 1 (jetzt grub-legacy) und GRUB2:</h6>

					<ul>
						  	<li><span class="highlight-3">Die Datei menu.lst existiert nicht mehr.</span></li>

							<li>Die Datei <span class="highlight-3">grub.cfg</span> ist steuert nun den Grub-Bildschirm.</li>

							<li>grub.cfg wird automatisch von Skripten in <span class="highlight-3"> /etc/grub.d</span> erstellt.</li>

							<li>Die Bezeichnung der Partitionen ändert sich ebenfalls. Die Nummerierung der Partitionen beginnt mit 1, nicht mit 0 (Laufwerksnummerierungen beginnen weiterhin mit 0):
<pre>
Linux      grub1     grub2
/dev/sda1  (hd0,0)   (hd0,1)
/dev/sda2  (hd0,1)   (hd0,2)
/dev/sda3  (hd0,2)   (hd0,3)

/dev/sdb1  (hd1,0)   (hd1,1)
/dev/sdb2  (hd1,1)   (hd1,2)
/dev/sdb3  (hd1,2)   (hd1,3)
</pre>
							</li>

							<li>Die Stanzas in grub.cfg folgen einer anderen Syntax als in menu.lst und können nicht direkt von der menu.lst von Grub 1 nach grub.cfg von Grub2 kopiert werden. <span class="highlight-2">Die Datei grub.cfg darf nie manuell geändert werden. </span></li>

					 </ul>

					 <h4>Konfigurationsdatei von Grub2</h4>
							<p>Die Datei <span class="highlight-3">/etc/default/grub</span> enthält die variablen Einstellungen für Grub2, zum Beispiel Timeout, Basiseinstellungen des Menüs, Kernel-Parameter, graphische Oberfläche von Grub u.a.</p>

					 <h4> Die Skripte von Grub2</h4>
							<p><span class="highlight-3"> /etc/grub.d</span> steuert die Zieldatei <span class="highlight-3"> grub.cfg</span>, die sich in <span class="highlight-3"> /boot/grub/</span> befindet.</p>

							<p><span class="highlight-2">Die Datei grub.cfg darf nie manuell geändert werden. </span>Alle Änderungen müssen in den Skriptdateien im Ordner <span class="highlight-3"> /etc/grub.d</span> durchgeführt werden. os-prober sollte 90% der Fälle korrekt lösen:</p>
<pre>
00_header:
05_debian_theme: Setzt Hintergrund, Textfarben, Grafikthema
10_hurd: Sucht einen Hurd-Kernel
10_linux: Sucht einen Linux-Kernel auf Grundlage des Befehls lsb_release
20_memtest86+: Falls die Datei /boot/memtest86+.bin existiert, wird sie ins Boot-Menü integriert
30_os-prober: Sucht in allen Partitionen nach Betriebssystemen (Linux und andere) und integriert sie in das Boot-Menü
40_custom: Eine Vorlage, um benutzerdefinierte Menü-Einträge für weitere Betriebssysteme anzulegen
60_fll-fromiso: Eine Vorlage, um benutzerdefinierte Menü-Einträge für fromiso auf eine/n USB-Stick/SSD-Karte anzulegen
<span class="highlight-2">60_fll-fromiso darf nicht manuell geändert werden. Für Anpassungen steht /etc/default/grub2-fll-fromiso zur Verfügung</span>
</pre>
							<p>Nachdem Änderungen durchgeführt wurden, muss grub.cfg diese kennen. Nach einer Aktualisierung des sidux-Kernels, werden die Aktualisierung von Grub automatisch durchgeführt. Änderungen, die manuell durchgeführt wurden, erfordern diesen Befehl:</p>

<pre>
update-grub
</pre>

							<p><span class="highlight-3">Das Debianpaket von Grub2 ist so gestaltet, dass eine manuelle Änderung selten erforderlich ist.</span></p>
		</div>
		<div class="divider" id="grub1-grub2">
				<h2>Aktualisierung von Grub Legacy auf Grub2</h2>
							<p><span class="highlight-2">Wir empfehlen eine saubere Aktualisierung auf Grub2 und die gänzliche Entfernung von Grub 1</span>. Man sollte sich dessen bewusst sein, dass man bei fehlerhaftem Vorgehen das Bootsystem zerstören kann und daher sehr umsichtig vorgehen soll.</p>

						<h6>Schritt 1: </h6>
							<p>Stellen Sie sicher, dass Ihr ganzes System aktualisiert ist: <span class="highlight-3">dist-upgrade in Runlevel 3 (init 3)</span>.</p>
<pre>
apt-get update
Ctrl+alt+F1
init 3
apt-get dist-upgrade
init 5 &amp;&amp; exit
</pre>
						<h6>Schritt 2:</h6>
							<p>Vollständige Entfernung von Grub 1:</p>
<pre>
rm -rf /boot/grub
apt-get purge grub-gfxboot
</pre>
							<p>Als Folge werden <span class="highlight-3">fll-iso2usb* grub-gfxboot* install-usb-gui* </span> entfernt.  Geben Sie <span class="highlight-3">Y</span> zur Bestätigung ein.</p>

						<h6>Schritt 3:</h6>

<pre>
apt-get install grub2
</pre>

<div class="screenshot"><img src="../lib/images-common/images-grub2/grub2-2.png" title="Grub2" alt="Grub2" /></div>
							<p>Verwenden Sie die TAB-Taste, um OK zu wählen</p>

<div class="screenshot"><img src="../lib/images-common/images-grub2/grub2-3.png" title="Grub2" alt="Grub2" /></div>
							<p>Verwenden Sie die TAB-Taste, um OK zu wählen</p>

<div class="screenshot"><img src="../lib/images-common/images-grub2/grub2-convert-1.png" title="Grub2-conversion 1" alt="Grub2-conversion 1" /></div>

							<p>Verwenden Sie die Tastaturpfeile und die Leertaste, um einen <span class="highlight-3">* (Stern) </span> zu setzen, auf welcher Festplatte Grub2 in den MBR geschrieben werden soll. <i>(Das folgende Beispiel zeigt eine Installation auf ein USB-Laufwerk)</i>.</p>

						<h6>Schritt 4:</h6>
<pre>
update-grub
</pre>


						<h6>Schritt 5:</h6>
<pre>
apt-get install install-usb-gui fll-iso2usb
</pre>

						<h6>Schritt 6:</h6>
							<p> Starten Sie Ihren PC neu und menu.cfg zeigt Kernel und Betriebssystem wie in diesem Beispiel an:</p>
<div class="screenshot"><img src="../lib/images-common/images-grub2/grub2-os-list.jpg" title="Grub2-OS list" alt="Grub2-OS list" /></div>

							<p>Sollte etwas falsch gelaufen und Grub2 korrumpiert sein, lesen Sie <a href="sys-admin-grub2-de.htm#chroot">Überschriebener oder korrumpierter Grub2 im MBR</a> </p>


	      </div>
		<div class="divider" id="multi-os">
				<h2>Dualboot und Multiboot mit Grub2</h2>

							<p>Grub2 besitzt eine modulare Konfiguration und erlaubt daher einen einfachen Befehl, um neu installierte Betriebssysteme zu finden, die automatisch in die Datei menu.cfg integriert werden. Der einfache Befehl lautet:</p>
<pre>
update-grub
</pre>
							<p>Sollte ein benutzerdefinierter Eintrag in menu.cfg erwünscht sein oder falls 30_os-prober nicht die benötigten Chainload-Einträge durchführt, können Ergänzungen mit Hilfe eines Texteditors in der Datei <span class="highlight-3"> /etc/grub.d/40_custom</span> durchgeführt werden.</p>

							<p>Beispiele für eine Adaptierung der Datei 40_custom:</p>
<pre>
menuentry "second mbr"{
set root=(hd1)
chainloader +1
}
</pre>

<pre>
menuentry "second partition"{
set root=(hd0,2)
chainloader +1
}
</pre>
							<p>Nach Abspeicherung der Ändertungen müssen diese Grub übergeben werden:</p>
<pre>
update-grub
</pre>

							<p>Sollte die Fehlermeldung auftreten, dass Grub auf einem Laufwerk nicht erkannt wird, muss die devicemap neu erstellt werden.</p>

							<p><span class="highlight-3">Stellen Sie bei der Installation eines weiteren Betriebssystems sicher, dass Grub nicht in den MBR, sondern in die Partition des neuen Betriebssystems geschrieben wird:</span></p>

<pre>
grub-mkdevicemap --no-floppy
update-grub
</pre>
							<p>Warnhinweise können ignoriert werden.</p>

							<p>Bei einem Fehler überschreibt die Aktualisierung vermutlich den MBR. Wie dies repariert wird, finden Sie in <a href="sys-admin-grub2-de.htm#mbr-over-grub2">Grub2 - MBR überschrieben</a>.</p>
</div>
	<div class="divider" id="mbr-over-grub2">

					<h2>Nur grub2 neu von der Fesplatte in den MBR schreiben</h2>

<pre>
/usr/sbin/grub-install --recheck --no-floppy /dev/sda
</pre>
						<p>Es kann sein, dass dieser Befehl mehrfach ausgeführt werden muss, bis er "überzeugt" ist, dass dies wirklich durchgeführt werden soll.</p>

		<h2>MBR von Windows überschrieben - MBR korrumpiert - Wiederherstellung von Grub2</h2>
							<p><span class="highlight-2">ANMERKUNG: zur Wiederherstellung von Grub2 benötigt man eine 2009-04 (moros) sidux.iso oder später.</span> <a href="sys-admin-grub2-de.htm#chroot">Alternativ kann ein chroot mit jeder live.iso verwendet werden</a>.</p>

							<p>Um grub2 neu zu schreiben oder wiederherzustellen, muss in eine <span class="highlight-3">sidux.iso</span> gestartet werden:</p>
						<ol>
							<li>Um die Partitionen ([h,s]d[a..]X) zu identifizieren und bestätigen, muss man root (#) werden:
<pre>
$ sux
</pre>
							</li>
							<li>Als root wird Folgendes eingegeben:
<pre>
fdisk -l
cat /etc/fstab
</pre>
							Auf diese Weise erhält man die korrekten Benennungen.
							</li>
							<li>Wenn die korrekte Partitionsbezeichnung gefunden ist, wird ein Einhängepunkt erstellt:
<pre>
mkdir -p /media/[hdxx,sdxx,diskx]
</pre>
							</li>
							<li>Danach wird die Partition eingebunden:
<pre>
mount /dev/xdxx /media/xdxx
</pre>
							</li>

							<li>Jetzt kann Grub in den MBR der ersten Festplatte geschrieben werden:
<pre>
/usr/sbin/grub-install --recheck --no-floppy --root-directory=/media/xdxx /dev/sda
</pre>
							</li>
						</ol>
	      </div>
		<div class="divider" id="chroot">
		      <h3>Verwendung einer chroot-Umgebung zur Wiederherstellung eines überschriebenen oder korrumpierten Grub2 in MBR</h3>

							<p>Um Grub2 wiederherzustellen, falls er im MBR überschrieben oder korrumpiert wurde, muss eine <span class="highlight-3">chroot</span>-Umgebung aufgesetzt werden. <span class="highlight-3">Jede live.iso ist dafür geeignet</span>.</p>

							<p>Man bootet in eine Ihrem System entsprechende sidux.iso (32 oder 64 bit CD, DVD, USB-Stick oder SSD-Karte) und öffnet eine Konsole. Man tippt <span class="highlight-3">sux</span> und drückt die Eingabetaste, um root-Rechte zu erhalten.</p>

							<p>Mit <span class="highlight-3">fdisk -l oder blkid</span> stellt man sicher, welche Partition die Boot-Partition ist, und erhält die korrekten Bezeichnungen (falls eine graphische Oberfläche gewünscht ist, verwendet man <span class="highlight-3">Gparted</span>):</p>
<pre>
blkid
</pre>
							<p>Jetzt überprüft man, ob die Einträge in der Datei fstab mit der Ausgabe von blkid identisch sind:</p>
<pre>
cat /etc/fstab
</pre>
							<p>Hier wird angenommen, dass das root-Dateisystem sich auf <span class="highlight-3">/dev/sda2</span> befindet:</p>
<pre>
mkdir /mnt/sidux-chroot
mount /dev/sda2 /mnt/sidux-chroot
</pre>

							<p>Als nächstes müssen /proc und /dev wie folgt eingebunden werden:</p>
<pre>
mount -t proc proc /mnt/sidux-chroot/proc
mount -o bind /dev /mnt/sidux-chroot/dev
</pre>

							<p>Die chroot-Umgebung ist nun aufgesetzt und es kann auf diese Weise darauf zugegriffen werden:</p>
<pre>
chroot /mnt/sidux-chroot /bin/bash
</pre>

							<p>Es kann nun auf den lokalen Cache von apt zugegriffen werden bzw. in Dateien, die geändert werden müssen, geschrieben werden. Das Verhalten entspricht demjenigen, als ob Sie im zu reparierenden System selbst arbeiten würden. In folgendem Beispiel wird Grub2 neu in den MBR geschrieben:</p>

<pre>
apt-get install --reinstall grub2
</pre>
							<p>Folgen Sie den Anweisungen des Installationsprogramms.</p>

							<p>Mit diesem Befehl wird die chroot-Umgebung wieder frei gegeben:</p>
<pre>
Ctrl+d
</pre>
							<p>Starten Sie Ihren PC neu.</p>





	</div>
	<div id="rev">Page last revised 23/12/2009 0140 UTC</div>

</div>
</body>
</html>
