<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>sidux Manuals - NTP Time Server</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<div id="menu"> <!-- menu starts here en lang maintainer bluewater-->
<!--sidux-manual Operating System Manual menu-version-01.87.2009.05.25 -->
<!-- menu last updated by bluewater 2009.05.25 0735 hrs UTC -->
	<div id="menu-header">
	      <a href="http://sidux.com/"><img src="../lib/logos/sidux-logo.png" title="To sidux.com forums and wiki" alt="sidux.com logo" /></a>
	</div>
	<ul id="top-list">
		<li><a href="manual-search-en.htm#search-on"> <img src="../lib/logos/manual-search-22x22.png" title="Search Manual" alt="Search" />Search online - offline</a> </li>
		<li><a href="http://manual.sidux.com/meta-manual">sidux Meta-Manual</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-language-64.png" title="Choose another language" alt="lang-switch" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-en.htm">sidux OS Manual</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-en.htm#welcome-gen">sidux OS Manual</a></li>
				<li><a href="welcome-en.htm#how-to">How to use this manual</a></li>
				<li><a href="welcome-en.htm#table-contents">Table of Contents</a></li>
				<li><a href="help-en.htm#help-gen">Where to get Help</a></li>
				<li><a href="help-en.htm#paste">IRC !paste</a></li>
				<li><a href="credits-en.htm#cred-team">Credits</a></li>
				<li><a href="wel-quickstart-en.htm#welcome-quick">sidux Quick Start Guide</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-dl-burning-en.htm">ISO Content, Releases, Download Mirrors and Burning</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-en.htm#cd-content">ISO Content and system requirements</a></li>
				<li><a href="sys-admin-release-en.htm#rolling">Release Notes</a></li>
				<li><a href="cd-dl-burning-en.htm#download-sidux">sidux Mirrors, Downloading and Burning</a></li>
				<li><a href="cd-dl-burning-en.htm#md5">md5 Checksum</a></li>
				<li><a href="cd-dl-burning-en.htm#burn-nero">Burning in Windows</a></li>
				<li><a href="cd-dl-burning-en.htm#burn-linux">Burning in Linux</a></li>
				<li><a href="cd-dl-burning-en.htm#xdelta">xdelta Patching</a></li>
				<li><a href="cd-no-gui-burn-en.htm#burning-no-gui">burniso script</a></li>
				<li><a href="cd-no-gui-burn-en.htm#burn-no-gui-gen">Burning without a GUI</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="live-mode-en.htm">Live Mode</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="live-mode-en.htm#rootpw">Root-password on the sidux-Live ISO</a></li>
				<li><a href="live-mode-en.htm#live-cd-installsoft">Installing software whilst on a Live-ISO</a></li>
				<li><a href="live-mode-en.htm#ntfs-3g">Writing on NTFS-partitions with ntfs-3g</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="term-konsole-en.htm">The Terminal/Konsole</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="term-konsole-en.htm#sux"> sux</a></li>
				<li><a href="term-konsole-en.htm#term-kon"> Terminal/Konsole</a></li>
				<li><a href="term-konsole-en.htm#cli-help">Command Line Help</a></li>
				<li><a href="term-konsole-en.htm#term-cmds">Linux Terminal Commands List</a></li>
				<li><a href="term-konsole-en.htm#shell-scripts">Installing Scripts.sh</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="cheatcodes-en.htm">CheatCodes</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="cheatcodes-en.htm#cheatcodes">sidux specific Live-ISO Cheatcodes</a></li>
				<li><a href="cheatcodes-en.htm#cheatcodes-linux">Linux generic Cheatcodes</a></li>
				<li><a href="cheatcodes-vga-en.htm#vga">VGA Codes</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="part-gparted-en.htm">Partitioning Your Hard Drive</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="part-gparted-en.htm#partition">Partitioning your HD using GParted</a></li>
				<li><a href="part-gparted-en.htm#ntfs">NTFS partition Resizing using GParted</a></li>
				<li><a href="part-uuid-en.htm#uuid">UUID, Partition Labelling and fstab</a></li>
				<li><a href="part-cfdisk-en.htm#disknames">Disk Naming in brief</a></li>
				<li><a href="part-cfdisk-en.htm#partition">Partitioning  your HD using cfdisk</a></li>
				<li><a href="part-cfdisk-en.htm#formating">Formatting after partitioning with cfdisk</a></li>
				<li><a href="part-size-examp-en.htm#part-example">Partition Size Examples</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="hd-install-en.htm">Installation options</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="hd-install-en.htm#Inst-prep">Install Preparation</a></li>
				<li><a href="hd-install-en.htm#Installation">Installing to your HD</a></li>
				<li><a href="hd-install-en.htm#first-hd-boot">First Boot Up</a></li>
				<li><a href="hd-install-opts-en.htm#fromiso">Booting 'fromiso'</a></li>
				<li><a href="hd-install-opts-en.htm#fromiso-persist">fromiso and persist</a></li>
				<li><a href="hd-install-opts-en.htm#usb-hd">Installing on a USB-HD</a></li>
				<li><a href="hd-install-opts-en.htm#vtbox">Installing sidux with VirtualBox</a></li>
				<li><a href="hd-install-opts-en.htm#qemu">Installing sidux with QEMU</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-en.htm">Graphic Cards, Monitors, &amp; miscellaneous Drivers</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hw-dev-hw-dri-en.htm#hd-ntfs3g">Writing on NTFS-partitions with ntfs-3g</a></li>
				<li><a href="hw-dev-mon-en.htm#mon-res">Screen Resolution and Monitors</a></li>
				<li><a href="hw-dev-mon-en.htm#xrandr">Dual Monitors and xrandr</a></li>
				<li><a href="hw-dev-mon-en.htm#mon-binary">Dual Monitors (using binaries)</a></li>
				<li><a href="hw-dev-hw-dri-en.htm#non-free-3d">Binary, non-free drivers for: Nvidia / ATI</a></li>
				<li><a href="hw-dev-hw-dri-en.htm#native-nv-ati">Free xorg drivers for nVidia, ATI, Radeon, Intel</a></li>
				<li><a href="hw-dev-hw-dri-en.htm#non-free">Hardware needing non-free drivers</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="wm-kde-en.htm">Window Managers</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="wm-xfce-en.htm#xfce-notes">Useful Xfce extras</a></li>
				<li><a href="wm-kde-en.htm#install-add">Useful extra KDE Apps</a></li>
				<li><a href="wm-kde-en.htm#desk-freeze">Desktop Freezes</a></li>
				<li><a href="wm-kde-en.htm#kde-login">Cant login in KDE</a></li>
				<li><a href="wm-kde-en.htm#ch-th">Changing Themes</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="lamp-apache-en.htm">sidux LAMP Stack</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="lamp-apache-en.htm#serv-apache">sidux LAMP Stack</a></li>
				<li><a href="lamp-apache-en.htm#serv-ftp">FTP Clients</a></li>
				<li><a href="lamp-apache-en.htm#serv-sec">Security Protocols</a></li>
				<li><a href="lamp-apache-en.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-en.htm#serv-mysql">MySQL Setup</a></li>
				<li><a href="lamp-ppp-en.htm#serv-php">PHP in Apache</a></li>
				<li><a href="ntp-server-en.htm#ntp-server">Timeserver Setup</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="internet-connecting-en.htm">Internet and Networking</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="tor-privoxy-en.htm#tor">Tor</a></li>
				<li><a href="tor-privoxy-en.htm#privoxy">Privoxy</a></li>
				<li><a href="internet-connecting-en.htm#firewalls">Firewalls</a></li>
				<li><a href="samba-en.htm#configure">Configuring SAMBA (Windows)</a></li>
				<li><a href="samba-en.htm#setup">Samba-Server Setup</a></li>
				<li><a href="ssh-en.htm#ssh-fs">SSH Remote Mounting</a></li>
				<li><a href="ssh-en.htm#ssh-x">X Window Apps via SSH</a></li>
				<li><a href="ssh-en.htm#ssh-f">GUI SSH with Konqueror</a></li>
				<li><a href="ssh-en.htm#ssh-w">SSH X-Forwarding from Windows-PC</a></li>
				<li><a href="ssh-en.htm#ssh">SSH and Security</a></li>
				<li><a href="internet-connecting-en.htm#dial-mod">56k Modems</a></li>
				<li><a href="internet-connecting-wpagui-en.htm#wpa-roaming-gui">WiFi - roaming WPA-GUI</a></li>
				<li><a href="internet-connecting-wpa-en.htm#wpa-basic">WiFi - Basic setup guide</a></li>
				<li><a href="internet-connecting-wpa-en.htm#wpa">WiFi - wpasupplicant</a></li>
				<li><a href="internet-connecting-en.htm#netcardconfig">Getting Online - Ceni</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="sys-admin-apt-en.htm">dist-upgrade and Package Management</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="sys-admin-apt-en.htm#apt-cook">APT-Guide Cookbook and Sources list</a></li>
				<li><a href="sys-admin-meta-en.htm#meta-pack">Meta-Package Installer</a></li>
				<li><a href="sys-admin-meta-en.htm#meta-proxy">Meta Installer and Proxies</a></li>
				<li><a href="sys-admin-apt-en.htm#apt-install">Installing a new package</a></li>
				<li><a href="sys-admin-apt-en.htm#apt-delete">Deleting a package</a></li>
				<li><a href="sys-admin-apt-en.htm#apt-downgrade">Package Hold and downgrading</a></li>
				<li><a href="sys-admin-apt-en.htm#apt-cache">Package searching with apt-cache</a></li>
				<li><a href="sys-admin-apt-en.htm#gui-pacsea">GUI Package searching</a></li>
				<li><a href="siduxcc-en.htm#hermes">sidux-hermes</a></li>
				<li><a href="sys-admin-upgrade-en.htm#live-cd-upgrade">Upgrading by Live-ISO</a></li>
				<li><a href="sys-admin-kern-upg-en.htm#kern-upgrade">Upgrading the kernel</a></li>
				<li><a href="sys-admin-apt-en.htm#apt-upgrade">Upgrade an Installed System -  dist-upgrade</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-gen-en.htm">System Administration</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="hd-install-en.htm#adduser">Adding a new user</a></li>
				<li><a href="home-en.htm#home-bu">Moving /home</a></li>
				<li><a href="siduxcc-en.htm#siduxcc">sidux Control Centre</a></li>
				<li><a href="sys-admin-rdiff-en.htm#rdiff">Back-Up with rdiff</a></li>
				<li><a href="sys-admin-rsync-en.htm#rsync">Back-Up with rsync</a></li>
				<li><a href="vir-rkits-en.htm#virus-rkits">Virus and Rootkit Scanners</a></li>
				<li><a href="sys-admin-gen-en.htm#start-services">Services enable/disable</a></li>
				<li><a href="sys-admin-gen-en.htm#pw-lost">Lost root passwords</a></li>
				<li><a href="sys-admin-gen-en.htm#fonts">Fonts</a></li>
				<li><a href="sys-admin-gen-en.htm#cups">CUPS</a></li>
				<li><a href="sys-admin-gen-en.htm#init">sidux runlevels - init</a></li>
				<li><a href="sys-admin-grub-bootman2-en.htm#mbr-grub-boot">MBR Overwritten bootsector</a></li>
				<li><a href="sys-admin-grub-bootman2-en.htm#dual-boot">Dual and Multibooting</a></li>
				<li><a href="bios-freedos-en.htm#bois-prep">Upgrading the BIOS with FreeDOS</a></li>
				<li><a href="sys-admin-grub-bootman2-en.htm#boot-grub-floppy">Creating a Boot-Floppy</a></li>
				<li><a href="sys-admin-grub-bootman2-en.htm#remove-grub">Removing grub from MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-en.htm#what-is-grub">Grub the boot manager</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
	<div class="divider" id="ntp-server">
			<h2 id="top-header">Timeserver Setup</h2>


				<p>First in console as root</p>
<pre>
apt-cache search ntp
apt-get update &amp;&amp; apt-get install  ntp ntp-doc
update-rc.d -f ntp defaults
run update-rc.d later,after doing some configgering
</pre>

				<p>Find the docs on your system at</p>
<pre>
/usr/share/doc/ntp-doc/html/index.html 
and bookmark it!
</pre>


				<p>It is a large document,and not all of it applies, as it is comprehensive.</p>

				<p>ntp will not activate until you reboot, but you should set your time as accurately as possible before rebooting.</p>

				<p>ntp will get its time from the list of servers in /etc/ntp.conf, which is the main file to edit.</p>

				<p>Both the ntpdate and the ntpd daemon [called ntp] poll the list of timeservers near the top of /etc/ntp.conf.. here is a list as an example:</p>

<pre>
 pool.ntp.org maps to more than 100 low-stratum NTP servers.
# Your server will pick a different set every time it starts up.
#  *** Please consider joining the pool! ***
#  ***  <a href="http://www.pool.ntp.org/#join">http://www.pool.ntp.org/#join</a>  ***
server 192.168.3.24
server ntp.blueyonder.co.uk
server uk.pool.ntp.org
server 1.uk.pool.ntp.org
server 2.uk.pool.ntp.org
server 0.europe.pool.ntp.org
server 1.europe.pool.ntp.org
server 2.europe.pool.ntp.org
</pre>



				<p>The first one is the other box on the same network, also running ntp [on there it is 'server 192.168.3.1']</p>
				<p>The second is the timeserver of the ISP you are connected to.</p>
				<p>Next are some of the uk.pool.ntp.org, then a few europeans for good luck By the way , your own isp-nameservers are often also timeservers,  you can check this by running:</p>

<pre>
ntpdate -v
</pre>


				<p>This will not which change anything, but will return a time-result,something like:</p>
<pre>
# ntpdate -v 192.168.3.24
19 Sep 19:09:27 ntpdate[13329]: ntpdate 4.2.2@1.1532-o Wed Aug  9 12:08:54 UTC 2006 (1)
</pre>
							<p><a href=" http://www.pool.ntp.org"> A full list of ntp timeservers is here http://www.pool.ntp.org/</a></p>

				<p>Then you want to allow access to your local boxes</p>
<pre>
# Local users may interrogate the ntp server more closely.
restrict 127.0.0.1 nomodify
restrict 192.168.3.0/24
</pre>


				<p>Now you want to broadcast:</p>
<pre>
# If you want to provide time to your local subnet, change the next line.
# (Again, the address is an example only.)
broadcast 192.168.3.255
</pre>


				<p>The ntp.conf file itself is a bit odd, its treated as a diff if you just click on it. Before you start ntp, you must set the time, ie</p>
<pre>
# ntpdate -u -b uk.pool.ntp.org
19 Sep 19:19:33 ntpdate[15641]: step time server 62.3.200.116 offset 0.001523 sec
</pre>


				<p>Then start ntp, as a service,to start at every boot [ie, reboot] after ntp has run for a few, do:</p>
<pre>
ntpq -pn
</pre>


				<p>If all has gone well, you should see something like:</p>
<pre>
# ntpq -pn
remote           refid      st t when poll reach   delay   offset  jitter
----------------------------------------------------------------------------
192.168.3.24    .INIT.          16 u    - 1024    0    0.000    0.000   0.000
+194.117.157.4   192.5.41.40      2 u   97  128  377    7.849    1.548  30.157
*82.219.3.1      195.66.241.2     2 u  101  128  377   17.755    0.794  24.722
 82.133.58.132   .INIT.          16 u    - 1024    0    0.000    0.000   0.000
+194.153.168.75  195.66.241.3     2 u   37  128  377   23.475    3.259  12.203
+82.68.126.114   209.81.9.7       2 u  101  128  377   44.567   -1.366  46.922
+194.88.2.88     194.159.73.44    3 u   90  128  377   17.208   -5.569  27.527
+130.226.232.145 213.112.52.151   3 u   89  128  377   62.130   -0.797  39.999
 127.127.1.0     .LOCL.          10 l   18   64  377    0.000    0.000   0.001
 192.168.3.255   .BCST.          16 u    -   64    0    0.000    0.000   0.001
</pre>


				<p>That asterisk on the 3rd line in this example: *82.219.3.1, is showing the active timeserver, that is deemed most worthy. It means you are now keeping good time, and it uses port 123  An example of an iptables line is:</p>
<pre>
# Network Time Protocol (NTP) Server
$IPT -A udp_inbound -p UDP -s 0/0 --destination-port 123 -j ACCEPT
$IPT -A INPUT -j ACCEPT -p tcp --dport 123
</pre>

	</div>
			<div id="rev">Content last revised 24/02/2009 1300 UTC </div>

</div>
</body>
</html>
