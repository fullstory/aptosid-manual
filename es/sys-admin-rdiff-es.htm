<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>Manuales de sidux - rdiff</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<div id="menu"> <!-- menu starts here es lang maintainer Richard-->
<!--Welcome to the Official sidux-manual  01.24-2007-07-23 -->
<!-- menu last updated by bluewater 23/07/2007 1900rs AEST 23/07/2007 0900hrs UTC -->
<img src="../lib/logos/sidux-logo.png" alt="logo" id="menu-header" />
	<ul id="top-list">
		<li><a href="http://sidux.com/">A sidux.com</a></li>
		<li><a href="http://manual.sidux.com/meta-manual">sidux Meta-Manual</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-lang-50.png" title="Seleccione otra idioma." alt="lang-switch" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-es.htm">sidux OS Manual</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-es.htm#welcome-gen">sidux OS Manual</a></li>
				<li><a href="welcome-es.htm#how-to">¿Cómo utilizar el manual?</a></li>
				<li><a href="welcome-es.htm#table-contents">Indice</a></li>
				<li><a href="help-es.htm#help-gen">¿Dónde conseguir ayuda?</a></li>
				<li><a href="credits-es.htm#cred-team">Créditos</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-content-es.htm">Contenido del CD</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-es.htm#cd-content">Contenido del CD</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="cd-dl-burning-es.htm">Bajar y Quemar</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="cd-dl-burning-es.htm#download-sidux">Bajar y Quemar</a></li>
				<li><a href="cd-dl-burning-es.htm#md5">Suma de verificación, md5</a></li>
				<li><a href="cd-dl-burning-es.htm#burn-nero">Quemando en Windows</a></li>
				<li><a href="cd-dl-burning-es.htm#burn-linux">Quemando en Linux</a></li>
				<li><a href="cd-dl-burning-es.htm#xdelta">Parches con xdelta</a></li>
				<li><a href="cd-no-gui-burn-es.htm">Quemando sin GUI</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="live-mode-es.htm">LiveCD: el Modo en Vivo</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="live-mode-es.htm#rootpw">Clave root del LiveCD de sidux</a></li>
				<li><a href="live-mode-es.htm#live-cd-installsoft">Instalar software usando el LiveCD</a></li>
				<li><a href="live-mode-es.htm#ntfs-3g">ntfs-3g-Escribir en particiones NTFS</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="term-konsole-es.htm">Terminal/Consola</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="term-konsole-es.htm#term-kon">Terminal/Consola</a></li>
				<li><a href="term-konsole-es.htm#cli-help">Ayuda en la línea de comando</a></li>
				<li><a href="term-konsole-es.htm#term-cmds">Comandos del Terminal Linux</a></li>
				<li><a href="term-konsole-es.htm#shell-scripts">Instalando Scripts.sh</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="cheatcodes-es.htm">CheatCodes</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="cheatcodes-es.htm#cheatcodes">Cheatcodes</a></li>
				<li><a href="cheatcodes-vga-es.htm#vga">Códigos VGA</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="part-gparted-es.htm">Particionando el Disco Duro</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="part-gparted-es.htm#partition">Particionando el DD usando GParted</a></li>
				<li><a href="part-gparted-es.htm#ntfs">Redimensionar una partición NTFS utilizando GParted</a></li>
				<li><a href="part-uuid-es.htm#uuid">UUID, Label de Partición y fstab</a></li>
				<li><a href="part-cfdisk-es.htm#partition">Particionando el DD con cfdisk</a></li>
				<li><a href="part-cfdisk-es.htm#formating">Reformatear particiones después de particionar con cfdisk</a></li>
				<li><a href="part-size-examp-es.htm#part-example">Ejemplos de dimensiones de particiones</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hd-install-es.htm">Opciones de la Instalación</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hd-install-es.htm#Inst-prep">Preparación para la instalación</a></li>
				<li><a href="hd-install-es.htm#Installation">Instalando al DD</a></li>
				<li><a href="hd-install-es.htm#first-hd-boot">Primer Arranque</a></li>
				<li><a href="hd-install-opts-es.htm#fromiso">Arrancando "fromiso"</a></li>
				<li><a href="hd-install-opts-es.htm#usb-hd">Instalando en un USB-DD</a></li>
				<li><a href="hd-install-opts-es.htm#qemu">Instalando a través de QEMU</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-es.htm">Tarjetas Gráficas, Hardware y Drivers</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="hw-dev-hw-dri-es.htm#hd-ntfs3g">Escribiendo en NTFS</a></li>
				<li><a href="hw-dev-hw-dri-es.htm#non-free-3d">Drivers binarios, no-libre para Nvidia / ATI</a></li>
				<li><a href="hw-dev-hw-dri-es.htm#native-nv-ati">Drivers libres de xorg para nVidia, ATI, Radeon, Intel</a></li>
				<li><a href="hw-dev-hw-dri-es.htm#mon-res">Resoluciones y Monitores </a></li>
				<li><a href="hw-dev-hw-dri-es.htm#non-free">Hardware con necesidades no-libres</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="wm-kde-es.htm">Gestor de Ventanas</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="wm-kde-es.htm#desk-freeze">El escritorio de KDE se traba</a></li>
				<li><a href="wm-kde-es.htm#kde-login">No puedo hacer login en KDE</a></li>
				<li><a href="wm-kde-es.htm#ch-th">Cambiando temas</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="lamp-apache-es.htm">sidux LAMP Stack</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="lamp-apache-es.htm#serv-apache">sidux LAMP Stack</a></li>
				<li><a href="lamp-apache-es.htm#serv-ftp">Clientes FTP</a></li>
				<li><a href="lamp-apache-es.htm#serv-sec">Protocolos de seguridad</a></li>
				<li><a href="lamp-apache-es.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-es.htm#serv-mysql">Configuración MySQL</a></li>
				<li><a href="lamp-ppp-es.htm#serv-php">PHP en Apache</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide(12 );" onmouseout="startTime();" ><a href="internet-connecting-es.htm">El Internet y Redes</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="ntp-server-es.htm#ntp-server">Configurar un servidor horario</a></li>
				<li><a href="tor-privoxy-es.htm#tor">Tor</a></li>
				<li><a href="tor-privoxy-es.htm#privoxy">Privoxy</a></li>
				<li><a href="internet-connecting-es.htm#firewalls">Firewalls</a></li>
				<li><a href="samba-es.htm#configure">Configurar SAMBA-Win</a></li>
				<li><a href="samba-es.htm#setup">Configurar Samba</a></li>
				<li><a href="ssh-es.htm#ssh-fs">Montar con SSH</a></li>
				<li><a href="ssh-es.htm#ssh-x">Aplicaciones X Window via SSH</a></li>
				<li><a href="ssh-es.htm#ssh-f">SSH con Konqueror</a></li>
				<li><a href="ssh-es.htm#ssh-w">Adelanto-X con SSH desde Win-PC</a></li>
				<li><a href="ssh-es.htm#ssh-s">SSH: Seguridad</a></li>
				<li><a href="internet-connecting-es.htm#dial-mod">Módems de 56k</a></li>
				<li><a href="internet-connecting-es.htm#ndiswrapper">Activando Ndiswrapper</a></li>
				<li><a href="internet-connecting-wpa-es.htm#wpa">WIFI-WLAN</a></li>
				<li><a href="internet-connecting-es.htm#internetsharing">Compartir Internet</a></li>
				<li><a href="internet-connecting-es.htm#netcardconfig">Conectándose en línea</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-apt-es.htm">Instalar/ Quitar/ Revertir un paquete</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="sys-admin-apt-es.htm#apt-cook">APT y sources.list</a></li>
				<li><a href="sys-admin-meta-es.htm#meta-pack">Meta-Paquetes</a></li>
				<li><a href="sys-admin-meta-es.htm#meta-proxy">Meta-Instalador y Proxies</a></li>
				<li><a href="sys-admin-apt-es.htm#apt-install">Instalar paquete</a></li>
				<li><a href="sys-admin-apt-es.htm#apt-delete">Quitar paquete</a></li>
				<li><a href="sys-admin-apt-es.htm#apt-downgrade">Revertir un paquete</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 14 );" onmouseout="startTime();" ><a href="sys-admin-apt-es.htm">Administración del Sistema</a>
			<ul class="sub-menu" id="sm14">
				<li><a href="sm-siduxcc-es.htm#sm">smxi sintaxis de comandos</a></li>
				<li><a href="sm-siduxcc-es.htm#siduxcc">siduxcc</a></li>
				<li><a href="sys-admin-apt-es.htm#apt-upgrade">Actualizar Sistema Instalado</a></li>
				<li><a href="sys-admin-upgrade-es.htm#live-cd-upgrade">Actualizar con Live-CD</a></li>
				<li><a href="sys-admin-kern-upg-es.htm#kern-upgrade">Actualizar el Kernel</a></li>
				<li><a href="sys-admin-rdiff-es.htm#rdiff">Respaldar con rdiff</a></li>
				<li><a href="sys-admin-rsync-es.htm#rsync">Respaldar con rsync</a></li>
				<li><a href="vir-rkits-es.htm#virus-rkits">Virus y Rootkit</a></li>
				<li><a href="sys-admin-gen-es.htm#start-services">Activar servicios</a></li>
				<li><a href="sys-admin-gen-es.htm#pw-lost">Clave root perdida</a></li>
				<li><a href="sys-admin-gen-es.htm#fonts"> Fuentes</a></li>
				<li><a href="sys-admin-gen-es.htm#cups"> CUPS</a></li>
				<li><a href="sys-admin-grub-bootman2-es.htm#mbr-grub-boot">Sobre-escribir el MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-es.htm#dual-boot">Arrancada Dual y Múltiple</a></li>
				<li><a href="sys-admin-grub-bootman2-es.htm#boot-grub-floppy">Floppy del Sistema</a></li>
				<li><a href="sys-admin-grub-bootman2-es.htm#remove-grub">Quitar Grub del MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-es.htm#what-is-grub">Grub: Inicializador</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
	<div class="divider" id="rdiff">
			<h2 id="top-header">Respaldando a sistema con rdiff-backup</h2>
				<p>rdiff-backup es una herramienta para respaldar sus archivos. (Puede ser utilizado en cualquier variedad de *nix).<br /> La ventaja sidux es de tener opciones, tales como iniciar procesos: hagalo usted mismo o con un script.</p>

				<h3><a href="http://techpatterns.com/forums/about831.html">Este es la versión con el script realizado y mantenido por h2.</a></h3>
	<div class="spacer02"></div>
			<h5>Lo siguiente es la versión de Hagalo Usted Mismo (DIY).</h5>

			<h6>rdiff-backup</h6>

				<p class="highlight-2">Ejecuta los comandos como root en una consola, a menos que se le indique otra cosa.</p>

				<p>*Para recuperar de un dist-upgrade, kernel-upgrade fallido, etc., (y también para restaurar archivos individuos).<br /> *solamente respalda lo que han sido cambiado como rsync (así que cada respaldo no lleva tanto tiempo).<br /> *mantenga una historia de cambios (esto permite que puede restaurar un archivo borrado hace tres semanas!)<br /> *realiza respaldos seguros sobre una red (usando ssh).<br /> *respalda particiones aunque estén montados (facilita la automatización de un respaldo diario ... no tiene que desmontar).<br /> *puede restaurar todo si el disco duro se muere y tiene que reemplazarlo con otro.<br /> *Respaldar redes grandes (sin problemas en Linux, más difícil con Windows) y es usado bastante por negocios.<br /> *es una aplicación manejado por la línea de comando, así que es bueno para aquellos que le gustan hacer cosas tales como automatizar respaldos con poder (por ejemplo, un script de bash llamado por cron).<br /> *recuerda y tratar con permisos y dueños de archivos, y además tratar con enlaces simbólicos (y todo este tipo de cosas) así cuando hagas la restauración, se encuentra las cosas exactamente como estaban.</p>

			<h6>Lo que vas a necesitar</h6>
				<p>rdiff-backup 	mantenga una copia (no comprimida) de los archivos que están respaldando, y también mantenga una historia (respaldos incrementales), que significa que el espacio de respaldo tiene que ser más grande de lo que estas respaldando. Si están respaldando datos ocupando 100 giga de espacio, puede necesitar 120 giga de espacio (preferiblemente en un otro disco duro separado!).</p>

			<h6>Como configurarlo</h6>
				<p>Vamos a definir un caso hipotético:<br /> * un disco duro de 100 gigabytes (hda) esta en uso, con la montura hda1 usado para el partición /root (raíz) y la montura hda5 usado para almacenar musica y otros archivos; mientras que la montura hda6 es usado para swap.<br /> * en un otro disco duro de 200 giga (hdb) que no esta siendo utilizado por la sistema, con una sóla montura hdb1 ... vamos a utilizar este para nuestros respaldos.<br /> * la dirección IP es 192.168.0.1</p>

				<p>La primera cosa ha hacer es instalar rdiff-backup:</p>
<pre>
# apt-get install rdiff-backup
</pre>
				<p>Ahora, aunque podemos respaldar cualquier directorio, este caso hipotética es para respaldar particiones enteros --deseamos respaldar el hda1 y hda5 (no queremos respaldar el hda6), entonces creamos unas directorios para almacenar los datos:</p>
<pre>
# mkdir /media/hdb1/rdiff-backups/192.168.0.1/root
# mkdir /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>Se necesita distinguir la dirección IP por que si desea utilizar este computador de respaldar otro (cubierto más adelante).</p>

			<h6>Respaldando</h6>

				<p>rdiff-backup usa el sintaxis <span class="highlight-3">rdiff-backup fuente-dir destinación-dir</span>. Nota: siempre especifica nombres de directorios, no los nombres de archivos.</p>

				<p>Para respaldar el hda5, ejecuta:</p>
<pre>
# rdiff-backup /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>Y para respaldar la partición-raíz, ejecuta:</p>
<pre>
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/hdb1/rdiff-backups/192.168.0.1/root
</pre>
				<p>Cualquier error del tipo "AF_UNIX ruta demasiado largo" puede ser ignorado sin perjuicio. Esto puede llevar bastante tiempo, porque es la primera vez que la partición esta siendo respaldado, entonces el rdiff-backup tendrá que respaldar la partición entero (no solamente las diferencias). Nota que tampoco deseamos respaldar /tmp por que este siempre esta cambiando, ni el /proc ni /sys, en vista que estos no contiene archivos verdaderas de datos, ni tampoco deseamos respaldar puntos de monturas. Si incluya respaldos para monturas, estará respaldando el hdb1, y podemos entrar en un circulo infinito! Una manera de evitar eso es de respaldar las monturas separadamente.</p>

				<p>Ahora, la razón porque se usa '/proc/*' en vez de solamente '/proc' es que este causa que se respalda el nombre del directorio, /proc, pero se ignorar todo su contendido. Lo mismo para /tmp, /sys y  aún más ingenioso todos los nombres de las puntos de monturas.</p>

				 <p>Así, si destrozas su partición-raíz y hagas una restauración completa, /tmp, /proc, /sys y todos los demás nombres de puntos de monturas serán creado (justamente como deben ser). Si el /tmp no existe cuando el X arranque, puede quejar).  Ver la página man para más información sobre --exclude y --include).</p>

			<h6>Restaurando directorios de un respaldo</h6>

				<p>rdiff-backup usa el sintaxis:</p>
<pre>
rdiff-backup -r &lt;from-when&gt; &lt;source-dir&gt; &lt;dest-dir&gt;
</pre>
				<p>Ahora, si accidentalmente borra el directorio /media/hda7/photos, puede restaurarlo ejecutando lo siguiente:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5/photos /media/hda5/photos
</pre>
				<p>El opción "-r now" significa restaurar desde el respaldo más reciente. Si estuvo respaldando todo periódicamente (quizás con crontab), y no realiza que el directorio de fotos estaba perdido hasta unas días después, necesitará restaurar de un respaldo de hace unas días (y no del "now", en vista que el último respaldo dice que /photos no existe). O quizás solamente quieres volver a una versión previa de algo.</p>

				<p>Si desea restaurar desda hace tres días, entonces utiliza "-r 3D", pero como dice en el pagina man, nota:</p>

				<p class="highlight-1">"3D" refiere a la instante 72 horas antes del presente, y si no existe respaldo creado justo a este momento, el rdiff-backup restaura el estado grabado para el respaldo previo. Por ejemplo, en el caso arriba, si "3D" fue utilizado, y hubo respaldos de hace 2 días y 4 días, el directorio sera restaurado a como era hace 4 días (entonces, tiene que pensar un poco antes que lleva a cabo la restauración).</p>

				<p>Utiliza lo siguiente para una lista de fechas y horas de cuando fue realizados respaldos para el hda5:</p>
<pre>
# rdiff-backup -l /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
			<h5>Restaurando particiones</h5>

				<p>También puede restaurar particiones enteros (mounts), después de todo, una punta de montura es actualmente una directorio.</p>

				<p class="highlight-2">PRECAUCIÓN:  No restaurar la partición-raíz mientras que estas arrancado en el! Con un sólo comando puedo perder todos sus archivos en todos los particiones, incluyendo todos los respaldos en un disco duro separado!! rdiff-backup haga exactamente lo que esta instruido --si el respaldo para la partición-raíz tiene puntas de monturas vacíos, entonces para restaurar todos a como esta el respaldo, tiene que borrar todo en las puntas de monturas para poder hacer todos igual como el respaldo.</p>

				<p>Restaura el hda5 desde el último respaldo, simplemente ejecuta:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5 /media/hda5
</pre>
			<h5>Restaurando la partición-raíz</h5>

				<p>Pero para restaurar la partición-raíz, no es tan sencillo. No se restaura la partición-raíz mientras que esta montado (ver la PRECAUCIÓN arriba). Es realmente útil de poder restaurar la partición-raíz, así que si hace un desastre instalando/actualizando, o instalando un kernel nuevo, etc, tienes el confort de que se puede retroceder hacia donde estaba antes, y sólo necesitas unas 20 minutos.</p>

				<p>Un manera de restaurar la partición-raíz es de arrancar en una partición de Linux extra, si tiene una en el disco duro. Entonces, puedes restaurar la partición que deseas, por que ahora no esta montado como /root. Después de restaurar la partición, volver arrancar en el, y será exactamente como estaba cuando lo respaldaran --exactamente! Este es por mucho el método más fácil.</p>

				<p>Otra manera de restaurar la partición-raíz es arrancar con el LiveCD de sidux y llevar a cabo la restauración desde allí. El rdiff-backup es incluido en sidux. En el caso que la versión del LiveCD de sidux no contiene rdiff, puede tipear en la linea de comando de Grub (ver Opciones de Arranque, Cheatcodes), el cheatcode "unionfs" y eso te permite instalar aplicaciones usando el LiveCD. Solamente arranca y entrar los siguientes comandos:</p>
<pre>
$ sudo su
# wget -O /etc/apt/sources.list http://sidux.com/files/misc/sources.list
# apt-get update
# apt-get install rdiff-backup
</pre>
				<h6>Ahora, vamos hacer la restauración:</h6>
<pre>
# mount /dev/hda1 /media/hda1
# mount /dev/hdb1 /media/hdb1
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>Nota: Si no tiene un LiveCD de sidux, pero el que tiene apoya el "klik", puede instalar el rdiff-backup utilizando klik, y llamando:</p>
<pre>
$ sudo ~/.zAppRun ~/Desktop/rdiff-backup_0.13.4-5.cmg rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>Es recomendado que cualquiera haciendo un respaldo del partición-raíz (con la intención de restaurarlo si es necesario), debe comprobar que funciona el proceso de restauración. Nada es peor que pensar que todo esta bien, y luego encontrar algo inesperado durante una emergencia.</p>

			<h5>Respaldando otros PCs</h5>

				<p>Puede respaldar otro PC en el PC local, mientras que el PC local puede ssh a la otro PC (y que tiene espacio en su disco duro). El servidor ssh (sshd) tiene que ser ejecutando en un PC remoto. Los demás PCs no tienen que ser en el LAN local, puede ser en cualquier parte del mundo.</p>

				<p>Asumimos que el PC remoto tiene los siguiente:<br /> 1) un disco duro de 100 giga (hda) en uso, con solamente monturas,<br /> 2) el hda1 esta utilizado para la partición-raíz,<br /> 3) en el hda5 estamos almacenando archivos temporales que no desea respaldar,<br /> 4) y el hda6 es el swap para la dirección IP: 192.168.0.2</p>

				<p>Nota: ambos discos duros de 100 giga normalmente no puede ser respaldado en el disco de 200 giga con rdiff-backup (por falta de espacio para los archivos incrementales), pero en vista de que no estamos respaldando el hda5 en el PC remoto (y por que los discos duros usualmente no estan 100% lleno, aún que 	no siempre cuenta en eso) entonces puede calcular que hay suficiente espacio. Cada vez que rdiff-backup realiza un respaldo, más archivos incrementales están creados, y este necesita más y más espacio.</p>

				<p>Puede decir a rdiff-backup de solamente guarda un máximo de respaldos de 1 mes (este comando se muestra más adelante), y este se requiere menos espacio que decir a rdiff-backup de mantener respaldos de datos de un año. Y, por supuesto, si desea tener un año de respaldos de datos, entonces hay que tener suficiente espacio en el disco duro para almacenar un año de respaldos con su archivos incrementales.</p>

				<p>La primer cosa de hacer es instalar el rdiff-backup en el PC remoto también, (tanto como en cada computador que desea respaldar, incluyendo el servidor de respaldo tiene que tener el rdiff-backup instalado).</p>

				<p>Para respaldar el PC remoto en un PC local, ejecuta en el PC local (por ejemplo: 192.168.0.1):  <span class="highlight-4">Nota el uso del doble colon :: </span></p>
<pre>
# mkdir /media/hdb1/rdiff-backups/192.168.0.2/root
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' 192.168.0.2::/media/hdb1/rdiff-backups/192.168.0.2/root
</pre>
				<p>Ahora si deseas restaurar un directorio en el PC remoto, iniciar la restauración en el PC local o en el PC remoto.</p>

				<p>Este es como podía restaurar el directorio /usr/local/games en un PC remoto, iniciándolo desde el PC remoto:</p>
<pre>
# rdiff-backup -r now 192.168.0.1::/media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games /usr/local/games
</pre>
				<p>Este es como podía restaurar el directorio /usr/local/games en un PC remoto, iniciándolo desde el PC local:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games 192.168.0.2::/usr/local/games
</pre>
				<p>Utiliza la misma sintaxis cuando restaura la partición-raíz desde un LiveCD (donde el PC remoto ha sido arrancado via un LiveCD --ver arriba).</p>

			<h5>Automatizando respaldos:</h5>

				<p>Si esta respaldando desde otro PCs hacia un PC local, la primer cosa de hacer es activar los login's de ssh sin clave usando claves ssh. <span class="highlight-2">Nota que este es hablando de hacer un login ssh como root. Este puede ser fijado para que solamente comandos de rdiff-backup están ejecutado, pero eso es más allá del alcance de este tópica. Por favor, referirse a <a href="samba-es.htm#ssh-s">Configuración SSH </a>. </span>Estamos asumiendo confianza total, y vamos a configurar la manera más sencilla de lograr logins sin clave.</p>

				<p>Desde el PC local, haga lo siguiente:</p>
<pre>
# [ -f /root/.ssh/id_rsa ] || ssh-keygen -t rsa -f /root/.ssh/id_rsa
</pre>
				<p>Y oprima Enter dos veces para claves en blanco. Entonces, entra:</p>
<pre>
# cat /root/.ssh/id_rsa.pub | ssh 192.168.0.2 'mkdir -p /root/.ssh;\<!--dunno if this is wrong-->
&gt; cat - &gt;&gt;/root/.ssh/authorized_keys2'
</pre>
				<p>Se le va a pedir su clave de raíz.</p>

				<p>Ahora puede "ssh" al PC remoto como raíz sin tener que tipear un clave, y el respaldo con rdiff-backup puede ser automatizado.</p>

				<p>Próxima, crea un script de bash que contiene todos los comandos de rdiff-backup. Nuestro script puede parecer como esto:</p>


<pre>
#!/bin/bash
RDIFF=/usr/bin/rdiff-backup
echo
echo "=======Respaldando 192.168.0.1 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/hdb1/rdiff-backups/192.168.0.1/root
echo "(y purgar incrementos mayor que 1 mes)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/root
echo
echo "=======Respaldando 192.168.0.1 montura hda5======="
${RDIFF} --ssh-no-compression --exclude /media/hda5/myjunk /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo "(y purgar incrementos mayor que 1 mes)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo
echo "=======Respaldando 192.168.0.2 root======="
$${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' --exclude '/mnt/*/*' 192.168.0.2::/media/hdb1/rdiff-backups/192.168.0.2/root
echo "(y purgar incrementos mayor que 1 mes)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.2/root
</pre>


				<p>Ahora, puede nombrar este script de bash, "myrdiff-backups.bash" y colocarlo en /usr/local/bin en nuestro servidor de respaldos local, y cambiarlo a ser ejecutable. Ejecuta el script para asegurar que funciona.</p>

				<p>Y últimamente, configurar cron para llamarlo cada noche a las 8 PM. El siguiente línea en el crontab de root debe servir, llama</p>
<pre>
# crontab -e
y insertar la línea siguiente
0 20 * * * /usr/local/bin/myrdiff-backups.bash
</pre>
			<div id="rev">Page last revised 05/05/2007 0080 UTC</div>
</div>
</div>
</body>
</html>
