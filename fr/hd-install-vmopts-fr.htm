<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>sidux Manuals - VM Installation Options</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<!-- Last translation revision by bluewater 22/04/2009 1350hrs UTC -->
<div id="menu"> <!-- menu starts here fr lang maintainer LjanA, alphad-->
<!--sidux-manual Operating System Manual menu-version-02.05.2010.04.10 -->
<!-- menu last updated by bluewater 2010.04.10 1300 hrs UTC -->
	<div id="menu-header">
	      <a href="http://sidux.com/"><img src="../lib/logos/manual-sidux-logo.png" title="Vers sidux.com, forum et wiki" alt="sidux.com logo" /></a>
	</div>
	<ul id="top-list">
		<li><a href="manual-search-fr.htm#search-on"><img src="../lib/logos/manual-search-22x22.png" title="Search Manual" alt="Search" /> Rechercher en ligne / hors ligne</a> </li>
		<li><a href="http://manual.sidux.com/meta-manual">Community Software Selections</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-lang-100x64.png" title="Choisir une autre langue - Choose another language" alt="lang-switch" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-fr.htm">Manuel du système sidux</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-fr.htm#welcome-gen">Manuel du système sidux</a></li>
				<li><a href="welcome-fr.htm#how-to">Comment utiliser ce manuel</a></li>
				<li><a href="welcome-fr.htm#table-contents">Table des matières</a></li>
				<li><a href="help-fr.htm#help-gen">Où trouver de l'aide</a></li>
				<li><a href="help-fr.htm#paste">IRC !paste</a></li>
				<li><a href="credits-fr.htm#cred-team">Mérites</a></li>
				<li><a href="wel-quickstart-fr.htm#welcome-quick">Guide rapide de sidux</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-dl-burning-fr.htm">ISO Content, Releases, Download Mirrors and Burning</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-fr.htm#cd-content">Contenu de l'ISO et système requis</a></li>
				<li><a href="sys-admin-release-fr.htm#rolling">Notes de distribution</a></li>
				<li><a href="cd-dl-burning-fr.htm#download-sidux">Miroirs de téléchargement, Télécharger et graver le fichier ISO</a></li>
				<li><a href="cd-dl-burning-fr.htm#md5">Vérification de la la somme md5</a></li>
				<li><a href="cd-dl-burning-fr.htm#burn-nero">Graver sous Windows</a></li>
				<li><a href="cd-dl-burning-fr.htm#burn-linux">Graver sous Linux</a></li>
				<li><a href="cd-no-gui-burn-fr.htm#burning-no-gui">Script burniso</a></li>
				<li><a href="cd-no-gui-burn-fr.htm#burn-no-gui-gen">Graver depuis la console</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="live-mode-fr.htm">Mode Live</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="live-mode-fr.htm#rootpw">Mot de passe root dans le mode Live</a></li>
				<li><a href="live-mode-fr.htm#live-cd-installsoft">Installer des logiciels en mode Live</a></li>
				<li><a href="live-mode-fr.htm#ntfs-3g">Écrire sur des partitions NTFS avec ntfs-3g</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="term-konsole-fr.htm">Le Terminal/Konsole</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="term-konsole-fr.htm#sux"> sux / sudo</a></li>
				<li><a href="term-konsole-fr.htm#term-kon"> Le Terminal/Konsole</a></li>
				<li><a href="term-konsole-fr.htm#cli-help">L'aide en ligne de commande</a></li>
				<li><a href="help-fr.htm#init3-tools">Outils à connaître en mode texte (tty) - init 3</a></li>
				<li><a href="term-konsole-fr.htm#term-cmds">Liste de commandes pour Terminal</a></li>
				<li><a href="term-konsole-fr.htm#shell-scripts">Scripts d'installation .sh</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="cheatcodes-fr.htm">Codes de démarrage</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="cheatcodes-fr.htm#cheatcodes">Codes de démarrage spécifiques au ISO sidux</a></li>
				<li><a href="cheatcodes-fr.htm#cheatcodes-linux">Codes de démarrage génériques Linux</a></li>
				<li><a href="cheatcodes-vga-fr.htm#vga">Codes VGA </a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="part-gparted-fr.htm">Partitionner son disque dur</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="part-gparted-fr.htm#partition">Partitionner avec GParted</a></li>
				<li><a href="part-gparted-fr.htm#ntfs">Redimensionner les partitions NTFS avec GParted</a></li>
				<li><a href="part-uuid-fr.htm#uuid">UUID, Labels de Partitions et fstab</a></li>
				<li><a href="part-cfdisk-fr.htm#disknames">Noms des disques et partitions</a></li>
				<li><a href="part-cfdisk-fr.htm#partition">Partitionner son disque dur avec cfdisk</a></li>
				<li><a href="part-cfdisk-fr.htm#formating">Formater après un partitionnement cfdisk</a></li>
				<li><a href="part-size-examp-fr.htm#part-example">Exemples de tailles de partitions</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="hd-install-fr.htm">Options d'installation</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="hd-install-fr.htm#Inst-prep">Préparer son Installation</a></li>
				<li><a href="hd-install-fr.htm#Installation">Installer sur son DDur</a></li>
				<li><a href="hd-install-fr.htm#first-hd-boot">Premier démarrage sur DDur</a></li>
				<li><a href="hd-install-opts-fr.htm#fromiso">Démarrage 'fromiso' - Overview</a></li>
				<li><a href="hd-install-opts-fr.htm#fromiso-grub-leg">Booting 'fromiso' with grub-legacy</a></li>
				<li><a href="hd-install-opts-fr.htm#grub2-fromiso">Booting 'fromiso' with Grub 2</a></li>
				<li><a href="hd-install-opts-fr.htm#fromiso-persist">fromiso et persist</a></li>
				<li><a href="hd-install-opts-fr.htm#usb-hd">Installer sur un disque USB - sidux specific - sidux-on-stick</a></li>
				<li><a href="hd-ins-opts-oos-fr.htm#raw-usb">Writing sidux to a USB/SSD stick with any Linux, MS Windows or Mac OS X system</a></li>
				<li><a href="nbdboot-fr.htm#nbd1">Booting sidux over a network</a></li>
				<li><a href="hd-install-vmopts-fr.htm#vm">Virtual Machine installation options</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-fr.htm">Cartes Graphiques, , Xorg, Matériels et pilotes</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hw-dev-hw-dri-fr.htm#hd-ntfs3g">Écrire sur des partitions NTFS avec ntfs-3g</a></li>
				<li><a href="hw-dev-mon-fr.htm#mon-res">Résolution des écrans et moniteurs</a></li>
				<li><a href="hw-dev-mon-fr.htm#xrandr">Double-écrans et xrandr</a></li>
				<li><a href="hw-dev-mon-fr.htm#mon-binary">Double-écrans (avec Binaires)</a></li>
				<li><a href="hw-dev-hw-dri-fr.htm#non-free-3d">Binaires, pilotes propriétaires pour : Nvidia &amp; xorg.conf</a></li>
				<li><a href="hw-dev-hw-dri-fr.htm#non-free-3d-2">Pilotes proprietaires (non libres) pour ATI, Radeon et autres</a></li>
				<li><a href="hw-dev-hw-dri-fr.htm#non-free-firmware">Matériels utilsant des pilotes ou firmwares non libres</a></li>
				<li><a href="hw-dev-hw-dri-fr.htm#non-free">Ajout de dépots de sources non libres à la Sources List</a></li>
				<li><a href="hw-dev-hw-dri-fr.htm#native-nv-ati">Pilotes FOSS xorg  pour nVidia, ATI, Radeon, Intel &amp; xorg.conf</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="wm-kde-fr.htm">Environnements Fenêtrés</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="wm-xfce-fr.htm#xfce-notes">Applications supplémentaires utiles pour Xfce</a></li>
				<li><a href="wm-kde-fr.htm#install-add">Applications supplémentaires utiles pour KDE</a></li>
				<li><a href="wm-kde-fr.htm#desk-freeze">Gel du bureau</a></li>
				<li><a href="wm-kde-fr.htm#kde-login">KDE ne se lance pas</a></li>
				<li><a href="wm-kde-fr.htm#ch-th">Changer de Thème</a></li>
				<li><a href="wm-kde-fr.htm#dm">Display Managers - dm</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="lamp-apache-fr.htm">Suite LAMP sidux</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="lamp-apache-fr.htm#serv-apache">Suite LAMP sidux</a></li>
				<li><a href="lamp-apache-fr.htm#serv-ftp">Clients FTP</a></li>
				<li><a href="lamp-apache-fr.htm#serv-sec">Protocoles de sécurité</a></li>
				<li><a href="lamp-apache-fr.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-fr.htm#serv-mysql">Configurer MySQL</a></li>
				<li><a href="lamp-ppp-fr.htm#serv-php">PHP dans Apache</a></li>
				<li><a href="ntp-server-fr.htm#ntp-server">Configurer le serveur de Temps</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="internet-connecting-fr.htm">Internet et Réseau</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="tor-privoxy-fr.htm#tor">Tor</a></li>
				<li><a href="tor-privoxy-fr.htm#privoxy">Privoxy</a></li>
				<li><a href="internet-connecting-fr.htm#firewalls">Firewalls</a></li>
				<li><a href="samba-fr.htm#configure">Configuration SAMBA (Windows)</a></li>
				<li><a href="samba-fr.htm#setup">Configuration de serveur Samba</a></li>
				<li><a href="ssh-fr.htm#ssh-fs">Montage SSH distant</a></li>
				<li><a href="ssh-fr.htm#ssh-x">Applications X Window via SSH</a></li>
				<li><a href="ssh-fr.htm#ssh-f">SSH en graphique avec Konqueror</a></li>
				<li><a href="ssh-fr.htm#ssh-w">Transmission-X par SSH depuis un PC Windows</a></li>
				<li><a href="ssh-fr.htm#ssh">SSH et Sécurité</a></li>
				<li><a href="internet-connecting-fr.htm#dial-mod">Modems 56k</a></li>
				<li><a href="inet-wpagui-fr.htm#wpa-roaming-gui">WiFi - WPA_GUI</a></li>
				<li><a href="inet-setup-fr.htm#net-set1">WiFi - Setting up for WiFi Roaming</a></li>
				<li><a href="internet-connecting-wpa-fr.htm#wpa">WiFi - wpasupplicant</a></li>
				<li><a href="inet-ifplug-fr.htm#hotswitch">Network switching between WiFi and Cable</a></li>
				<li><a href="internet-connecting-fr.htm#netcardconfig">Se connecter au Web - Ceni</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="sys-admin-apt-fr.htm">dist-upgrade et gestion de paquets</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="sys-admin-apt-fr.htm#apt-cook">Guide pour APT et listes de sources</a></li>
				<li><a href="sys-admin-apt-fr.htm#apt-install">Installer un nouveau paquet</a></li>
				<li><a href="sys-admin-apt-fr.htm#apt-delete">Désinstaller un paquet</a></li>
				<li><a href="sys-admin-apt-fr.htm#apt-downgrade">Rétrograder/Conserver un paquet</a></li>
				<li><a href="sys-admin-apt-fr.htm#apt-cache">Chercher un paquetage avec apt-cache</a></li>
				<li><a href="sys-admin-apt-fr.htm#gui-pacsea">Recherche de paquets en mode GUI</a></li>
				<li><a href="sys-admin-upgrade-fr.htm#live-cd-upgrade">Mettre à niveau à partir d'un Live- ISO</a></li>
				<li><a href="sys-admin-apt-locarmirr-fr.htm#approx">Mise à niveau (dist-upgrade) de multiples PC en mode LAN</a></li>
				<li><a href="sys-admin-kern-upg-fr.htm#kern-upgrade">Mise à niveau du noyau</a></li>
				<li><a href="sys-admin-kern-upg-fr.htm#dmakms">Installing kernel modules dynamically with dmakms</a></li>
				<li><a href="sys-admin-apt-fr.htm#apt-upgrade">Mettre à niveau un système installé - dist-upgrade - Vue d'ensemble</a></li>
				<li><a href="sys-admin-apt-fr.htm#du-st">Mettre à niveau un système installé -  dist-upgrade - Les étapes</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-gen-fr.htm">Administration Système</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="hd-install-fr.htm#adduser">Ajouter un nouvel utilisateur</a></li>
				<li><a href="home-fr.htm#home-bu">Déplacer /home</a></li>
				<li><a href="sys-admin-rdiff-fr.htm#rdiff">Sauvegarde avec rdiff</a></li>
				<li><a href="sys-admin-rsync-fr.htm#rsync">Sauvegarde avec rsync</a></li>
				<li><a href="vir-rkits-fr.htm#virus-rkits">Virus et Scanners de Rootkits</a></li>
				<li><a href="sys-admin-gen-fr.htm#start-services">Activer/désactiver les services</a></li>
				<li><a href="sys-admin-gen-fr.htm#pw-lost">Perte du mot de passe root</a></li>
				<li><a href="sys-admin-gen-fr.htm#fonts">Polices</a></li>
				<li><a href="sys-admin-gen-fr.htm#cups">CUPS -imprimantes</a></li>
				<li><a href="sys-admin-gen-fr.htm#sound">Sound Mixers</a></li>
				<li><a href="sys-admin-gen-fr.htm#init">Niveaux de fonctionnement sidux-init</a></li>
				<li><a href="bios-freedos-fr.htm#bois-prep">Mise à jour du BIOS avec FreeDOS</a></li>
				<li><a href="sys-admin-grub-bootman2-fr.htm#boot-grub-floppy">Créer une disquette de démarrage</a></li>
				<li><a href="sys-admin-grub-bootman2-fr.htm#mbr-grub-boot">Grub1 - Effacement du secteur de boot MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-fr.htm#dual-boot">Grub1 - Double et multi-démarrage</a></li>
				<li><a href="sys-admin-grub-bootman2-fr.htm#remove-grub">Enlever grub du MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-fr.htm#what-is-grub">Grub, le gestionnaire de démarrage</a></li>
				<li><a href="sys-admin-grub2-fr.htm#mbr-over-grub2">Grub2 - MBR Overwritten</a></li>
				<li><a href="sys-admin-grub2-fr.htm#multi-os">Grub2 - Dual and Multibooting</a></li>
				<li><a href="sys-admin-grub2-fr.htm#grub1-grub2">Grub2 -Upgrading from Grub1</a></li>
				<li><a href="sys-admin-grub2-fr.htm#grub2">Grub2 - Overview</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --></div>
<div id="main-page">
		<div class="divider" id="vmopts">
				<h2 id="top-header">Virtual Machine options</h2>

						<ul>
							<li><a href="hd-install-vmopts-fr.htm#kvm">KVM for Intel VT or AMD-V</a></li>
							<li><a href="hd-install-vmopts-fr.htm#vbox">Virtualbox</a></li>
							<li><a href="hd-install-vmopts-fr.htm#qemu">QEMU</a></li>

						</ul>
		      </div>
		      <div class="divider" id="kvm">
				<h2>Booting and installing sidux to a KVM Virtual Machine</h2>
							<p>KVM is a full virtualisation solution for Linux on x86 hardware containing virtualisation extensions (Intel VT or AMD-V).</p>

				      <h3>Prerequisites</h3>

							<p>To ascertain whether your hardware supports KVM, ensure that KVM is enabled in the BIOS (in some cases on an Intel VT or AMD-V system it may not evident as to where the switch is, therefore assume that it is in a KVM state). The way to check is in a console run:</p>
<pre>
cat /proc/cpuinfo | egrep --color=always 'vmx|smx'
</pre>
							<p>If you see <span class="highlight-3">smx</span> or <span class="highlight-3">vmx</span> in the cpu flags field, your system supports KVM. (Otherwise go back to the BIOS if you believe it is supported and check again, else search the internet as to where in the BIOS menus KVM 'enable' could be hiding).</p>

							<p>Should your BIOS not support KVM refer to <a href="hd-install-vmopts-fr.htm#vbox">Virtualbox</a>
							 or <a href="hd-install-vmopts-fr.htm#qemu">QEMU</a></p>

							<p>To install and run KVM, firstly ensure that Virtualbox modules are not loaded, (--purge them is the best option), then depending on your chipset:</p>

							<p>For <span class="highlight-3">vmx</span>:</p>
<pre>
apt-get install qemu-kvm
modprobe kvm_intel
</pre>
							<p>For <span class="highlight-3">smx</span>:</p>
<pre>
apt-get install qemu-kvm
modprobe kvm_amd
</pre>
							 <p>Another option is reboot as the qemu-kvm initscripts will take care of loading the modules.</p>

					  <h4>Using KVM to boot a sidux-*.iso</h4>

							<p><span class="highlight-2">As user:</span></p>
<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -cdrom &lt;sidux.iso&gt;
</pre>

				<h5>Installing a sidux-*.iso to a KVM image</h5>
							<p>First create a hard disk image, (this image will be minimal and only grow as required due to qcow2 compression ratios):</p>
<pre>
$ qemu-img create -f qcow2 sidux-2010-*-.img 12G
</pre>

							<p>Boot the sidux-*.iso with the following parameters to enable KVM to recognise that there is an QEMU hard disk image available:</p>
<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -cdrom &lt;/path/to/sidux.iso&gt; -boot d &lt;/path/to/sidux-20xx-*-.img&gt;
</pre>

							<p>Once the cdrom has booted up click on the sidux installer icon to activate the installer, (or use the menu), click on the Partitioning tab and you should see on the left hand side a box that has a disk ready for partitioning and formatting, most likely noted as <span class="highlight-3"> /dev/sda</span>. Underneath that are the options for partitioning, choose gparted.</p>

	<div class="screenshot"><img src="../lib/images-common/images-vm/kvm-gparted02.png" title="gparted kvm hard disk naming" alt="gparted kvm hard disk naming" /></div>
	<div class="spacer02"></div>

							<p>In the Gparted menu you can confirm that Gparted sees the image with <span class="highlight-3">View>Device Information</span> which should state it is a <span class="highlight-3">ATA QEMU Harddisk</span> and most likely noted as <span class="highlight-3"> /dev/sda</span>,(in this example), as this will be crucial when moving back to the installer and choosing where to put Grub, as it needs to go to <span class="highlight-3"> /dev/sda</span>.</p>

							<p>Next, in the <span class="highlight-3">Partition</span> menu choose <span class="highlight-3"> Device>Create Partiton Table</span> and create the partition table. </p>

							<p>Then format the partition table with ext4 and also include a swap of 2 gig. The formatting will take time so be patient.</p>

							<p>After formatting has completed, click OK to be returned to the installer and proceed as if you are performing a standard install, (again, be patient). <span class="highlight-2">Note: Install the Grub to /dev/sda</span>.</p>

							<p>You now have a sidux-*-VM ready for use:</p>

<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -drive if=virtio,boot=on,file=&lt;absolute/path/to/sidux-20xx-*.img&gt;
</pre>

							<p>If the guest does not support virtio, or you do not specify an absolute path,  use:</p>
<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -hda &lt;/path/to/sidux-20xx-*.img&gt;
</pre>
							<p>See also:</p>
<pre>
$ man kvm
</pre>
				<h5>Managing your KVM virtual machine installations</h5>
<pre>
apt-get install aqemu
</pre>
							<p>When using AQEMU ensure that you choose the KVM mode from the drop down box for 'Emulator Type' in the 'General' tab. (Documentation for AQEMU is basically non existent, therefore a few 'trials by error' will be required to figure out the easy to use GUI, however a good start is to use first use the 'VM' menu followed by the 'General' tab.</p>

	</div>
	<div class="divider" id="vbox">
		<h2>Booting and installing sidux to a VirtualBox Virtual Machine</h2>
							<p>Les étapes :</p>
						<ul>
 							<li>1. Créez une image disque pour Virtualbox.</li>
 							<li>2. Démarrez l'iso avec Virtualbox</li>
 							<li>3. installez sidux sur votre image disque</li>
						</ul>

				<h4>Configuration minimale requise</h4>
							<p><span class="highlight-3">1 Go de RAM recommandés</span>: dans l'idéal, 512 Mo pour le système hébergé, 512 Mo pour l'hôte. (ça peut tourner avec moins de ram, mais n'attendez pas une grande performance à ce moment là...).</p>

							<p><span class="highlight-3">Espace disque:</span> VirtualBox en soi a beau être léger (une installation de base occupe autour de 30 Mo d'espace disque), les machines émulées elles, nécessitent pour fonctionner de disposer d'un espace disque plutôt conséquent, afin de suffire à héberger leurs propres espaces disques de stockage. Dans ces conditions, pour installer Windows XP&reg;, par exemple, vous aure besoin d'un espace suceptible de s'étendre sur un bon nombre de Gigas...Pour utiliser sidux sous virtualbox vous devrez allouer une taille image de 5 GB en plus du swap.</p>

				<h3>Installation:</h3>

<pre>
apt-get update
apt-get install virtualbox-ose-qt virtualbox-ose-source dmakms module-assistant
</pre>
							<p>Then prepare the module:</p>
<pre>
m-a prepare
m-a a-i virtualbox-ose-source
</pre>
							<p>Then activate Dynamic Module-Assistant Kernel Module Support for virtualbox, so that the next time the Linux kernel is updated a virtualbox module is prepared for it too, without manual intervention. To do that, add <span class="highlight-3">virtualbox-ose-source</span> to the <span class="highlight-3">/etc/default/dmakms </span>configuration file. </p>
<pre>
mcedit /etc/default/dmakms
virtualbox-ose-source
</pre>

							<p>Then reboot the computer.</p>

							<p><a href="sys-admin-kern-upg-fr.htm#dmakms">This is essential reading on dmakms</a></p>

					<h3>Installer sidux sur la machine virtuelle</h3>


							<p>Utilisez l'assistant de VirtualBox pour créer une nouvelle machine virtuelle pour sidux. Suivez ensuite les instructions données pour une installation standard de sidux.</p>


							<p><a href="http://www.virtualbox.org/">Le site de VirtualBox fournit une documentation accessible, notamment une aide en PDF, que vous pourrez télécharger.</a> </p>

	</div>
	<div class="divider" id="qemu">
		<h2>Booting and installing sidux to a QEMU Virtual Machine</h2>

							<p>Les étapes:</p>

						<ul>
 							<li>1. créer une image disque pour qemu</li>
 							<li>2. démarrer l'iso avec qemu</li>
 							<li>3. installer sur l'image disque</li>
						</ul>

							<p>A QT GUI tool is available to help you configure QEMU:</p>
<pre>
apt-get install qtemu
</pre>

 				<h4>Créer une image-disque</h4>

							<p>Pour utiliser qemu vous aurez probablement besoin d'une image disque (image de disque dur). Il s'agit d'un simple fichier qui stocke le contenu d'un disque dur virtuel (émulé).</p>

							<p>Utilisez cette commande:</p>
<pre>
qemu-img create -f qcow sidux.qcow 3G
</pre>
							<p>Elle créera un fichier image appelé "sidux.qcow". Le paramètre "3G" spécifie sa taille, qui est de 3 Go. Vous pouvez également utiliser le paramètre M pour les mégaoctets (par exemple "800M". Vous n'avez pas trop à vous inquiéter de la taille du disque, car le format qcow compresse l'image de sorte qu'elle n'occupe pas plus d'espace que ce qui est effectivement occupé par les données une fois compressées.</p>


			<h4>Installer le système d'exploitation</h4>

							<p>C'est la première fois que vous allez devoir démarrer l'émulateur. <span class="highlight-3">Une bonne chose à savoir : quand vous cliquez dans la fenêtre de qemu, il capture le pointeur de la souris. Pour le libérer vous n'avez qu'à presser sur votre clavier la combinaison :</span></p>
<pre>
Ctrl+Alt
</pre>

							<p>Si vous avez besoin d'utiliser une disquette de démarrage, alors lancez qemu avec :</p>
<pre>
qemu -floppy sidux.iso -net nic -net user -m 512 -boot d sidux.qcow
</pre>
							<p>Pour lancer un cd bootable:</p>
<pre>
qemu -cdrom sidux.iso -net nic -net user -m 512 -boot d sidux.qcow
</pre>
							<p>Vous pouvez alors installer sidux comme s'il s'agissait d'un disque du réel</p>


			<h4>Utiliser le système</h4>

							<p>Pour utiliser le système après l'installation, faites simplement:</p>
<pre>
qemu [votre_image_disque]
</pre>
							<p>Une bonne idée est d'utiliser les images par recouvrement (overlay images). De cette façon vous créez une première image et Qemu va stocker ses modifications dans un fichier séparé ; de cette manière il sera aisé de revenir à une version antérieure du système et de prévenir toute instabilité potentielle.</p>

							<p>Pour créer une image de recouvrement (overlay image), entrez :</p>
<pre>
qemu-img create -b [[base''image]] -f qcow [[overlay''image]]
</pre>
							<p>Remplacez l'image de recouvrement à votre image_de_base (dans notre cas sidux.qcow). Après quoi vous pouvez lancer qemu avec:</p>
<pre>
qemu [image_de_recouvrement]
</pre>
							<p>L'image de base ne sera pas modifiée. Une limitation cependant : l'image de base ne doit pas être déplacée ou renommée, l'image de recouvrement gardant son chemin absolu en mémoire.</p>


				<h4>Utiliser une partition réelle quelconque en tant que partition primaire unique d'une image disque</h4>

							<p>Il peut arriver que vous vouliez utiliser une de vos partitions système dans qemu (par exemple, pour démarrer en même temps votre système réel ou qemu utilisant une partition spécifique comme racine). Vous pouvez y parvenir en utilisant le RAID logiciel en mode linéaire (il vous faudra le pilote de noyau linear.ko) ainsi qu'un périphérique loopback : l'astuce consiste à ajouter un master boot record (MBR) à la fin de la partition que vous souhaitez intégrer à une image disque qemu brute.</p>

							<p>Supposons que vous disposez d'une partition non montée /dev/sdaN dont vous voudriez faire du système de fichiers une partie de votre image disque qemu. Vous commencerez par créer un petit fichier pour stocker le MBR:</p>
<pre>
dd if=/dev/zero of=/path/to/mbr count=32
</pre>
							<p>Là un fichier de 16 Ko (32 * 512 bytes) est créé. Il est important de ne pas le créer trop petit, même si un MBR ne requiert qu'un unique bloc de 512 octets, car plus petit il sera, plus le hachage du raid logiciel devra être étroit, ce qui impacte sur les performances. Puis, vous attachez un périphérique loopback au fichier MBR:</p>
<pre>
losetup -f /chemin/du/mbr
</pre>
							<p>Admettons qu'au résultat le périphérique obtenu soit /dev/loop0, car nous n'utiliserions jusque là aucun autre loopback. L'étape suivante passe par la création de l'image disque "mélangée" MBR + /dev/sdaN en utilisant le RAID logiciel:</p>
<pre>
 modprobe linear
 mdadm --build --verbose /dev/md0 --chunk=16 --level=linear --raid-devices=2 /dev/loop0 /dev/sdaN
</pre>
							<p>Le résultat /dev/md0 est ce que vous allez utiliser comme disque image qemu (n'oubliez pas de fixer les permissions de sorte que l'émulateur puisse y avoir accès). La dernière (et peut-être la plus perverse) des étapes consiste à régler la configuration du disque (géométrie et table des partitions) de telle sorte que le point d'origine du MBR coincide avec celui de /dev/md0 (un offset d'exactement 16*512 = 16384 octets dans cet exemple). Réalisez cette étape en utilisant fdisk sur la machine hôte, et non depuis l'émulateur : la routine de détection brute des disques utilisée par qemu produit en effet souvent des offset non-arrondis au kilooctet (de type 31.5 KB, comme dans la section précédente) et qui ne seraient pas gérables par le RAID logiciel. Ainsi, depuis la machine hôte: </p>
<pre>
 fdisk /dev/md0
</pre>
							<p>Créez ensuite une partition primaire unique correspondant à /dev/sdaN, et utilisez la commande 's'ector du menu expert, de telle sorte que le premier cylindre (où cette première partition est censée démarrer) coïncide avec la taille du MBR. Quand finalement vous activez la fonction 'w' pour sauver votre réglage dans un fichier, l'opération est terminée. Vous disposez d'une partition que vous pouvez monter directement depuis votre machine hôte, et qui fait également partie d'une image disque qemu :</p>
<pre>
 qemu -hdc /dev/md0 [...]
</pre>
							<p>Évidemment vous pouvez sans problème configurer un chargeur de démarrage sur votre image disque en utilisant qemu, du moment que le répertoire /sdaN/boot de la partition originale est équipée des outils nécessaires.</p>

			<h4>Activer le module d'accélaration de QEMU</h4>

							<p>Les développeurs de qemu ont créé un module de noyau optionnel accélérant qemu jusqu'à des vitesses proches de celles d'une machine réelle. Ce module se charge avec cette option :</p>
<pre>
major=0
</pre>
							<p>Pour automatiser la création du périphérique /dev/kqemu, utilisez cette commande :</p>
<pre>
echo "options kqemu major=0" &gt;&gt; /etc/modprobe.conf
</pre>
							<p>Ceci empêchera modprobe.conf de vérifier systématiquement que l'option de module soit ajoutée à chaque lancement de celui-ci.</p>

<pre>
qemu [...] -kernel-kqemu
</pre>
							<p>Cette syntaxe active la virtualisation complète et de fait améliore considérablement la rapidité de fonctionnement de l'émulateur.</p>

				<h4>Pour activer qemu:</h4>
<pre>
qemu -cdrom /tmp/pkg/sidux-debug.iso -net nic -net user -m 512
</pre>
							<p><a href="http://www.nongnu.org/qemu/user-doc.html">La documentation officielle du projet QEMU </a> </p>

							<p><a href="http://wiki.archlinux.org/index.php/Qemu">Certains contenus se rapportant à QEMU pour le Manuel de sidux sont extraits de documents extérieurs sous licence GNU Free Documentation License 1.2 et ont été adaptés pour le Manuel de sidux.</a> </p>


	</div>
	<div id="rev">Page last revised 13/04/2010 1450 UTC</div>

</div>
</body>
</html>
