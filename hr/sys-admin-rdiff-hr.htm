<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>sidux Priručnik - rdiff</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body id="welcome">
<div id="menu"> <!-- menu starts here hr lang maintainer cobra-->
<!--Welcome to the Official sidux-manual  01.18-2007-07-08 -->
<!-- menu last updated by bluewater 08/07/2007 1300rs AEST 02/07/2007 0300hrs UTC -->
<img src="../lib/logos/sidux-logo.png" alt="logo" id="menu-header" />
	<ul id="top-list">
		<li><a href="http://sidux.com/">To sidux.com</a></li>
		<li><a href="http://manual.sidux.com/meta-manual">sidux Meta-Manual</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-lang-50.png" title="Izaberite drugi jezik" alt="lang-switch" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-hr.htm">sidux OS Priručnik</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-hr.htm#welcome-gen">sidux OS Priručnik</a></li>
				<li><a href="welcome-hr.htm#how-to">Kako koristiti ovaj priručnik</a></li>
				<li><a href="welcome-hr.htm#table-contents">Indeks</a></li>
				<li><a href="help-hr.htm#help-gen">Gdje možete dobiti pomoć</a></li>
				<li><a href="credits-hr.htm#cred-team">Zahvale</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-content-hr.htm">CD sadržaj</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-hr.htm#cd-content">CD sadržaj</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="cd-dl-burning-hr.htm">CD download i prženje</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="cd-dl-burning-hr.htm#download-sidux">CD download i prženje</a></li>
			<li><a href="cd-dl-burning-hr.htm#md5">md5 zbroj za provjeru</a></li>
				<li><a href="cd-dl-burning-hr.htm#burn-nero">Prženje s Windows</a></li>
				<li><a href="cd-dl-burning-hr.htm#burn-linux">Prženje s Linux</a></li>
				<li><a href="cd-dl-burning-hr.htm#xdelta">xdelta Patching</a></li>
				<li><a href="cd-no-gui-burn-hr.htm">Prženje bez GUI-a</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="live-mode-hr.htm">Live Modus</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="live-mode-hr.htm#rootpw">Root-lozinka na sidux-Live-CD?</a></li>
				<li><a href="live-mode-hr.htm#live-cd-installsoft">Instalirati softver kad ste na Live-CD</a></li>
				<li><a href="live-mode-hr.htm#ntfs-3g">Piši na NTFS-particiju sa NTFS-3g</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="term-konsole-hr.htm">Terminal/Konzola</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="term-konsole-hr.htm#term-kon">Terminal/Konzola</a></li>
				<li><a href="term-konsole-hr.htm#cli-help">Pomoć za naredbenu crtu</a></li>
				<li><a href="term-konsole-hr.htm#term-cmds">Lista naredbih za Linux Terminal</a></li>
				<li><a href="term-konsole-hr.htm#shell-scripts">Instalirati Scripts.sh</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="cheatcodes-hr.htm">Cheatcodes</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="cheatcodes-hr.htm#cheatcodes">Cheatcodes</a></li>
				<li><a href="cheatcodes-vga-hr.htm#vga">VGA Codes</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="part-gparted-hr.htm">Particijonirati vaš Hard-Disk</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="part-gparted-hr.htm#partition">Particijonirati vaš HD koristeći GParted</a></li>
				<li><a href="part-gparted-hr.htm#ntfs">Mijenjanje veličine NTFS particija koristeći GParted</a></li>
				<li><a href="part-uuid-hr.htm#uuid">UUID, označivanje particija i fstab</a></li>
				<li><a href="part-cfdisk-hr.htm#partition">Particijonirati vaš HD koristeći cfdisk</a></li>
				<li><a href="part-cfdisk-hr.htm#formating">Formatiranje particija poslije particijoniranjem sa cfdisk</a></li>
				<li><a href="part-size-examp-hr.htm#part-example">Primjeri particijskih veličina</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hd-install-hr.htm">Instalacijske opcije</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hd-install-hr.htm#Inst-prep">Priprema za instaliranje</a></li>
				<li><a href="hd-install-hr.htm#Installation">Instaliranje na vaš HD</a></li>
				<li><a href="hd-install-hr.htm#first-hd-boot">Prvi Boot-Up</a></li>
				<li><a href="hd-install-opts-hr.htm#fromiso">Boot sa 'fromiso'</a></li>
				<li><a href="hd-install-opts-hr.htm#usb-hd">Instaliranje na USB-HD</a></li>
				<li><a href="hd-install-opts-hr.htm#qemu">Instaliranje uz pomoć QEMU</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-hr.htm">Grafičke kartice, hardver, sredstvo i pogonitelji</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="hw-dev-hw-dri-hr.htm#hd-ntfs3g">Piši na NTFS</a></li>
				<li><a href="hw-dev-hw-dri-hr.htm#mon-res">Rezolucije monitora</a></li>
				<li><a href="hw-dev-hw-dri-hr.htm#non-free-3d">Binarni, non-free pogonitelji za: Nvidia / ATI</a></li>
				<li><a href="hw-dev-hw-dri-hr.htm#native-nv-ati">Free xorg pogonitelji za nVidia, ATI, Radeon, Intel</a></li>
				<li><a href="hw-dev-hw-dri-hr.htm#non-free">Hardver sa non-free potrebama</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="wm-kde-hr.htm">Window-Menadžer<br /></a>
			<ul class="sub-menu" id="sm10">
				<li><a href="wm-kde-hr.htm#desk-freeze">KDE Desktop je smrznut</a></li>
				<li><a href="wm-kde-hr.htm#kde-login">Ne mogu se prijaviti u KDE</a></li>
				<li><a href="wm-kde-hr.htm#ch-th">Promjeni temu</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="lamp-apache-hr.htm">sidux LAMP Stack</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="lamp-apache-hr.htm#serv-apache">sidux LAMP Stack</a></li>
				<li><a href="lamp-apache-hr.htm#serv-ftp">FTP klijenti</a></li>
				<li><a href="lamp-apache-hr.htm#serv-sec">Sigurnosne protokole</a></li>
				<li><a href="lamp-apache-hr.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-hr.htm#serv-mysql">MySQL Postavke</a></li>
				<li><a href="lamp-ppp-hr.htm#serv-php">PHP u Apache</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="internet-connecting-hr.htm">Internet i umrežavanje</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="ntp-server-hr.htm#ntp-server">Postavke Time-poslužitelja</a></li>
				<li><a href="tor-privoxy-hr.htm#tor">Tor</a></li>
				<li><a href="tor-privoxy-hr.htm#privoxy">Privoxy</a></li>
				<li><a href="internet-connecting-hr.htm#firewalls">Firewalls</a></li>
				<li><a href="samba-hr.htm#configure">sidux SAMBA konfiguracija (Windows)</a></li>
				<li><a href="samba-hr.htm#setup">Postavke Samba-poslužitelja</a></li>
				<li><a href="ssh-hr.htm#ssh-fs">SSH Remote Mounting</a></li>
				<li><a href="ssh-hr.htm#ssh-x">X-Window aplikacije via SSH</a></li>
				<li><a href="ssh-hr.htm#ssh-f">GUI SSH sa Konqueror</a></li>
				<li><a href="ssh-hr.htm#ssh-w">SSH X-Forwarding sa Windows-PC</a></li>
				<li><a href="ssh-hr.htm#ssh-s">SSH Sigurnost</a></li>
				<li><a href="internet-connecting-hr.htm#dial-mod">56k modemi</a></li>
				<li><a href="internet-connecting-hr.htm#ndiswrapper">Aktiviranje Ndiswrapper-a</a></li>
				<li><a href="internet-connecting-wpa-hr.htm#wpa">WIFI-WLAN</a></li>
				<li><a href="internet-connecting-hr.htm#internetsharing">Dijeljenje Interneta</a></li>
				<li><a href="internet-connecting-hr.htm#netcardconfig">Ulaz u Internet</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-apt-hr.htm">Instaliranje/Brisanje Downgrading jednog paketa</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="sys-admin-apt-hr.htm#apt-cook">APT-Guide i sources.list</a></li>
				<li><a href="sys-admin-meta-hr.htm#meta-pack">Instaliranje Meta-Paketa</a></li>
				<li><a href="sys-admin-meta-hr.htm#meta-proxy">Meta-Installer i Proxies</a></li>
				<li><a href="sys-admin-apt-hr.htm#apt-install">Instaliranje novih paketa</a></li>
				<li><a href="sys-admin-apt-hr.htm#apt-delete">Brisanje paketa</a></li>
				<li><a href="sys-admin-apt-hr.htm#apt-downgrade">Downgrading jednog paketa</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 14 );" onmouseout="startTime();" ><a href="sys-admin-apt-hr.htm">Sistem administracija</a>
			<ul class="sub-menu" id="sm14">
				<li><a href="sm-siduxcc-hr.htm#sm">sm Syntax Command Sets</a></li>
				<li><a href="sm-siduxcc-hr.htm#siduxcc">siduxcc</a></li>
				<li><a href="sys-admin-apt-hr.htm#apt-upgrade">Upgrade instaliranog sistema</a></li>
				<li><a href="sys-admin-upgrade-hr.htm#live-cd-upgrade">Upgrade koristeći Live-CD</a></li>
				<li><a href="sys-admin-kern-upg-hr.htm#kern-upgrade">Upgrade kernela</a></li>
				<li><a href="sys-admin-rdiff-hr.htm#rdiff">Sigurnosne kopije sa rdiff</a></li>
				<li><a href="sys-admin-rsync-hr.htm#rsync">Sigurnosne kopije sa rsync</a></li>
				<li><a href="vir-rkits-hr.htm#virus-rkits">Virus i Rootkit skeneri</a></li>
				<li><a href="sys-admin-gen-hr.htm#start-services">Aktiviranje servisa u sidux</a></li>
				<li><a href="sys-admin-gen-hr.htm#pw-lost">Izgubljena root lozinka</a></li>
				<li><a href="sys-admin-gen-hr.htm#fonts">Pisma u sidux</a></li>
				<li><a href="sys-admin-gen-hr.htm#cups">CUPS</a></li>
				<li><a href="sys-admin-grub-bootman2-hr.htm#mbr-grub-boot">Prepisati MBR bootsector</a></li>
				<li><a href="sys-admin-grub-bootman2-hr.htm#dual-boot">Dual i Multiple Booting</a></li>
				<li><a href="sys-admin-grub-bootman2-hr.htm#boot-grub-floppy">Izraditi Boot-Floppy</a></li>
				<li><a href="sys-admin-grub-bootman2-hr.htm#remove-grub">Brisanje grub-a sa MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-hr.htm#what-is-grub">Boot-Menadžer Grub</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
	<div class="divider" id="rdiff">
			<h2>Sigurnosne Kopije sistema sa rdiff-backup</h2>
				<p>rdiff-backup ja alat koji je korišten da osigura vaše datoteke. (Možete ga izvoditi na raznim *nix portacijama).<br /> Predivna situacija sa sidux ja da možete izabrati kako da inicirate proces, "Do it yourself", ili sa skriptom.</p>

				<h3><a href="http://techpatterns.com/forums/about831.html">To je skript verzija od h2</a></h3>
	<div class="spacer02"></div>

			<h5>Što će biti sljedeće je "Do it yourself" verzija</h5>

			<h6>rdiff-backup</h6>

				<p class="highlight-2">Izvodite sve naredbe kao root na konzoli, dok god ne čujete drugo</p>

				<p>*vrlo dobro da vratite sistem na staro stanje prije pokvarenog dist-upgrade, kernel upgrade etc (i isto za vračanje individualnih datoteka).<br /> *samo osigura podatke koje su se promijenili, isto kao rsync (tako da svaka sigurnosna kopija ne traje dugo).<br /> *stvori historiju promjena (što znači da možete restaurirati datoteku koju ste izbrisali prije 3 tjedna!)<br /> *obavlja sigurne sigurnosne kopije preko mreže (koristeći ssh).<br /> *osigura particije dok su mountane (tako da je lagano da automatizirate dnevne sigurnosne kopije ....unmountanje nije više potrebno).<br /> *može da restaurira sve podatke ako vaš HD ode kvragu, i morate kupiti novi.<br /> *skalirane sigurnosne kopije na velikim mrežama (bez problema sa linux mrežama, Windows mreže su više komplicirane) i korišten od velikog biznisa.<br /> *je aplikacija za naredbenu crtu, tako je vrlo dobra za ljude koje hoće da automatiziraju sigurnosne kopije na snažan način (kao bash skript koji je izvođen od cron).<br /> *zapamti i radi s vlasničkim strukturama i pravima za datoteke, i isto tako radi sa simboličnim linkima (i sa svim vrstama tih stvari) tako kad restaurirate, dobijete podatke egzaktno gdje su bile.</p>

			<h6>Što će vam trebati</h6>
				<p>rdiff-backup osigura kompletne kopije (ne komprimirane) datoteka koje hoćete da osigurate, i isto tako stvori historiju (inkrementalne sigurnosne kopije), tako da mjesto na kojemu su sigurnosne kopije, mora biti veće nego izvorne podatke. Ako osigurate 100 GB, morate imati 120 GB mjesta (preporučujemo separatnu HD!).</p>

			<h6>Kako da postavite</h6>
				<p>Recimo da vaš PC ima sljedeće:<br /> * 100 GB HD (hda) koja je u korištaju, mountana na hda1 i korištena za root particiju, i hda5 korištena za  muziku i druge datoteke, i hda6 za swap.<br /> * 200 GB HD (hdb) koja nije korištena, sa jednim mount hdb1 ... to će mo koristiti za naše sigurnosne kopije.<br /> * IP adresa 192.168.0.1</p>

				<p>Kao prvo moramo instalirati rdiff-backup:</p>
<pre>
# apt-get install rdiff-backup
</pre>
				<p>Iako sad možete da osigurate svaki direktorij, pretpostavka je da osigurate cijele particije ... mi hoćemo da sigurnosno kopiramo hda1 i hda5 (nećemo da sigurnosno kopiramo hda6), i tako da postavimo direktorije koje trebaju da sadrže podatke:</p>
<pre>
# mkdir /media/hdb1/rdiff-backups/192.168.0.1/root
# mkdir /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>Treba vam IP adresa, zato što želite da koristite to računalo da sigurnosno kopira na drugo računalo (to je tema malo kasnije).</p>

			<h6>Sigurnosno kopiranje</h6>

				<p>rdiff-backup koristi syntax <span class="highlight-3">rdiff-backup izvor-dir cilj-dir</span>. Zapamtite: uvijek specificirate imena direktorija, ne imena datoteka.</p>

				<p>Da sigurnosno kopirate hda5, izvodite:</p>
<pre>
# rdiff-backup /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>Da sigurnosno kopirate root particiju, izvodite:</p>
<pre>
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/hdb1/rdiff-backups/192.168.0.1/root
</pre>
				<p>Svi "AF_UNIX path too long" pogreške možete ignorirati. Prvi put kad sigurnosno kopirate, malo će potrajati, zato što rdiff-backup mora da sigurnosno kopira cijelu particiju (ne samo razlike). Zapamtite da nećemo da osiguramo /tmp, zato što se stalno mijenja, niti /proc ili /sys  zato što sadrže prave datoteke, i isto tako nećemo da osiguramo mounts. Ako sigurnosno kopirate mounts, mogli bi završiti sa sigurnosnom kopijom hdb1 u beskonačnoj petlji! Jedan put da to obavite, bez problema, je da separatno osigurate mounts.</p>

				<p>Razlog zašto postavite '/proc/*' umjesto '/proc' je, da će samo osigurati ime direktorija /proc, ali će ignorirati sve što je unutra. Isto za /tmp, /sys, i sva mount point imena.</p>

				 <p>Na taj način, ako potamanite vašu root particiju i izvodite full restauraciju, /tmp, /proc, /sys i mount points imena će biti kreirani (kao i što trebaju). Ako /tmp ne egzistira kad X startuje, moglo bi biti problema). Pogledajte u man page za dalje informacije o --exclude i --include).</p>

			<h6>Restauracije direktorija iz sigurnosnih kopija</h6>

				<p>rdiff-backup koristi syntax:</p>
<pre>
rdiff-backup -r &lt;od-kada&gt; &lt;izvor-dir&gt; &lt;cilj-dir&gt;
</pre>
				<p>Sad ako slučajno izbrišete /media/hda7/photos, možete ga restaurirati sa:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5/photos /media/hda5/photos
</pre>
				<p>"-r now" opcija znači restauraciju iz zadnje sigurnosne kopije 
				Ako periodično sve (na primjer sa crontab) osigurate, i niste realizirali da photos direktorij fali, poslije nekoliko dana, potrebno će biti da restaurirate iz sigurnosne kopije prije nekoliko dana (i ne "sada", zato što u zadnjoj sigurnosnoj kopiji photos direktorij ne egzistira) 
				Ili je vam možda potrebno prijašnja verzija nečega</p>

				<p> Ako hoćete da restaurirate datoteke od prije 3 dana, onda koristite "-r 3D" ... ali, kao što man page kaže:</p>

				<p class="highlight-1">"3D" odnosi se na 72 sati prije sadašnjosti, i ako tu niste obavili sigurnosnu kopiju u to vrijeme, rdiff-backup će restaurirati stanje prijašnje sigurnosne kopije. Na primjer, u gornjem slučaju, ako koristite "3D", i postoje samo sigurnosne kopije prije 2 i prije 4 dana, direktorij će biti restaurirano na stanje  prije 4 dana (tako da morate dobro pomisliti prije restauracije).</p>

				<p>Koristeći sljedeće će listati datum i vrijeme kad ste obavljali sigurnosne kopije za hda5:</p>
<pre>
# rdiff-backup -l /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
			<h5>Restauracija particija</h5>

				<p>Možete isto restaurirati cijele particije (mounts), i, mount point je isto samo direktorij.</p>

				<p class="highlight-2">UPOZORENJE: Nikad nemojte restaurirati root particiju dok je startana s sistemom! Sa jednom naredbom izgubiti će te sve datoteke na svim particijama, uključujući sve sigurnosne kopije na separatnoj HD!! rdiff-backup radi točno što mu naredite ... ako sigurnosna kopija root particije ima prazne mount points, na bazi toga restaurira kao što je sigurnosna kopija, i tako sve izbriše u mount points, da restaurira podatke kao što su u sigurnosnoj kopiji.</p>

				<p>Da restaurirate hda5 iz zadnje sigurnosne kopije, jednostavno izvodite:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5 /media/hda5
</pre>
			<h5>Restauracija root particije</h5>

				<p>Ali restauracija root particije, nije baš lagana. Ne restaurirajte root particiju dok je mountana (vidite gornje upozorenje). Vrlo je korisno da imate mogućnost da restaurirate root particiju, ako zbrkate stvari sa instaliranjem/upgrade, ili zbrke sa novim kernel (itd), uvijek imajte u glavi da možete sve vratiti kako je bilo i to samo za 20 minuta.</p>

				<p>Jedan put da restaurirate root particiju je da bootate na praznu linux particiju, ako imate jednu na hard disku. I sa time vam je moguće da restaurirate root particiju, zato što nije mountana kao root. Poslije restauracije, bootate je, i biti će ista kao kad ste je sigurnosno kopirali... egzaktno! To je dosad naj lakša metoda.</p>

				<p>Drugi način da restaurirate root particiju je da bootate sidux-Live-CD i obavite restauraciju s njom. rdiff-backup je sadržan u sidux. U slučaju da na sidux Live-CD verziji nije sadržan rdiff, upišite u grub (bootopcije, (cheatcodes)) cheatcode "unionfs" to znaći da možete instalirati aplikacije. Samo bootate i izvedite sljedeće naredbe:</p>
<pre>
$ sudo su
# wget -O /etc/apt/sources.list http://sidux.com/files/misc/sources.list
# apt-get update
# apt-get install rdiff-backup
</pre>
				<h6>Sad da obavimo restauraciju:</h6>
<pre>
# mount /dev/hda1 /media/hda1
# mount /dev/hdb1 /media/hdb1
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>Bilješka: Ako nemate sidux CD i vaša Live-CD je podržana od klik možete instalirati rdiff-backup koristeći Klik:</p>
<pre>
$ sudo ~/.zAppRun ~/Desktop/rdiff-backup_0.13.4-5.cmg rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>Preporučeno je, da ko god obavlja sigurnosne kopije root particije (sa namjerom da će je nekada restaurirati) trebao bi da testira proces restauracije. Nista gore nego da mislite da će sve biti u redu, i onda se desi nenadan događaj.</p>

			<h5>Sigurnosne kopije drugih računala</h5>

				<p>Možete sigurnosno kopirati druga računala na lokalni, do god se lokalni može da spoji preko ssh s drugim računalima (i dok god još imate mjesta na hard disku). ssh poslužitelj (sshd) mora da radi na udaljenom računalu. Druga računala ne moraju biti u vašoj lokalnoj mreži, mogu da budu na cijelom svijetu.</p>

				<p>Pretpostavljamo da udaljeno računalo ima sljedeće:<br /> 1) 100 GB HD (hda), sa samim mounts,<br /> 2) hda1 korištena za root particiju,<br /> 3) hda5 gdje memoriramo  privremene datoteke koje ne trebamo da osiguramo,<br /> 4) i hda6 za swap <br />  IP adresa 192.168.0.1</p>

				<p>Bilješka: Ne mogu oboje 100GB HD biti sigurnosno kopirane na jedan 200 GB HD sa rdiff-backup (zato što nema mjesta za inkrementalne datoteke), ali ako ne sigurnosno kopirate hda5 na udaljeno računalo (i dok HD nije 100% puna, kako god, ne imajte povjerenja u to) onda bi moglo biti dosta mjesta. Svaki put kad rdiff-backup obavi sigurnosnu kopiju, više od tih inkrementalni datoteka kreira, i zato trebate više i više mjesta.</p>

				<p>Možete rdiff-backupu kazati da drži samo sigurnosne kopije od max. 1 mjeseca (tu naredbu će će mo vam pokazati kasnije), i zato treba puno manje mjesta, nego da rdiff-backup sačuva sve godinama. I naravno ako vam trebaju kopije za nekoliko godina, morate imati i mjesto za memoriranje inkrementalni datoteka.</p>

				<p>Prva stvar koju morate obaviti, je da isto instalirate rdiff-backup na udaljenom računalu (svako računalo koje hoćete da osigurate, uključujući poslužitelja za sigurnosne kopije mora imati instaliran rdiff-backup).</p>

				<p>Da osigurate udaljeno računalo na lokalno, izvodite na lokalnom računalu (ie 192.168.0.1): <span class="highlight-4">Pazite dobro na korištaj "::" </span></p>
<pre>
# mkdir /media/hdb1/rdiff-backups/192.168.0.2/root
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' 192.168.0.2::/media/hdb1/rdiff-backups/192.168.0.2/root
</pre>
				<p>Sad ako hoćete da restaurirate direktorij na udaljenom računalu, inicirajte restauraciju na lokalnom ili udaljenom računalu.</p>

				<p>Sljedeće je primjer kako bi restaurirali direktorij /usr/local/games na udaljenom računalu, sa iniciranjem s udaljenog računala:</p>
<pre>
# rdiff-backup -r now 192.168.0.1::/media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games /usr/local/games

</pre>
				<p>Sljedeće je primjer kako bi restaurirali direktorij /usr/local/games na udaljenom računalu, sa iniciranjem s lokalnog računala:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games 192.168.0.2::/usr/local/games
</pre>
				<p>Koristite istu vrstu syntaxa kad restaurirate root particiju sa Live-CD (kad je udaljeno računalo bootano via Live-CD ... vidite gore).</p>

			<h5>Automatiziranje sigurnosnih kopija:</h5>

				<p>Ako sigurnosno kopirate druga računala na lokalne prva stvar koju morate obaviti je, da aktivirate ssh-prijave bez lozinke koristeći ssh keys. <span class="highlight-2">Zapamtite da pričamo o ssh-prijave bez lozinke kao root. To možemo smanjiti tako da se samo mogu izvoditi rdiff-backup naredbe, ali je to malo previše za ovu temu. Molimo vas da se odnosite na <a href="samba-en.htm#ssh-s">SSH Konfiguraciju</a> </span> Pretpostavljamo puno povjerenje, i tako postavljamo naj lakši put da ostvarimo ssh-prijave bez lozinke.</p>

				<p>Sa lokalnog računala izvodite sljedeće:</p>
<pre>
# [ -f /root/.ssh/id_rsa ] || ssh-keygen -t rsa -f /root/.ssh/id_rsa
</pre>
				<p>I pritisnite 2 puta za prazne lozinke. Onda izvodite:</p>
<pre>
# cat /root/.ssh/id_rsa.pub | ssh 192.168.0.2 'mkdir -p /root/.ssh;\<!--dunno if this is wrong-->
&gt; cat - &gt;&gt;/root/.ssh/authorized_keys2'
</pre>
				<p>Sad će te biti pitani za root lozinku.</p>

				<p>Sad se možete spojiti preko ssh na udaljeno računalo kao root bez upisanja lozinke, i rdiff-backup može da bude automatiziran.</p>

				<p>Kao sljedeće kreirate bash skript, koji sadrži sve rdiff-backup naredbe. Naš bash skript bi mogao izgledati kao ovo:</p>


<pre>
#!/bin/bash
RDIFF=/usr/bin/rdiff-backup
echo
echo "=======Backing up 192.168.0.1 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/hdb1/rdiff-backups/192.168.0.1/root
echo "(and purge increments older than 1 month)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/root
echo
echo "=======Backing up 192.168.0.1 mount hda5======="
${RDIFF} --ssh-no-compression --exclude /media/hda5/myjunk /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo
echo "=======Backing up 192.168.0.2 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' --exclude '/mnt/*/*' 192.168.0.2::/media/hdb1/rdiff-backups/192.168.0.2/root
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.2/root
</pre>


				<p>Sad možete da memorirate taj bash skript pod imenom "myrdiff-backups.bash" i postavite ga u /usr/local/bin na lokalno računalo (poslužitelj za sigurnosne kopije), i napravite ga izvršan. Izvodite bash skript i osigurajte se da radi kako treba.</p>

				<p>Kao naj zadnje još morate namjestiti cron da ga izvodi svaku noć u 8pm. Sljedeće linije u crontabu roota će obaviti posao</p>
<pre>
# crontab -e
i upišite sljedeću liniju
0 20 * * * /usr/local/bin/myrdiff-backups.bash
</pre>

	
	</div>
			<div id="rev">Content last revised UTC 11/05/2007 0430hrs</div>
	<div class="spacer05"></div>

</div>
</body>
</html>
