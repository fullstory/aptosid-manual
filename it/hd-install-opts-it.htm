<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>sidux Manuals - Other Installation Options</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<!-- Last translation revision by bluewater 20/01/2008 0500hrs UTC -->
<div id="menu"> <!-- menu starts here it lang maintainer speedygeo,fortAlamo zenren-->
<!--Welcome to the  sidux-manual Operating System Manual version-01.73.2008.02.25 -->
<!-- menu last updated by zenren 17/04/2008 0010 hrs AEST 18/04/2008 1010 hrs UTC -->
<a href="http://sidux.com/"><img src="../lib/logos/sidux-logo.png" title="A sidux.com forums and wiki" alt="sidux.com logo" id="menu-header" /></a>
	<ul id="top-list">
		<li><a href="wel-quickstart-it.htm#welcome-quick">sidux Guida di Avvio Rapido</a></li>
		<li><a href="http://manual.sidux.com/meta-manual">sidux Meta-Manuale</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-lang-50.png" title="Choose another language" alt="lang-switch" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-it.htm">Manuale di Sidux</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-it.htm#welcome-gen">Manuale di Sidux</a></li>
				<li><a href="welcome-it.htm#how-to">Come usare questo manuale</a></li>
				<li><a href="welcome-it.htm#table-contents">Indice dei contenuti</a></li>
				<li><a href="help-it.htm#help-gen">Come ottenere aiuto</a></li>
				<li><a href="help-it.htm#paste">IRC !paste</a></li>
				<li><a href="credits-it.htm#cred-team">Crediti</a></li>
				<li><a href="wel-quickstart-it.htm#welcome-quick">sidux Quick Start Guide</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-content-it.htm">Contenuti del CD</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-it.htm#cd-content">Contenuti del CD</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="cd-dl-burning-it.htm">Mirrors, Download CD e masterizzazione</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="cd-dl-burning-it.htm#download-sidux">sidux Mirrors, Download masterizzazione</a></li>
				<li><a href="cd-dl-burning-it.htm#md5">md5 Checksum</a></li>
				<li><a href="cd-dl-burning-it.htm#burn-nero">Masterizzare in Windows</a></li>
				<li><a href="cd-dl-burning-it.htm#burn-linux">Masterizzare in Linux</a></li>
				<li><a href="cd-dl-burning-it.htm#xdelta">xdelta Patching</a></li>
				<li><a href="cd-no-gui-burn-it.htm">Masterizzare senza Interfaccia Grafica</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="live-mode-it.htm">Live Mode</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="live-mode-it.htm#rootpw">Password di root del LiveCD Sidux</a></li>
				<li><a href="live-mode-it.htm#live-cd-installsoft">Installare software in sessione Live-CD</a></li>
				<li><a href="live-mode-it.htm#ntfs-3g">Scrivere su partizioni NTFS con ntfs-3g</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="term-konsole-it.htm">Il Terminale/Konsole</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="term-konsole-it.htm#sux"> privilegi di root con sux</a></li>
				<li><a href="term-konsole-it.htm#term-kon"> Terminale/Konsole</a></li>
				<li><a href="term-konsole-it.htm#cli-help">Aiuto nella Linea di Comando</a></li>
				<li><a href="term-konsole-it.htm#term-cmds">Lista Comandi da Terminale</a></li>
				<li><a href="term-konsole-it.htm#shell-scripts">Installare Scripts.sh</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="cheatcodes-it.htm">CheatCodes</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="cheatcodes-it.htm#cheatcodes">Cheatcodes specifici del Live-Cd Sidux</a></li>
				<li><a href="cheatcodes-it.htm#cheatcodes-linux">Cheatcodes generici Linux</a></li>
				<li><a href="cheatcodes-vga-it.htm#vga">Codici VGA</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="part-gparted-it.htm">Partizionare il disco fisso</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="part-gparted-it.htm#partition">Partizionare il disco fisso con GParted</a></li>
				<li><a href="part-gparted-it.htm#ntfs">Ridimensionare una partizione NTFS GParted</a></li>
				<li><a href="part-uuid-it.htm#uuid">UUID, Etichettare Partizioni e fstab</a></li>
				<li><a href="part-cfdisk-it.htm#disknames">Assegnare nomi ai dischi in breve</a></li>
				<li><a href="part-cfdisk-it.htm#partition">Partizionare il disco fisso con cfdisk</a></li>
				<li><a href="part-cfdisk-it.htm#formating">Formattare dopo aver partizionato con cfdisk</a></li>
				<li><a href="part-size-examp-it.htm#part-example">Esempi di dimensione partizioni</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hd-install-it.htm">Opzioni di installazione</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hd-install-it.htm#Inst-prep">Preparazione alla istallazione</a></li>
				<li><a href="hd-install-it.htm#Installation">Installare sul disco fisso</a></li>
				<li><a href="hd-install-it.htm#first-hd-boot">Primo avvio </a></li>
				<li><a href="hd-install-opts-it.htm#fromiso">Avviare con 'fromiso'</a></li>
				<li><a href="hd-install-opts-it.htm#fromiso-persist">fromiso e persistente</a></li>
				<li><a href="hd-install-opts-it.htm#usb-hd">Installare su dispositivo USB</a></li>
				<li><a href="hd-install-opts-it.htm#vtbox">Installare sidux in VirtualBox</a></li>
				<li><a href="hd-install-opts-it.htm#qemu">Installare sidux in QEMU</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-it.htm">Schede Grafiche, Drivers e Schermi</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="hw-dev-hw-dri-it.htm#hd-ntfs3g">Scrivere su NTFS</a></li>
				<li><a href="hw-dev-mon-it.htm#mon-res">Risoluzione dello schermo e tipi di schermi</a></li>
				<li><a href="hw-dev-mon-it.htm#xrandr">Doppio schermo e xrandr</a></li>
				<li><a href="hw-dev-mon-it.htm#mon-binary">Doppio schermo (usando i binaries)</a></li>
				<li><a href="hw-dev-hw-dri-it.htm#non-free-3d">Binari, drivers non-liberi per: Nvidia / ATI</a></li>
				<li><a href="hw-dev-hw-dri-it.htm#native-nv-ati">Driver Liberi di xorg per nVidia, ATI, Radeon, Intel</a></li>
				<li><a href="hw-dev-hw-dri-it.htm#non-free">Hardware che necessita di driver non-liberi</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="wm-kde-it.htm">Gestori di Finestre</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="wm-kde-it.htm#desk-freeze">Blocchi del desktop KDE</a></li>
				<li><a href="wm-kde-it.htm#kde-login">Impossibilita' ad entrare in KDE</a></li>
				<li><a href="wm-kde-it.htm#ch-th">Cambiare i temi</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="lamp-apache-it.htm">Catena LAMP in sidux</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="ntp-server-it.htm#ntp-server">Impostazione Timeserver</a></li>
				<li><a href="lamp-apache-it.htm#serv-apache">Catena LAMP in sidux </a></li>
				<li><a href="lamp-apache-it.htm#serv-ftp">Clients Ftp</a></li>
				<li><a href="lamp-apache-it.htm#serv-sec">Protocolli di sicurezza</a></li>
				<li><a href="lamp-apache-it.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-it.htm#serv-mysql">Impostazione di MySQL</a></li>
				<li><a href="lamp-ppp-it.htm#serv-php">PHP in Apache</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="internet-connecting-it.htm">Internet e Reti</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="tor-privoxy-it.htm#tor">Tor</a></li>
				<li><a href="tor-privoxy-it.htm#privoxy">Privoxy</a></li>
				<li><a href="internet-connecting-it.htm#firewalls">Firewalls</a></li>
				<li><a href="samba-it.htm#configure">Configurare SAMBA (Windows)</a></li>
				<li><a href="samba-it.htm#setup">Impostazione Samba-Server</a></li>
				<li><a href="ssh-it.htm#ssh-fs">SSH Mounting Remoto</a></li>
				<li><a href="ssh-it.htm#ssh-x">Applicazioni X Window via SSH</a></li>
				<li><a href="ssh-it.htm#ssh-f">Intefaccia Grafica SSH con Konqueror</a></li>
				<li><a href="ssh-it.htm#ssh-w">SSH X-Forwarding da un Pc Windows</a></li>
				<li><a href="ssh-it.htm#ssh">SSH e Sicurezza</a></li>
				<li><a href="internet-connecting-it.htm#dial-mod">Modem 56k</a></li>
				<li><a href="internet-connecting-ndis-it.htm#ndiswrapper-basic">Attivare Ndiswrapper</a></li>
				<li><a href="internet-connecting-ndis-it.htm#ndiswrapper-advanced">Attivare Ndiswrapper -  Avanzato</a></li>
				<li><a href="internet-connecting-wpa-it.htm#wpa">WIFI-WLAN</a></li>
				<li><a href="internet-connecting-it.htm#netcardconfig">Attivare una connessione di rete con Ceni</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-apt-it.htm">Installare/eliminare ed effettuare il downgrade dei pacchetti</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="sys-admin-apt-it.htm#apt-cook">APT-Guida rapida Lista Fonti del sofware</a></li>
				<li><a href="sys-admin-meta-it.htm#meta-pack">L'installatore Meta-Packager</a></li>
				<li><a href="sys-admin-meta-it.htm#meta-proxy">L'installatore Meta Installer e i Proxies</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-install">Installare un nuovo pacchetto</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-delete">Eliminare un pacchetto</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-downgrade">Effettuare il downgrade o il pin di un pacchetto</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-cache">Cercare un pacchetto con apt-cache</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-kio">Cercare un pacchetto con kio-apt</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-upgrade">Aggiornare un sistema installato - dist-upgrade</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 14 );" onmouseout="startTime();" ><a href="smxi-it.htm">Amministrazione del sistema</a>
			<ul class="sub-menu" id="sm14">
				<li><a href="smxi-it.htm#smxi">Sintassi dello script smxi</a></li>
				<li><a href="siduxcc-it.htm#siduxcc">Centro di Controllo sidux</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-upgrade">Aggiornare un sistema installato - dist-upgrade</a></li>
				<li><a href="sys-admin-upgrade-it.htm#live-cd-upgrade">Aggiornareun sistema via Live-CD</a></li>
				<li><a href="sys-admin-kern-upg-it.htm#kern-upgrade">Aggiornare il kernel</a></li>
				<li><a href="sys-admin-rdiff-it.htm#rdiff">Back-Up con rdiff</a></li>
				<li><a href="sys-admin-rsync-it.htm#rsync">Back-Up con rsync</a></li>
				<li><a href="vir-rkits-it.htm#virus-rkits">Controllo Virus e Rootkit</a></li>
				<li><a href="sys-admin-gen-it.htm#start-services">Abilitare/disabilitare Servizi</a></li>
				<li><a href="sys-admin-gen-it.htm#pw-lost">Recupero della password di root</a></li>
				<li><a href="sys-admin-gen-it.htm#fonts">Fonts</a></li>
				<li><a href="sys-admin-gen-it.htm#cups">CUPS</a></li>
				<li><a href="sys-admin-gen-it.htm#init">sidux runlevels - init</a></li>
				<li><a href="sys-admin-grub-bootman2-it.htm#mbr-grub-boot">MBR: Sovrascrittura del settore di boot</a></li>
				<li><a href="sys-admin-grub-bootman2-it.htm#dual-boot">Dual o Multibooting</a></li>
				<li><a href="sys-admin-grub-bootman2-it.htm#boot-grub-floppy">Creare un Floppy di avvio</a></li>
				<li><a href="sys-admin-grub-bootman2-it.htm#remove-grub">Rimuovere grub dal MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-it.htm#what-is-grub">Grub il gestore dell'avvio</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
	<div class="divider" id="fromiso">
		<h2 id="top-header">Booting with "fromiso"</h2>
							<p  class="highlight-2">For normal use we recommend the ext3 file system. It is the default file system for sidux and well maintained.</p>

							<p>With this cheatcode you can start from an iso out of a partition ,(ext2/3), which is much faster then from a CD (HD installations with "fromiso" only takes a fraction of time,).</p>

							<p>'fromiso' is of course much faster then from the CD- /DVD-drive and keeps the drive available. As an alternative you could use QEMU as well.</p>

				<h5>Requirements:</h5>

							<p>* a functioning grub (on a floppy, a HD-Installation or the Live-CD)<br />
							* a sidux ISO Image e.g.: sidux.iso and a linux file system like ext2/3 <br />
							* If you rename your image to sidux.ISO you will need to alter the commands accordingly as a unix file naming system is case sensitive.</p>

				<h4 class="highlight-3">Nyx Live-cds:</h4>
							<p>First we choose a place for the iso and 2 files we need, so we get shorter names. Therefore we create a base-directory: for example "/media/sdax", (sda1 or, 2, or 5, or 6, or  whatever, for example) create the directory "sidux" and copy the iso into it:</p>

<pre>
$ sux
mkdir -p /media/sdax/sidux
mv sidux.iso /media/sdax/sidux
</pre>

							<p>now we move to that directory and mount the ISO image:</p>

<pre>
mkdir -p /mnt/test
mount -t iso9660 -o loop,ro /media/sdax/sidux/sidux.iso /mnt/test
</pre>

							<p>Now copy the  vmlinuz and initrd.img  files from the mounted iso image to the directory (where X for the kernel and HD are  known variables::</p>

<pre>
cp /mnt/test/boot/vmlinuz-2.6.23.9-rc1-slh-smp-1  /media/sda5/sidux/
cp /mnt/test/boot/initrd.img-2.6.23.9-rc1-slh-smp-1 /media/sda5/sidux/
</pre>

							<p>Next you have to customise grub.  Therefore  edit the file<span class="highlight-3"> /boot/grub/menu.lst </span> and add the following lines <span class="highlight-3"> AFTER the ### END DEBIAN AUTOMAGIC KERNELS LIST</span>: <span class="highlight-2">NOTE no wildcards on grub line for filenames allowed! </span></p>

<pre>
### ISO boot
title sidux 32bit from ISO
kernel (hd0,4)/sidux/vmlinuz-2.6.23.9-rc1-slh-smp-1 boot=fll quiet vga=791 fromiso=/sidux/sidux.iso
initrd (hd0,4)/sidux/initrd.img-2.6.23.9-rc1-slh-smp-1
</pre>

							<p>With next boot you have a new menu item in grub to start the iso image.</p>

	</div>
	<div class="divider" id="fromiso-persist">
		<h2>fromiso and persist (eros)</h2>

							<p>With eros you can have a persistent live system on a writable disc by combining a fromiso setup with the persist cheatcode.</p>

							<p>sidux uses aufs to enable what is known as "copy on write" over your cd to allow you to write new files and folders and update existing ones by keeping the new files in memory. With the <span class="highlight-3">persist</span> cheatcode, eros will store your new files on the same hard drive partition as you use to store your fromiso cd image.</p>

							<p>Using <span class="highlight-3">persist</span> gives you a live system which performs all the automatic features of the sidux live cd. This has the benefit of doing things like automatically configuring the hardware but it also means  that it will recreate the same files each time you boot up..</p> 

							<p><span class="highlight-3">For example it will not store your X (video card, keyboard, mouse) configuration or your network interfaces file  which makes it ideal for using on more then one computer, </span> but can get in the way if you need to configure some of these features</p>

							<p>Perhaps the ideal use of persistence is in conjunction with the new install-usb-gui tool to create your own bootable flash drive with your files and the software you need.</p>

							<p>Your files will be stored in a subfolder on your drive. This subfolder is created if it does not exist when the <span class="highlight-3">fromiso </span> and <span class="highlight-3">persist</span> cheatcodes are used together. </p>

							<p><span class="highlight-3">persist</span> on a FAT filesystem, as commonly used for dos/Windows 9x installations and usually found by default on flash devices, requires you to create a single large file to use as a loop device, you then format this file.</p>

							<p><span class="highlight-3">As always sidux recommends using an ext3 partition to store your iso and all other files..</span></p>

							<p>This file should be named <span class="highlight-3">sidux-rw </span>and placed in the root directory of your fat drive. Assuming the disc you want to use is mounted and writable on /media/sdb1 and you want to create a 1GB file to use as your persistent drive you could use the following commands (no need for root if you can write to the file).</p>
<pre>
disc="/media/sdb1"
size=1024
dd if=/dev/zero of=${disc}/sidux-rw bs=1M count=${size} &amp;&amp; echo 'y' | /sbin/mkfs.ext3 ${disc}/sidux-rw
</pre>

							<p class="highlight-2">NTFS partitions, commonly used for Windows NT/2000/XP (TM)  installations, CANNOT be used at all for persistence.</p>

	</div>
	<div class="divider" id="usb-hd">
		<h2>Full Installation of sidux on a USB-device</h2>

							<p>To do an installation of sidux on a USB-Stick or a USB-HD is as easy as a normal HD-Install now. Just follow this simple guideline.</p>

							<p>The recommended mininmum size of a usb stick is:<br />
							sidux "LITE" needs 1.2gig PLUS you need data space,<br />
							sidux "FULL" needs 2.1gig PLUS you need data space</p>

							<p>We start with a normal installation and choose the partition on the USB-device, where sidux is to be installed - we speak of "sda1" here, but this is valid for any other partition on a USB-disk or device.</p>

							<p>The Partition must be formatted with a linux-filesystem. Recommended is the ext3 filesystem. An existing partition will be reformatted by the installer!</p>

							<p class="highlight-2">All data on this partition will be lost during the reformat!</p>


							<p>Now you can boot from your USB-HD. 'Boot from USB' must be enabled in your BIOS.</p>

	</div>
	<div class="divider" id="vtbox">
		<h2>Installing sidux with VirtualBox</h2>
							<p>VirtualBox-ose is ideal for 32bit machines. For 64bit use QEMU.</p>
						<ul>
 							<li>1. create a harddiskimage for VirtualBox</li>
 							<li>2. boot the iso with VirtualBox</li>
 							<li>3. install on the image</li>
						</ul>

				<h4>Requirements</h4>
							<p><span class="highlight-3">Recommended ram: 1 gig </span>: Ideally 512 MB for the guest and 512 MB for the host. (it can be run on less, but do not expect to have good performance).</p>

							<p><span class="highlight-3">Hard disk space:</span> While VirtualBox itself is very lean (a typical installation will only need about 30 MB of hard disk space), the virtual machines will require fairly huge files on disk to represent their own hard disk storage. So, to install MS Windows XP (TM), for example, you will need a file that will easily grow to several GB in size. To have sidux in VirtualBox you need to allocate a 5 gig image plus a swap allocation.</p>

							<p class="highlight-3">Make sure to dist-upgrade before you install virtual machine modules after installing a new kernel, or you'll get a gcc mismatch, failed module build error.(This applies to any external module) </p>

						<h4>The mechanism:</h4>
<pre>
Install the virtualbox package
Click Applications &gt; System Tools &gt;InnoTek VirtualBox - Virtual Machine
Make a VM, put a Operating System-CD into your CD drive and install.and reboot
</pre>

				<h3>Installation:</h3>
<pre>
apt-get update
apt-get install virtualbox-ose 
m-a a-i virtualbox-ose
</pre>

							<p>Then you store the information identifying the current operating system in the structure:</p> 
	<!-- echo virtualbox-ose-module-$(uname -r) -->
<pre>
virtualbox-ose-module-$(uname -r)
</pre>
							<p class="highlight-3">You will need to do the following:</p>
<pre>
adduser &lt;username&gt; vboxusers 
</pre>



					<h3>Installing sidux to the virtual machine</h3>
							<p>Use virtualbox's wizard to create a new virtual machine for sidux. then follow the instructions for a regular sidux-installation.</p>

							<p><a href="http://www.virtualbox.org/">VirtualBox has a comprehesive PDF Help, that you can download</a> </p>

				<h3>Automated installation with svmi</h3>
							<p>svmi is started by sidux-scripts. You can run the options manually, or use the auto install feature, non interactive mode, see <span class="highlight-3">svmi -h for autoinstall options</span>. svmi makes the vbox kernel module, it updates modules, it adds it to /etc/modules so it will start automatically (otherwise vbox won't run on reboot), and updates 'adduser'. To activate smvi as root in a konsole/terminal:</p>
<pre>
svmi
</pre>

		<div class="screenshot"><img src="../lib/images-it/smxi-it/smxi_virtual-it.png" alt="smxi_virtual" /></div>


	</div>
	<div class="divider" id="qemu">
		<h2>Installing sidux with QEMU</h2>

		<ul>
 			<li>1. create a harddiskimage for QEMU</li>
 			<li>2. boot the iso with QEMU</li>
 			<li>3. install on the image</li>

		</ul>

 			<h4>Creating the hard disk image</h4>

				<p>To run qemu you will probably need a hard disk image. This is a file which stores the contents of the emulated hard disk.</p>

				<p>Use the command:</p>
<pre>
qemu-img create -f qcow sidux.qcow 3G
</pre>
				<p>To create the image file named "sidux.qcow". The "3G" parameter specifies the size of the disk - in this case 3 GB. You can use suffix M for megabytes (for example "256M"). You shouldn't worry too much about the size of the disk - the qcow format compresses the image so that the empty space doesn't add up to the size of the file.</p>


			<h4>Installing the operating system</h4>

				<p>This is the first time you will need to start the emulator. <span class="highlight-3">One thing to keep in mind: when you click inside qemu window, the mouse pointer is grabbed. To release it press :</span></p>
<pre>
Ctrl+Alt
</pre>

				<p>If you need to use a bootable floppy, run Qemu with:</p>
<pre>
qemu -floppy sidux.iso -net nic -net user -m 512 -boot d sidux.qcow
</pre>
				<p>If your CD-ROM is bootable, run Qemu with:</p>
<pre>
qemu -cdrom sidux.iso -net nic -net user -m 512 -boot d sidux.qcow
</pre>
				<p>Now install sidux as if you were going to install it on a real HD</p>


			<h4>Running the system</h4>

				<p>To run the system simply type:</p>
<pre>
qemu [hd_image]
</pre>
				<p>A good idea is to use overlay images. This way you can create hard disk image once and tell Qemu to store changes in external file. You get rid of all the instability, because it is so easy to revert to previous system state.</p>

				<p>To create an overlay image, type:</p>
<pre>
qemu-img create -b [[base''image]] -f qcow [[overlay''image]]
</pre>
				<p>Substitute the hard disk image for base_image (in our case sidux.qcow). After that you can run qemu with:</p>
<pre>
qemu [overlay_image]
</pre>
				<p>The original image will be left untouched. One hitch, the base image cannot be renamed or moved, the overlay remembers the base's full path.</p>


			<h4>Using any real partition as the single primary partition of a hard disk image</h4>

				<p>Sometimes, you may wish to use one of your system partition from within qemu (for instance, if you wish booting both your real machine or qemu using a given partition as root). You can do this using software RAID in linear mode (you need the linear.ko kernel driver) and a loopback device: the trick is to dynamically prepend a master boot record (MBR) to the real partition you wish to embed in a qemu raw disk image.</p>

				<p>Suppose you have a plain, unmounted /dev/hdaN partition with some filesystem on it you wish to make part of a qemu disk image. First, you create some small file to hold the MBR:</p>
<pre>
dd if=/dev/zero of=/path/to/mbr count=32
</pre>
				<p>Here, a 16 KB (32 * 512 bytes) file is created. It is important not to make it too small (even if the MBR only needs a single 512 bytes block), since the smaller it will be, the smaller the chunk size of the software RAID device will have to be, which could have an impact on performance. Then, you setup a loopback device to the MBR file:</p>
<pre>
losetup -f /path/to/mbr
</pre>
				<p>Let's assume the resulting device is /dev/loop0, because we wouldn't already have been using other loopbacks. Next step is to create the "merged" MBR + /dev/hdaN disk image using software RAID:</p>
<pre>
 modprobe linear
 mdadm --build --verbose /dev/md0 --chunk=16 --level=linear --raid-devices=2 /dev/loop0 /dev/hdaN
</pre>
				<p>The resulting /dev/md0 is what you will use as a qemu raw disk image (don't forget to set the permissions so that the emulator can access it). The last (and somewhat tricky) step is to set the disk configuration (disk geometry and partitions table) so that the primary partition start point in the MBR matches the one of /dev/hdaN inside /dev/md0 (an offset of exactly 16 * 512 = 16384 bytes in this example). Do this using fdisk on the host machine, not in the emulator: the default raw disc detection routine from qemu often results in non kilobyte-roundable offsets (such as 31.5 KB, as in the previous section) that cannot be managed by the software RAID code. Hence, from the the host:</p>
<pre>
 fdisk /dev/md0
</pre>
				<p>There, create a single primary partition corresponding to /dev/hdaN, and play with the 's'ector command from the 'x'pert menu until the first cylinder (where the first partition starts), matches to the size of the MBR. Finally, 'w'rite the result to the file: you are done. You know have a partition you can mount directly from your host, as well as part of a qemu disk image:</p>
<pre>
 qemu -hdc /dev/md0 [...]
</pre>
				<p>You can of course safely set any bootloader on this disk image using qemu, provided the original /boot/hdaN partition contains the necessary tools.</p>



			<h4>Using the QEMU Accelerator Module</h4>

				<p>The developers of qemu have created an optional kernel module to accelerate qemu to sometimes near native levels. This should be loaded with the option</p>
<pre>
major=0
</pre>
				<p>to automate the creation of the required /dev/kqemu device. The following command</p>
<pre>
echo "options kqemu major=0" >> /etc/modprobe.conf
</pre>
				<p>This will amend modprobe.conf to ensure that the module option is added every time the module is loaded.</p>

<pre>
qemu [...] -kernel-kqemu
</pre>
				<p>This enables full virtualization and thus improves speed considerably.</p>

			<h4>To activate qemu:</h4>
<pre>
qemu -cdrom /tmp/pkg/sidux-debug.iso -net nic -net user -m 512
</pre>
		<p><a href="http://fabrice.bellard.free.fr/qemu/qemu-doc.html">The official documentation of the QEMU Project </a> </p>
		<p><a href="http://wiki2.archlinux.org/index.php/Qemu">Some content for QEMU for the sidux-manual was accessed off this site under GNU Free Documentation License 1.2 and modified for the sidux-manual</a> </p>

		
	</div>
	<div id="rev">Page last revised 16/04/2008 0900 UTC</div>

</div>
</body>
</html>
