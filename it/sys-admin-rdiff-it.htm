<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>sidux Manuals - rdiff</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<!-- Last translation revision dedo xx/05/2007 1500 UTC-->
<div id="menu"> <!-- menu starts here it lang maintainer alessiog75, speedygeo, zenren, -->
<!--Welcome to the  sidux-manual Operating System Manual version-01.74.2008.06.09 -->
<!-- menu last updated by alessiog75 16/06/2008 1800 hrs UTC and run againon 19-06-2008 0630 UTC-->
<a href="http://sidux.com/"><img src="../lib/logos/sidux-logo.png" title="A sidux.com forums and wiki" alt="sidux.com logo" id="menu-header" /></a>
	<ul id="top-list">
		<li><a href="manual-search-it.htm#search-on">Ricerca</a> </li>
		<li><a href="http://manual.sidux.com/meta-manual">sidux - Meta-Manuale</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-lang-50.png" title="Choose another language" alt="lang-switch" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-it.htm">Manuale di sidux</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-it.htm#welcome-gen">Manuale di sidux</a></li>
				<li><a href="welcome-it.htm#how-to">Come usare questo manuale</a></li>
				<li><a href="welcome-it.htm#table-contents">Indice dei contenuti</a></li>
				<li><a href="help-it.htm#help-gen">Come ottenere aiuto</a></li>
				<li><a href="help-it.htm#paste">IRC !paste</a></li>
				<li><a href="credits-it.htm#cred-team">Crediti</a></li>
				<li><a href="wel-quickstart-it.htm#welcome-quick">sidux - Guida d'avvio rapida</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-content-it.htm">Contenuti del CD</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-it.htm#cd-content">Contenuti del CD</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="cd-dl-burning-it.htm">Mirror, download CD e masterizzazione</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="cd-dl-burning-it.htm#download-sidux">sidux mirror, download e masterizzazione</a></li>
				<li><a href="cd-dl-burning-it.htm#md5">somma md5</a></li>
				<li><a href="cd-dl-burning-it.htm#burn-nero">Masterizzare in Windows</a></li>
				<li><a href="cd-dl-burning-it.htm#burn-linux">Masterizzare in Linux</a></li>
				<li><a href="cd-dl-burning-it.htm#xdelta">xdelta patching</a></li>
				<li><a href="cd-no-gui-burn-it.htm">Masterizzare senza interfaccia grafica</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="live-mode-it.htm">Live Mode</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="live-mode-it.htm#rootpw">Password di root del liveCD sidux</a></li>
				<li><a href="live-mode-it.htm#live-cd-installsoft">Installare software in sessione liveCD</a></li>
				<li><a href="live-mode-it.htm#ntfs-3g">Scrivere su partizioni NTFS con ntfs-3g</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="term-konsole-it.htm">Il terminale / Konsole</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="term-konsole-it.htm#sux">Privilegi di root con sux</a></li>
				<li><a href="term-konsole-it.htm#term-kon">Terminale / Konsole</a></li>
				<li><a href="term-konsole-it.htm#cli-help">Aiuto nella linea di comando</a></li>
				<li><a href="term-konsole-it.htm#term-cmds">Lista dei comandi da terminale</a></li>
				<li><a href="term-konsole-it.htm#shell-scripts">Installare scripts.sh</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="cheatcodes-it.htm">Opzioni d'avvio</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="cheatcodes-it.htm#cheatcodes">Opzioni d'avvio specifiche del liveCD sidux</a></li>
				<li><a href="cheatcodes-it.htm#cheatcodes-linux">Opzioni d'avvio generici di Linux</a></li>
				<li><a href="cheatcodes-vga-it.htm#vga">Codici VGA</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="part-gparted-it.htm">Partizionare il disco fisso</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="part-gparted-it.htm#partition">Partizionare il disco fisso con GParted</a></li>
				<li><a href="part-gparted-it.htm#ntfs">Ridimensionare una partizione NTFS GParted</a></li>
				<li><a href="part-uuid-it.htm#uuid">UUID, etichettare partizioni e fstab</a></li>
				<li><a href="part-cfdisk-it.htm#disknames">Assegnare nomi ai dischi in breve</a></li>
				<li><a href="part-cfdisk-it.htm#partition">Partizionare il disco fisso con cfdisk</a></li>
				<li><a href="part-cfdisk-it.htm#formating">Formattare dopo aver partizionato con cfdisk</a></li>
				<li><a href="part-size-examp-it.htm#part-example">Esempi di dimensione partizioni</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hd-install-it.htm">Opzioni d'installazione</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hd-install-it.htm#Inst-prep">Preparazione all'installazione</a></li>
				<li><a href="hd-install-it.htm#Installation">Installare sul disco fisso</a></li>
				<li><a href="hd-install-it.htm#first-hd-boot">Primo avvio</a></li>
				<li><a href="hd-install-opts-it.htm#fromiso">Avviare con 'fromiso'</a></li>
				<li><a href="hd-install-opts-it.htm#fromiso-persist">fromiso e persistente</a></li>
				<li><a href="hd-install-opts-it.htm#usb-hd">Installare su dispositivo USB</a></li>
				<li><a href="hd-install-opts-it.htm#vtbox">Installare sidux in VirtualBox</a></li>
				<li><a href="hd-install-opts-it.htm#qemu">Installare sidux in QEMU</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-it.htm">Schede grafiche, driver e schermi</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="hw-dev-hw-dri-it.htm#hd-ntfs3g">Scrivere su NTFS</a></li>
				<li><a href="hw-dev-mon-it.htm#mon-res">Risoluzione dello schermo e tipi di schermi</a></li>
				<li><a href="hw-dev-mon-it.htm#xrandr">Doppio schermo e xrandr</a></li>
				<li><a href="hw-dev-mon-it.htm#mon-binary">Doppio schermo (usando i binaries)</a></li>
				<li><a href="hw-dev-hw-dri-it.htm#non-free-3d">Binari, driver non-liberi per: nVidia / ATi</a></li>
				<li><a href="hw-dev-hw-dri-it.htm#native-nv-ati">Driver liberi di xorg per nVidia, ATi, Radeon, Intel</a></li>
				<li><a href="hw-dev-hw-dri-it.htm#non-free">Hardware che necessita di driver non-liberi</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="wm-kde-it.htm">Gestori di finestre</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="wm-kde-it.htm#desk-freeze">Blocchi del desktop KDE</a></li>
				<li><a href="wm-kde-it.htm#kde-login">Impossibilit√† ad entrare in KDE</a></li>
				<li><a href="wm-kde-it.htm#ch-th">Cambiare i temi</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="lamp-apache-it.htm">LAMP in sidux</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="ntp-server-it.htm#ntp-server">Impostazione time server</a></li>
				<li><a href="lamp-apache-it.htm#serv-apache">LAMP in sidux</a></li>
				<li><a href="lamp-apache-it.htm#serv-ftp">Client ftp</a></li>
				<li><a href="lamp-apache-it.htm#serv-sec">Protocolli di sicurezza</a></li>
				<li><a href="lamp-apache-it.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-it.htm#serv-mysql">Impostazione di MySQL</a></li>
				<li><a href="lamp-ppp-it.htm#serv-php">PHP in Apache</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="internet-connecting-it.htm">Internet e reti</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="tor-privoxy-it.htm#tor">Tor</a></li>
				<li><a href="tor-privoxy-it.htm#privoxy">Privoxy</a></li>
				<li><a href="internet-connecting-it.htm#firewalls">Firewall</a></li>
				<li><a href="samba-it.htm#configure">Configurare Samba (Windows)</a></li>
				<li><a href="samba-it.htm#setup">Impostazione samba-server</a></li>
				<li><a href="ssh-it.htm#ssh-fs">SSH Mounting remoto</a></li>
				<li><a href="ssh-it.htm#ssh-x">Applicazioni X-window attraverso SSH</a></li>
				<li><a href="ssh-it.htm#ssh-f">Interfaccia grafica SSH con Konqueror</a></li>
				<li><a href="ssh-it.htm#ssh-w">SSH X-forwarding da un PC Windows</a></li>
				<li><a href="ssh-it.htm#ssh">SSH e sicurezza</a></li>
				<li><a href="internet-connecting-it.htm#dial-mod">Modem 56k</a></li>
				<li><a href="internet-connecting-ndis-it.htm#ndiswrapper-basic">Attivare ndiswrapper</a></li>
				<li><a href="internet-connecting-ndis-it.htm#ndiswrapper-advanced">Attivare ndiswrapper - Avanzato</a></li>
				<li><a href="internet-connecting-wpa-it.htm#wpa">WIFI - WLAN</a></li>
				<li><a href="internet-connecting-it.htm#netcardconfig">Attivare una connessione di rete con 'ceni'</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-apt-it.htm">Installare, eliminare ed effettuare il downgrade dei pacchetti</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="sys-admin-apt-it.htm#apt-cook">APT - Guida rapida lista depositi del software</a></li>
				<li><a href="sys-admin-meta-it.htm#meta-pack">L'installatore Meta-Packager</a></li>
				<li><a href="sys-admin-meta-it.htm#meta-proxy">L'installatore Meta Installer ed i Proxy</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-install">Installare un nuovo pacchetto</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-delete">Eliminare un pacchetto</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-downgrade">Effettuare il downgrade o il pin di un pacchetto</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-cache">Cercare un pacchetto con apt-cache</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-kio">Cercare un pacchetto con kio-apt</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-upgrade">Aggiornare un sistema installato - dist-upgrade</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 14 );" onmouseout="startTime();" ><a href="smxi-it.htm">Amministrazione del sistema</a>
			<ul class="sub-menu" id="sm14">
				<li><a href="smxi-it.htm#smxi">Sintassi dello script smxi</a></li>
				<li><a href="siduxcc-it.htm#siduxcc">Centro di controllo sidux</a></li>
				<li><a href="sys-admin-apt-it.htm#apt-upgrade">Aggiornare un sistema installato - dist-upgrade</a></li>
				<li><a href="sys-admin-upgrade-it.htm#live-cd-upgrade">Aggiornare un sistema attraverso il liveCD</a></li>
				<li><a href="sys-admin-kern-upg-it.htm#kern-upgrade">Aggiornare il kernel</a></li>
				<li><a href="sys-admin-rdiff-it.htm#rdiff">Backup con rdiff</a></li>
				<li><a href="sys-admin-rsync-it.htm#rsync">Backup con rsync</a></li>
				<li><a href="vir-rkits-it.htm#virus-rkits">Controllo virus e root kit</a></li>
				<li><a href="sys-admin-gen-it.htm#start-services">Abilitare / disabilitare servizi</a></li>
				<li><a href="sys-admin-gen-it.htm#pw-lost">Recupero della password di root</a></li>
				<li><a href="sys-admin-gen-it.htm#fonts">Font</a></li>
				<li><a href="sys-admin-gen-it.htm#cups">CUPS</a></li>
				<li><a href="sys-admin-gen-it.htm#init">sidux runlevel - init</a></li>
				<li><a href="sys-admin-grub-bootman2-it.htm#mbr-grub-boot">MBR: sovrascrittura del settore di boot</a></li>
				<li><a href="sys-admin-grub-bootman2-it.htm#dual-boot">Avvio doppio o multiplo</a></li>
				<li><a href="sys-admin-grub-bootman2-it.htm#boot-grub-floppy">Creare un floppy di avvio</a></li>
				<li><a href="sys-admin-grub-bootman2-it.htm#remove-grub">Rimuovere grub dall'MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-it.htm#what-is-grub">Grub, il gestore dell'avvio</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
	<div class="divider" id="rdiff">
			<h2 id="top-header">Backup del Sistema con rdiff-backup</h2>
				<p>rdiff-backup &egrave; uno strumento per eseguire il backup dei tuoi file. (Pu&ograve; essere utilizzato su molti sistemi *nix).<br />
           In sidux avete la grande possibilit&agrave; di scegliere come avviare il processo, in modo FaiDaTe o attraverso uno script.</p>

				<p><a href="http://techpatterns.com/forums/about831.html">Questo &egrave; lo script di h2</a></p>

			<h5>Segue la versione FaiDaTe</h5>

			<h6>rdiff-backup</h6>

				<p class="highlight-2">Eseguite i comandi come root in konsole, a meno di altre istruzioni</p>

				<p>*utile per ripristinare il sistema in seguito a problemi con dist-upgrade, kernel upgrade, etc. (ma anche solo per recuperare singoli file).<br />
				*esegue il backup soltanto dei file modificati come rsync (ogni backup quindi non impiega molto tempo).<br />
				*tiene traccia dei cambiamenti (significa che puoi recuperare un file cancellato da tre settimane!)<br />
				*esegue backup sicuri attraverso una rete (usando ssh).<br />
				*esegue il backup delle partizioni mentre sono montate (&egrave; facile quindi automatizzare un backup giornaliero ... non &egrave; necessario alcun unmount).<br />
				*pu&ograve; ripristinare tutto qualora il tuo hard disk si rompa e tu debba comprarne uno nuovo.<br />
				*si adatta (bene con linux, con qualche difficolt&agrave; con windows) al backup di grandi reti ed &egrave; utilizzato a livello professionale e commerciale.<br />
				*&egrave; un'applicazione controllabile da command-line, &egrave; fantastica quindi per coloro che amano eseguire in modo potente operazioni come backup automatici (per esempio con uno script bash e cron).<br />
				*ricorda e gestisce propriet&agrave; e permessi dei file, ma anche link simbolici (e ogni cosa di questo genere), cos&igrave; quando esegui un ripristino ottieni tutto esattamente come era.</p>

			<h6>Di cosa avrete bisogno</h6>
				<p>rdiff-backup mantiene un'intera copia (non compressa) dei file di cui stai facendo il backup, e anche una cronologia (backup incrementali), il che significa che lo spazio necessario per il backup deve essere maggiore delle dimensioni dei file di cui stai facendo il backup. Se state eseguendo il backup di 100 GB di dati, potreste avere bisogno di 120 GB di spazio (su un altro hard drive preferibilmente!).</p>

			<h6>Come configurarlo</h6>
				<p>Mettiamo che il vostro pc abbia a disposizione:<br />
				* un hard drive da 100 GB (hda), che &egrave; in uso insieme a hda1 (partizione root), hda5 (usata per storage di musica o altri file) e hda6 (swap).<br />
				* un hard drive da 200 GB (hdb) non in uso, con hdb1 montato ... useremo questo per i nostri backup.<br />
				* Indirizzo IP 192.168.0.1</p>

				<p>La prima cosa da fare &egrave; installare rdiff-backup:</p>
<pre>
# apt-get install rdiff-backup
</pre>
				<p>Ora, sebbene possiate fare il backup di qualsiasi directory, presumiamo di volere il backup di intere partizioni ... vogliamo eseguire il backup di hda1 e hda5 (non di hda6), e allora creiamo alcune directory per immagazzinare i dati:</p>
<pre>
# mkdir /media/hdb1/rdiff-backups/192.168.0.1/root
# mkdir /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>Avete bisogno di indirizzi IP distinti se volete usare questo stesso computer anche per il backup di un altro (questione affrontata pi&ugrave; avanti).</p>

			<h6>Backup</h6>

				<p>rdiff-backup utilizza la sintassi <span class="highlight-3">rdiff-backup source-dir dest-dir</span>. Nota: specificate sempre nomi di directory, non di file.</p>

				<p>Per il backup di hda5, esegui:</p>
<pre>
# rdiff-backup /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>E per il backup della partizione root, esegui:</p>
<pre>
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/hdb1/rdiff-backups/192.168.0.1/root
</pre>
				<p>Ogni errore "AF_UNIX path too long" pu&ograve; essere ignorato. L'operazione potrebbe richiedere un po' di tempo, dato che rdiff-backup dovr&agrave; fare il backup dell'intera partizione (non solo le differenze), trattandosi della prima volta che si esegue il backup. Nota che non ci interessa il backup di /tmp perch&eacute; il suo contenuto cambia sempre, nemmeno /proc o /sys dato che non contengono veri e propri file, e non vogliamo nemmeno il backup dei punti di mount. Avviando il backup dei punti di mount, stareste facendo il backup di hdb1, e potreste incappare in un loop infinito! Una soluzione a questo problema &egrave; fare il backup dei punti di mount separatamente.</p>

				<p>La ragione per cui inserire '/proc/*' invece di '/proc' &egrave; che in questo modo verr&agrave; certamente eseguito il backup della directory di nome /proc, ma ignorando ogni suo contenuto. La stessa cosa vale per /tmp, /sys, e a maggior ragione per tutti i nomi dei punti di mount.</p>

				 <p>In questo modo, se distruggete la vostra partizione root ed effettuate un ripristino completo, /tmp, /proc, /sys e i nomi dei punti di mount verranno creati (proprio come dovrebbe essere). Ci potrebbero essere dei problemi se /tmp non &egrave; presente durante l'avvio di X (Fate riferimento alla pagina man per maggiori informazioni su --exclude e --include).</p>

			<h6>Ripristinare directory dai backup</h6>

				<p>rdiff-backup utilizza la sintassi:</p>
<pre>
rdiff-backup -r &lt;from-when&gt; &lt;source-dir&gt; &lt;dest-dir&gt;
</pre>
				<p>Se per esempio avete cancellato la directory /media/hda7/photos, potreste ripristinarla con:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5/photos /media/hda5/photos
</pre>
				<p>L'opzione "-r now" indica di ripristinare dal backup pi&ugrave; recente. Se hai effettuato backup completi periodicamente (con crontab, ad esempio), e non ti sei accorto che la directory photos mancava da un po' di tempo, avresti bisogno di effettuare il ripristino da un backup di qualche giorno prima (e non "now", perch&eacute; nel backup pi&ugrave; recente la directory photos non esiste). Oppure magari vuoi soltanto ritornare alla versione precedente di qualcosa.</p>

				<p>Se volete recuperare qualcosa risalente a tre giorni prima, allora usate "-r 3D" ... ma, come dice la pagina man, notate:</p>

				<p class="highlight-1">"3D" si riferisce a 72 ore prima dal momento dell'esecuzione, e se non &egrave; presente alcun backup risalente a quel momento, rdiff-backup ripristina il backup precedente. Per esempio, nel caso precedente, se viene usato "3D", e ci sono solamente backup di 2 o 4 giorni prima, la directory verr&agrave; ripristinata cos&igrave; com'era 4 giorni prima (bisogna tenerlo presente questo prima di effettuare un ripristino).</p>

				<p>Il seguente comando mostrer&agrave; le date e gli orari in cui sono stati effettuati backup di hda5:</p>
<pre>
# rdiff-backup -l /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
			<h5>Recuperare partizioni</h5>

				<p>Potete recuperare anche intere partizioni, d'altra parte un punto di mount &egrave; semplicemente una directory.</p>

				<p class="highlight-2">ATTENZIONE: Non ripristinate la partizione root mentre &egrave; in uso! Con un solo comando perderete tutti i file di tutte le partizioni, inclusi tutti i backup presenti su hard disk esterno!! rdiff-backup esegue esattamente le istruzioni: se il backup della partizione root ha punti di mount vuoti, durante il ripristino cancella tutto ci&ograve; che si trova nei file system montati per ripristinare lo stato del backup.</p>

				<p>Per recuperare hda5 dal backup pi&ugrave; recente, eseguiamo semplicemente:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5 /media/hda5
</pre>
			<h5>Ripristinare la partizione root</h5>

				<p>Ripristinare la partizione root non &egrave; cos&igrave; semplice. Non ripristinate la partizione root mentre &egrave; montata (vedi avvertimento sopra). &Egrave; molto utile poter ripristinare la partizione root, perch&eacute; qualora si incontrassero problemi durante installazione/upgrade, o con il kernel (etc.), si ha la sicurezza di essere in grado di rimettere tutto a posto, in soli 20 minuti.</p>

				<p>Un modo per ripristinare la partizione root &egrave; eseguire il boot in una partizione linux libera, se ne avete una sul disco fisso. Potrete quindi recuperare la partizione che volete, perch&eacute; non verr&agrave; montata come root. Dopo aver recuperato la partizione, eseguitevi il boot e sar&agrave; esattamente come era al tempo del backup! Questo &egrave; sicuramente il metodo pi&ugrave; semplice.</p>

				<p>Un altro modo per recuperare la partizione root &egrave; eseguire il boot dal live-CD di sidux ed eseguire il ripristino da l&igrave;. rdiff-backup &egrave; incluso in sidux.  Qualora la vesione del live-cd di sidux che possiedi non includa rdiff, potete digitare in grub (Bootoptions, (Cheatcodes)) il cheatcode "unionfs": cos&igrave; potrete installare programmi sul live cd. Basta avviare e utilizzare i seguenti comandi:</p>
<pre>
$ sudo su
# wget -O /etc/apt/sources.list http://sidux.com/files/misc/sources.list
# apt-get update
# apt-get install rdiff-backup
</pre>
				<h6>Ora procediamo con il ripristino:</h6>
<pre>
# mount /dev/hda1 /media/hda1
# mount /dev/hdb1 /media/hdb1
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>Nota: Se non avete un CD di sidux e il tuo Live-CD &egrave; supportato da klik, potete installare rdiff-backup attraverso klik:</p>
<pre>
$ sudo ~/.zAppRun ~/Desktop/rdiff-backup_0.13.4-5.cmg rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>Si consiglia a chi esegue il backup della propria partizione root (con l'intenzione di ripristinarla in caso di bisogno) di testare il processo di ripristino. Niente di peggio che pensare che tutto andr&agrave; bene, e poi incappare in un'emergenza inaspettata.</p>

			<h5>Backup di un altro pc</h5>

				<p>Se il pc locale pu&ograve; comunicare attraverso ssh a un altro pc, &egrave; possibile fare il backup dell'altro pc nel pc locale (pvviamente a patto che quest'ultimo abbia abbastanza spazio libero sull'hard disk). Il server ssh (sshd) deve essere attivo sul pc remoto. L'altro pc non deve per forza essere nella tua lan, pu&ograve; trovarsi ovunque.</p>

				<p>Mettiamo che il vostro pc remoto abbia a disposizione:<br />
				1) hard drive da 100 GB (hda) in uso, con montati:<br />
				2) hda1 per la partizione root,<br />
				3) hda5 per file temporanei di cui non vogliamo il backup,<br />
				4) e hda6 per lo swap<br />
				5) Indirizzo IP 192.168.0.2</p>

				<p>Nota: il backup di entrambi i drive da 100 GB di solito non pu&ograve; essere effettuato su un drive da 200 GB utilizzando rdiff-backup (poich&eacute; non ci sarebbe spazio per i file incrementali), ma dal momento che non state eseguendo il backup di hda5 sul pc remoto (e dal momento che di solito gli hard drive non sono usati al 100%, anche se non conviene contare troppo su questo) potreste calcolare di avere abbastanza spazio. Ogni volta che rdiff-backup effettua un altro backup, ancora pi&ugrave; file incrementali vengono creati, e questo richiede sempre pi&ugrave; spazio.</p>

				<p>Potete ordinare a rdiff-backup di mantenere soltanto backup risalenti al massimo a un mese prima (questo comando viene mostrato pi&ugrave; avanti), risparmiando pi&ugrave; spazio che ordinandogli di mantenere dati vecchi di anni (e conseguentemente file incrementali vecchi di anni).</p>

				<p>La prima cosa che dovete fare &egrave; installare rdiff-backup anche sul pc remoto (ogni computer di cui vuoi il backup, incluso il backup server, deve avere rdiff-backup installato).</p>

				<p>Per il backup del pc remoto sul pc locale, esegui sul pc locale (cio&egrave; 192.168.0.1): <span class="highlight-4">Nota l'uso della coppia di due punti :: </span></p>
<pre>
# mkdir /media/hdb1/rdiff-backups/192.168.0.2/root
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' 192.168.0.2::/ /media/hdb1/rdiff-backups/192.168.0.2/root 
</pre>
				<p>Se vulete dunque ripristinare una directory sul pc remoto, iniziate il ripristino o sul pc locale o su quello remoto.</p>

				<p>Ecco come potreste ripristinare dal pc remoto la directory /usr/local/games sul pc remoto stesso:</p>
<pre>
# rdiff-backup -r now 192.168.0.1::/media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games /usr/local/games
</pre>
				<p>E come farlo dal pc locale:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games 192.168.0.2::/usr/local/games
</pre>
				<p>Fate uso dello stesso tipo di sintassi per ripristinare la tua partizione root da un live cd (dove il pc remoto &egrave; stato avviato da live cd ... vedi sopra).</p>

			<h5>Automatizzare i backup:</h5>

				<p>Se state eseguendo il backup di un altro pc sul pc locale, la prima cosa da fare &egrave; abilitare il login ssh senza password. <span class="highlight-2">Notate che stiamo parlando di login ssh come root senza password. Si potrebbe fare in modo che solo che i comandi rdiff-backup siano eseguiti, ma questo non rientra negli scopi di questa trattazione. Fate riferimento a <a href="samba-it.htm#ssh-s">Configurazione di SSH</a></span> per questo. Presumiamo che nel nostro caso non ci siano problemi di sicurezza, e imposteremo quindi nel modo pi&ugrave; semplice possibile i login senza password.</p>

				<p>Dal pc locale esegui i seguenti comandi:</p>
<pre>
# [ -f /root/.ssh/id_rsa ] || ssh-keygen -t rsa -f /root/.ssh/id_rsa
</pre>
				<p>E premete invio due volte per avere password vuote. Poi esegui:</p>
<pre>
# cat /root/.ssh/id_rsa.pub | ssh 192.168.0.2 'mkdir -p /root/.ssh;\<!--dunno if this is wrong-->
> cat - >>/root/.ssh/authorized_keys2'
</pre>
				<p>Vi verr&agrave; richiesta la password root.</p>

				<p>Ora potete controllare il pc remoto come root attraverso ssh senza dover inserire una password, e automatizzare rdiff-backup.</p>

				<p>Create quindi uno script bash che contiene tutti i comandi rdiff-backup. Il nostro script bash potrebbe essere qualcosa del genere:</p>

<pre>
#!/bin/bash
RDIFF=/usr/bin/rdiff-backup
echo
echo "=======Backing up 192.168.0.1 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/hdb1/rdiff-backups/192.168.0.1/root
echo "(and purge increments older than 1 month)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/root
echo
echo "=======Backing up 192.168.0.1 mount hda5======="
${RDIFF} --ssh-no-compression --exclude /media/hda5/myjunk /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo
echo "=======Backing up 192.168.0.2 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' --exclude '/mnt/*/*' 192.168.0.2::/media/hdb1/rdiff-backups/192.168.0.2/root
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.2/root
</pre>


				<p>Potete dunque salvare questo script bash come "myrdiff-backups.bash", metterlo in /usr/local/bin sulla nostra macchina locale (backup server) e impostarlo come eseguibile. Esegui lo script bash e assicurati che funzioni.</p>

				<p>E infine potete stabilire che cron lo esegua ogni giorno alle 20:00, inserendo la linea seguente nel crontab di root:</p>
<pre>
# crontab -e
and insert the following line
0 20 * * * /usr/local/bin/myrdiff-backups.bash
</pre>

			<div id="rev">Content last revised 05/12/2007 1230 UTC</div>
</div>
</div>
</body>
</html>
