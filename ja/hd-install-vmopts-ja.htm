<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>sidux Manuals - VM Installation Options</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<!-- Last translation revision by bluewater 22/04/2009 1350hrs UTC -->
<div id="menu"><!-- menu starts here ja lang maintainer muchan-->
<!--sidux-manual Operating System Manual menu-version-02.05.2010.04.10 -->
<!-- menu last updated by bluewater 2010.04.10 1300 hrs UTC -->
	<div id="menu-header">
	      <a href="http://sidux.com/"><img src="../lib/logos/manual-sidux-logo.png" title="To sidux.com, Forum and Wiki" alt="logo" /></a>
	</div>
	<ul id="top-list">
		<li><a href="manual-search-ja.htm#search-on"><img src="../lib/logos/manual-search-22x22.png" title="Search Manual" alt="Search" /> サーチ Online Offline</a> </li>
		<li><a href="http://manual.sidux.com/meta-manual">Community Software Selections</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-lang-100x64.png" title="Choose another language" alt="lang-switch" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-ja.htm">sidux OSマニュアル</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-ja.htm#welcome-gen">sidux OSマニュアル</a></li>
				<li><a href="welcome-ja.htm#how-to">このマニュアルの使い方</a></li>
				<li><a href="welcome-ja.htm#table-contents">内容一覧</a></li>
				<li><a href="help-ja.htm#help-gen">困った時は...</a></li>
				<li><a href="help-ja.htm#paste">IRC !paste</a></li>
				<li><a href="credits-ja.htm#cred-team">siduxチーム</a></li>
				<li><a href="wel-quickstart-ja.htm#welcome-quick">sidux Quick Start Guide</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-dl-burning-ja.htm">ISO の内容、リリース、ダウンロードミラーとCDの焼き付け</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-ja.htm#cd-content">ISO の内容と最小限必要な仕様</a></li>
				<li><a href="sys-admin-release-ja.htm#rolling">ローリングノート</a></li>
				<li><a href="cd-dl-burning-ja.htm#download-sidux">siduxのミラー, ダウンロードとISOの作成</a></li>
				<li><a href="cd-dl-burning-ja.htm#md5">md5のチェックサム</a></li>
				<li><a href="cd-dl-burning-ja.htm#burn-nero">WindowsでISOを焼くには</a></li>
				<li><a href="cd-dl-burning-ja.htm#burn-linux">LinuxでISOを焼くには</a></li>
				<li><a href="cd-no-gui-burn-ja.htm#burning-no-gui">burniso スクリプト</a></li>
				<li><a href="cd-no-gui-burn-ja.htm#burn-no-gui-gen">GUIなしでISOを焼くには</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="live-mode-ja.htm">Live Mode</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="live-mode-ja.htm#rootpw">sidux-LiveISOのRootパスワード</a></li>
				<li><a href="live-mode-ja.htm#live-cd-installsoft">Live-ISO作動中にソフトをインストール</a></li>
				<li><a href="live-mode-ja.htm#ntfs-3g">ntfs-3gを使ってNTFSパーティションに書く</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="term-konsole-ja.htm">ターミナル/コンソール</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="term-konsole-ja.htm#sux">  sux / sudo</a></li>
				<li><a href="term-konsole-ja.htm#term-kon"> ターミナル/コンソール</a></li>
				<li><a href="term-konsole-ja.htm#cli-help">コマンドラインヘルプCommand Line Help</a></li>
				<li><a href="help-ja.htm#init3-tools">テキストモード(tty)で便利な道具 - init 3</a></li>
				<li><a href="term-konsole-ja.htm#term-cmds">Linuxターミナルのコマンド一覧</a></li>
				<li><a href="term-konsole-ja.htm#shell-scripts">Scripts.shのインストール</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="cheatcodes-ja.htm">チートコード</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="cheatcodes-ja.htm#cheatcodes">siduxだけのLive-ISO用チートコード</a></li>
				<li><a href="cheatcodes-ja.htm#cheatcodes-linux">Linux一般のチートコード</a></li>
				<li><a href="cheatcodes-vga-ja.htm#vga">VGAコード</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="part-gparted-ja.htm">ハードディスクのパーティショニング</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="part-gparted-ja.htm#partition">GPartedでHDをパーティショニング</a></li>
				<li><a href="part-gparted-ja.htm#ntfs">GPartedでNTFSパーティションのサイズ変更</a></li>
				<li><a href="part-uuid-ja.htm#uuid">UUID, パーティションのラベルとfstab</a></li>
				<li><a href="part-cfdisk-ja.htm#disknames">ディスクの名前について</a></li>
				<li><a href="part-cfdisk-ja.htm#partition">cfdiskでHDをパーティショニング</a></li>
				<li><a href="part-cfdisk-ja.htm#formating">cfdiskでパーティション後のフォーマッティング</a></li>
				<li><a href="part-size-examp-ja.htm#part-example">パーティションの例</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="hd-install-ja.htm">インストールオプション</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="hd-install-ja.htm#Inst-prep">インストールの準備</a></li>
				<li><a href="hd-install-ja.htm#Installation"> HDへのインストール</a></li>
				<li><a href="hd-install-ja.htm#first-hd-boot">初めての起動</a></li>
				<li><a href="hd-install-opts-ja.htm#fromiso">'fromiso'からの起動 - Overview</a></li>
				<li><a href="hd-install-opts-ja.htm#fromiso-grub-leg">古いGRUBから 'fromiso' で起動するには</a></li>
				<li><a href="hd-install-opts-ja.htm#grub2-fromiso">GRUB２ から 'fromiso' で起動するには</a></li>
				<li><a href="hd-install-opts-ja.htm#fromiso-persist">fromisoと持続モード</a></li>
				<li><a href="hd-install-opts-ja.htm#usb-hd">USB-HDへのインストール - sidux specific - sidux-on-stick</a></li>
				<li><a href="hd-ins-opts-oos-ja.htm#raw-usb">Writing sidux to a USB/SSD stick with any Linux, MS Windows or Mac OS X system</a></li>
				<li><a href="nbdboot-ja.htm#nbd1">ネットワークから sidux を起動する</a></li>
				<li><a href="hd-install-vmopts-ja.htm#vm">Virtual Machine installation options</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-ja.htm">グラフィックカード ハードウェアデバイスとドライバ  &amp; Xorg</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hw-dev-hw-dri-ja.htm#hd-ntfs3g">ntfs-3gを使ってNTFSパーティションに書く</a></li>
				<li><a href="hw-dev-mon-ja.htm#mon-res">モニターとスクリーンの解像度</a></li>
				<li><a href="hw-dev-mon-ja.htm#xrandr">デュアルモニターとxrandr</a></li>
				<li><a href="hw-dev-mon-ja.htm#mon-binary">デュアルモニター(バイナリー)</a></li>
				<li><a href="hw-dev-hw-dri-ja.htm#non-free-3d">Nvidiaと用のバイナリーnon-freeドライバー  &amp; xorg.conf</a></li>
				<li><a href="hw-dev-hw-dri-ja.htm#non-free-3d-2">ATI、Radeon その他の non-fre ドライバー</a></li>
				<li><a href="hw-dev-hw-dri-ja.htm#non-free-firmware">non-free のファームウェアが必要なハードウェア</a></li>
				<li><a href="hw-dev-hw-dri-ja.htm#non-free">non-free のレポジトリーを加える</a></li>
				<li><a href="hw-dev-hw-dri-ja.htm#native-nv-ati">nVidia, ATI, Radeon, Intel 用のFOSSドライバー &amp; xorg.conf</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="wm-kde-ja.htm">ウィンドウマネージャ</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="wm-xfce-ja.htm#xfce-notes">Useful Xfce extras</a></li>
				<li><a href="wm-kde-ja.htm#install-add">Useful extra KDE Apps</a></li>
				<li><a href="wm-kde-ja.htm#desk-freeze">デスクトップが反応しなくなった時は</a></li>
				<li><a href="wm-kde-ja.htm#kde-login">Cant login in KDEにログインできない時は</a></li>
				<li><a href="wm-kde-ja.htm#ch-th">Themesの変更</a></li>
				<li><a href="wm-kde-ja.htm#dm">ディスプレイマネージャー - dm</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="lamp-apache-ja.htm">siduxのLAMPセット</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="lamp-apache-ja.htm#serv-apache">siduxのLAMPセット</a></li>
				<li><a href="lamp-apache-ja.htm#serv-ftp">FTPクライアント</a></li>
				<li><a href="lamp-apache-ja.htm#serv-sec">セキュリティプロトコル</a></li>
				<li><a href="lamp-apache-ja.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-ja.htm#serv-mysql">MySQLの設定</a></li>
				<li><a href="lamp-ppp-ja.htm#serv-php">ApacheとPHP</a></li>
				<li><a href="ntp-server-ja.htm#ntp-server">タイムサーバーの設定</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="internet-connecting-ja.htm">インターネット/ネットワーク</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="tor-privoxy-ja.htm#tor">Tor</a></li>
				<li><a href="tor-privoxy-ja.htm#privoxy">Privoxy</a></li>
				<li><a href="internet-connecting-ja.htm#firewalls">Firewalls</a></li>
				<li><a href="samba-ja.htm#configure">SAMBAの環境設定 (Windowsとの接続)</a></li>
				<li><a href="samba-ja.htm#setup">SAMBAサーバーの設定</a></li>
				<li><a href="ssh-ja.htm#ssh-fs">SSH リモートマウント</a></li>
				<li><a href="ssh-ja.htm#ssh-x">SSHを通じてX Windowのアプリを</a></li>
				<li><a href="ssh-ja.htm#ssh-f">KonquerorでGUIのSSH</a></li>
				<li><a href="ssh-ja.htm#ssh-w">WindowsのPCからSSH X フォワーディング</a></li>
				<li><a href="ssh-ja.htm#ssh">SSHとセキュリティ</a></li>
				<li><a href="internet-connecting-ja.htm#dial-mod">56kモデム</a></li>
				<li><a href="inet-wpagui-ja.htm#wpa-roaming-gui">WiFi - WPA_GUI</a></li>
				<li><a href="inet-setup-ja.htm#net-set1">WiFi - Setting up for WiFi Roaming</a></li>
				<li><a href="internet-connecting-wpa-ja.htm#wpa">WiFi - wpasupplicant</a></li>
				<li><a href="inet-ifplug-ja.htm#hotswitch">Network switching between WiFi and Cable</a></li>
				<li><a href="internet-connecting-ja.htm#netcardconfig">インターネットに接続 -Ceni</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="sys-admin-apt-ja.htm">dist-upgrade とパッケージ管理</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="sys-admin-apt-ja.htm#apt-cook">APTの手引き、ソースリストについて</a></li>
				<li><a href="sys-admin-apt-ja.htm#apt-install">新しいパッケージのインストール</a></li>
				<li><a href="sys-admin-apt-ja.htm#apt-delete">パッケージの除去</a></li>
				<li><a href="sys-admin-apt-ja.htm#apt-downgrade">ダウングレードとホールド</a></li>
				<li><a href="sys-admin-apt-ja.htm#apt-cache">apt-cacheでパッケージをさがす</a></li>
				<li><a href="sys-admin-apt-ja.htm#gui-pacsea">GUI のパッケージ検索</a></li>
				<li><a href="sys-admin-upgrade-ja.htm#live-cd-upgrade">アップグレード用のLive- ISO</a></li>
				<li><a href="sys-admin-apt-locarmirr-ja.htm#approx">一つのLAN上のいくつかのPCを dist-upgrade する時</a></li>
				<li><a href="sys-admin-kern-upg-ja.htm#kern-upgrade">カーネルのアップグレード</a></li>
				<li><a href="sys-admin-kern-upg-ja.htm#dmakms">Installing kernel modules dynamically with dmakms</a></li>
				<li><a href="sys-admin-apt-ja.htm#apt-upgrade">システムのアップグレード -- dist-upgrade - Overview</a></li>
				<li><a href="sys-admin-apt-ja.htm#du-st">システムのアップグレード -- dist-upgrade - The Steps</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-gen-ja.htm">システムアドミン</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="hd-install-ja.htm#adduser">新しいユーザーを加える</a></li>
				<li><a href="home-ja.htm#home-bu"> /home の引越し</a></li>
				<li><a href="sys-admin-rdiff-ja.htm#rdiff">rdiffでバックアップ</a></li>
				<li><a href="sys-admin-rsync-ja.htm#rsync">rsyncでバックアップ</a></li>
				<li><a href="vir-rkits-ja.htm#virus-rkits">ウィルスとルートキットスキャナ</a></li>
				<li><a href="sys-admin-gen-ja.htm#start-services">サービスの自動スタート設定</a></li>
				<li><a href="sys-admin-gen-ja.htm#pw-lost">rootパスワードを忘れたら</a></li>
				<li><a href="sys-admin-gen-ja.htm#fonts">フォント</a></li>
				<li><a href="sys-admin-gen-ja.htm#cups">CUPS - Printing System</a></li>
				<li><a href="sys-admin-gen-ja.htm#sound">Sound Mixers</a></li>
				<li><a href="sys-admin-gen-ja.htm#init">siduxのランレベル - init</a></li>
				<li><a href="bios-freedos-ja.htm#bois-prep">FreeDOSでBIOSのアップグレード</a></li>
				<li><a href="sys-admin-grub-bootman2-ja.htm#boot-grub-floppy">ブート・フロッピーの作成</a></li>
				<li><a href="sys-admin-grub-bootman2-ja.htm#mbr-grub-boot">Grub1 - MBR ブートセクターへの上書き</a></li>
				<li><a href="sys-admin-grub-bootman2-ja.htm#dual-boot">Grub1 - デュアルブートまたはマルチブート</a></li>
				<li><a href="sys-admin-grub-bootman2-ja.htm#remove-grub">MBRからGRUBを消去する</a></li>
				<li><a href="sys-admin-grub-bootman2-ja.htm#what-is-grub">Grub - ブートマネージャ</a></li>
				<li><a href="sys-admin-grub2-ja.htm#mbr-over-grub2">Grub2 - MBR が上書きされた時</a></li>
				<li><a href="sys-admin-grub2-ja.htm#multi-os">Grub2 - マルチブーティング</a></li>
				<li><a href="sys-admin-grub2-ja.htm#grub1-grub2">Grub2 -Grub1からのアップデート</a></li>
				<li><a href="sys-admin-grub2-ja.htm#grub2">Grub2 - 概説</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
		<div class="divider" id="vmopts">
				<h2 id="top-header">Virtual Machine options</h2>

						<ul>
							<li><a href="hd-install-vmopts-ja.htm#kvm">KVM for Intel VT or AMD-V</a></li>
							<li><a href="hd-install-vmopts-ja.htm#vbox">Virtualbox</a></li>
							<li><a href="hd-install-vmopts-ja.htm#qemu">QEMU</a></li>

						</ul>
		      </div>
		      <div class="divider" id="kvm">
				<h2>Booting and installing sidux to a KVM Virtual Machine</h2>
							<p>KVM is full virtualisation solution for Linux on x86 hardware containing virtualisation extensions (Intel VT or AMD-V).</p>

				      <h3>Prerequisites</h3>

							<p>To ascertain whether your hardware supports KVM, ensure that KVM is enabled in the BIOS (in some cases on an Intel VT or AMD-V system it may not evident as to where the switch is, therefore assume that it is in a KVM state). The way to check is in a console run:</p>
<pre>
cat /proc/cpuinfo | egrep --color=always 'vmx|smx'
</pre>
							<p>If you see <span class="highlight-3">smx</span> or <span class="highlight-3">vmx</span> in the cpu flags field, your system supports KVM. (Otherwise go back to the BIOS if you believe it is supported and check again, else search the internet as to where in the BIOS menus KVM 'enable' could be hiding).</p>

							<p>Should your BIOS not support KVM refer to <a href="hd-install-vmopts-ja.htm#vbox">Virtualbox</a>
							 or <a href="hd-install-vmopts-ja.htm#qemu">QEMU</a></p>

							<p>To install and run KVM, firstly ensure that Virtualbox modules are not loaded, (--purge them is the best option), then depending on your chipset:</p>

							<p>For <span class="highlight-3">vmx</span>:</p>
<pre>
apt-get install qemu-kvm
modprobe kvm_intel
</pre>
							<p>For <span class="highlight-3">smx</span>:</p>
<pre>
apt-get install qemu-kvm
modprobe kvm_amd
</pre>
							 <p>Another option is reboot as the qemu-kvm initscripts will take care of loading the modules.</p>

					  <h4>Using KVM to boot a sidux-*.iso</h4>

							<p><span class="highlight-2">As user:</span></p>
<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -cdrom &lt;sidux.iso&gt;
</pre>

				<h5>Installing a sidux-*.iso to a KVM image</h5>
							<p>First create a hard disk image, (this image will be minimal and only grow as required due to qcow2 compression ratios):</p>
<pre>
$ qemu-img create -f qcow2 sidux-2010-*-.img 12G
</pre>

							<p>Boot the sidux-*.iso with the following parameters to enable KVM to recognise that there is an QEMU hard disk image available:</p>
<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -cdrom &lt;/path/to/sidux.iso&gt; -boot d &lt;/path/to/sidux-20xx-*-.img&gt;
</pre>

							<p>Once the cdrom has booted up click on the sidux installer icon to activate the installer, (or use the menu), click on the Partitioning tab and you should see on the left hand side a box that has a disk ready for partitioning and formatting, most likely noted as <span class="highlight-3"> /dev/sda</span>. Underneath that are the options for partitioning, choose gparted.</p>

	<div class="screenshot"><img src="../lib/images-common/images-vm/kvm-gparted02.png" title="gparted kvm hard disk naming" alt="gparted kvm hard disk naming" /></div>
	<div class="spacer02"></div>

							<p>In the Gparted menu you can confirm that Gparted sees the image with <span class="highlight-3">View>Device Information</span> which should state it is a <span class="highlight-3">ATA QEMU Harddisk</span> and most likely noted as <span class="highlight-3"> /dev/sda</span>,(in this example), as this will be crucial when moving back to the installer and choosing where to put Grub, as it needs to go to <span class="highlight-3"> /dev/sda</span>.</p>

							<p>Next, in the <span class="highlight-3">Partition</span> menu choose <span class="highlight-3"> Device>Create Partiton Table</span> and create the partition table. </p>

							<p>Then format the partition table with ext4 and also include a swap of 2 gig. The formatting will take time so be patient.</p>

							<p>After formatting has completed, click OK to be returned to the installer and proceed as if you are performing a standard install, (again, be patient). <span class="highlight-2">Note: Install the Grub to /dev/sda</span>.</p>

							<p>You now have a sidux-*-VM ready for use:</p>

<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -drive if=virtio,boot=on,file=&lt;absolute/path/to/sidux-20xx-*.img&gt;
</pre>

							<p>If the guest does not support virtio, or you do not specify an absolute path,  use:</p>
<pre>
$ kvm -net nic,model=virtio -net user -soundhw ac97 -m 512 -monitor stdio -hda &lt;/path/to/sidux-20xx-*.img&gt;
</pre>
							<p>See also:</p>
<pre>
$ man kvm
</pre>
				<h5>Managing your KVM virtual machine installations</h5>
<pre>
apt-get install aqemu
</pre>
							<p>When using AQEMU ensure that you choose the KVM mode from the drop down box for 'Emulator Type' in the 'General' tab. (Documentation for AQEMU is basically non existent, therefore a few 'trials by error' will be required to figure out the easy to use GUI, however a good start is to use first use the 'VM' menu followed by the 'General' tab.</p>

	</div>
	<div class="divider" id="vbox">
		<h2>Booting and installing sidux to a VirtualBox Virtual Machine</h2>
							<!--- ####
							<p>The Steps:.</p>
							#### -->
							<p>The Steps:</p>
						<ul>
								<!--- ####
 							<li>1. create a harddiskimage for VirtualBox</li>
								#### -->
 							<li>1. VirtualBox用のハードディスクイメージを作ります。</li>
								<!--- ####
 							<li>2. boot the iso with VirtualBox</li>
								#### -->
 							<li>2. VirtualBoxをISOファイルから起動します。</li>
								<!--- ####
 							<li>3. install on the image</li>
								#### -->
 							<li>3. ハードディスクイメージにインストールします。</li>
						</ul>

				<!--- ####
				<h4>Requirements</h4>
				#### -->
				<h4>最低限必要な条件</h4>
							<!--- ####
							<p><span class="highlight-3">Recommended ram: 1 gig </span>: Ideally 512 MB for the guest and 512 MB for the host. (it can be run on less, but do not expect to have good performance).</p>
							#### -->
							<p><span class="highlight-3">RAMのサイズ: 1GB(推奨) </span>: 理想的にはホストに512MBとゲストに512 MB。 (それ以下のRAMでも使えますが、あまり良いパフォーマンスは期待できません)。</p>

							<!--- ####
							<p><span class="highlight-3">Hard disk space:</span> While VirtualBox itself is very lean (a typical installation will only need about 30 MB of hard disk space), the virtual machines will require fairly huge files on disk to represent their own hard disk storage. So, to install MS Windows XP (TM), for example, you will need a file that will easily grow to several GB in size. To have sidux in VirtualBox you need to allocate a 5 gig image plus a swap allocation.</p>
							#### -->
							<p><span class="highlight-3">ハードディスクスペース:</span> VirtualBoxそのものはとても小さいプログラムです(普通にインストールすれば30MB程度のスペースしか使いません)が、バーチャルマシンはハードディスクの代わりとしてディスク上にかなり大きいファイルを必要とします。 そのため、例えばMS Windows XP(TM)をインストールするには何GBものスペースが必要になるでしょう。 siduxをVirtualBoxのゲストOSとして使うのには５GBのイメージとスワップスペースがあればいいでしょう。</p>

				<h3>Installation:</h3>

<pre>
apt-get update
apt-get install virtualbox-ose-qt virtualbox-ose-source dmakms module-assistant
</pre>
							<p>Then prepare the module:</p>
<pre>
m-a prepare
m-a a-i virtualbox-ose-source
</pre>
							<p>Then activate Dynamic Module-Assistant Kernel Module Support for virtualbox, so that the next time the Linux kernel is updated a virtualbox module is prepared for it too, without manual intervention. To do that, add <span class="highlight-3">virtualbox-ose-source</span> to the <span class="highlight-3">/etc/default/dmakms </span>configuration file. </p>
<pre>
mcedit /etc/default/dmakms
virtualbox-ose-source
</pre>

							<p>Then reboot the computer.</p>

							<p><a href="sys-admin-kern-upg-ja.htm#dmakms">This is essential reading on dmakms</a></p>

					<!--- ####
					<h3>Installing sidux to the virtual machine</h3>
					#### -->
					<h3>siduxをバーチャルマシンにインストールする</h3>
							<!--- ####
							<p>Use virtualbox's wizard to create a new virtual machine for sidux. then follow the instructions for a regular sidux-installation.</p>
							#### -->
							<p>VirtualBoxのウィザードを使ってsiduxが使うバーチャルマシンを作り、続いて通常のsiduxのインストールの手順を踏みます。</p>

							<!--- ####
							<p><a href="http://www.virtualbox.org/">VirtualBox has a comprehesive PDF Help, that you can download</a> </p>
							#### -->
							<p><a href="http://www.virtualbox.org/">VirtualBoxにはダウンロードできる詳しいヘルプPDFがあります</a> </p>

	</div>
	<div class="divider" id="qemu">
		<!--- ####
		<h2>Booting and installing sidux to a QEMU Virtual Machine</h2>
		#### -->
		<h2>Booting and installing sidux to a QEMU Virtual Machine</h2>

		<ul>
				<!--- ####
 			<li>1. create a harddiskimage for QEMU</li>
				#### -->
 			<li>1. QEMUのためのハードディスクイメージを作る。</li>
				<!--- ####
 			<li>2. boot the iso with QEMU</li>
				#### -->
 			<li>2. QEMUをISOから起動する。</li>
				<!--- ####
 			<li>3. install on the image</li>
				#### -->
 			<li>3. ハードディスクイメージにインストールする。</li>
		</ul>

							<p>A QT GUI tool is available to help you configure QEMU:</p>
<pre>
apt-get install qtemu
</pre>

 				<!--- ####
 			<h4>Creating the hard disk image</h4>
				#### -->
 			<h4>ハードディスクイメージを作る</h4>

				<!--- ####
				<p>To run qemu you will probably need a hard disk image. This is a file which stores the contents of the emulated hard disk.</p>
				#### -->
				<p>QEMUを使うためにはハードディスクイメージを作る必要があります。 このファイルをハードディスクの代わりとしてバーチャルマシンのファイルを保存するために使います。</p>

				<!--- ####
				<p>Use the command:</p>
				#### -->
				<p>そのためには:</p>
<pre>
qemu-img create -f qcow sidux.qcow 3G
</pre>
				<!--- ####
				<p>To create the image file named "sidux.qcow". The "3G" parameter specifies the size of the disk - in this case 3 GB. You can use suffix M for megabytes (for example "256M"). You shouldn't worry too much about the size of the disk - the qcow format compresses the image so that the empty space doesn't add up to the size of the file.</p>
				#### -->
				<p>このコマンドで"sidux.qcow"という名のイメージファイルtを作ります。 "3G"というパラメータはディスクのサイズ-この場合３GBを指定しています。 Mを使えばメガバイトの表示も使えます(例、"256M"とかけば256MB) あまりイメージサイズを気にすることはありません。 qcowフォーマットはイメージを圧縮するため空白のスペースのためにファイルが大きくなってしまうことはありません。</p>

			<!--- ####
			<h4>Installing the operating system</h4>
			#### -->
			<h4>オペレーションシステムのインストール</h4>

				<!--- ####
				<p>This is the first time you will need to start the emulator. <span class="highlight-3">One thing to keep in mind: when you click inside qemu window, the mouse pointer is grabbed. To release it press :</span></p>
				#### -->
				<p>初めてエミュレータを使うとき<span class="highlight-3">注意すべきこと: 一度QEMUのウィンドウの中をクリックするとマウスはバーチャルマシンに捕まります。 これを解放するには:</span></p>

<pre>
Ctrl+Alt
</pre>

				<!--- ####
				<p>If you need to use a bootable floppy, run Qemu with:</p>
				#### -->
				<p>起動フロッピーが必要ならばQEMUを次のコマンドで起動します:</p>
<pre>
qemu -floppy sidux.iso -net nic -net user -m 512 -boot d sidux.qcow
</pre>
				<!--- ####
				<p>If your CD-ROM is bootable, run Qemu with:</p>
				#### -->
				<p>CD-ROMから起動できる場合はQEMUを次のコマンドで起動します:</p>
<pre>
qemu -cdrom sidux.iso -net nic -net user -m 512 -boot d sidux.qcow
</pre>
				<!--- ####
				<p>Now install sidux as if you were going to install it on a real HD</p>
				#### -->
				<p>siduxを本物のハードディスクへの場合と同じ用にインストールします</p>


			<h4>システムの作動</h4>

				<p>システムを作動するには単純に:</p>
<pre>
qemu [hd_image]
</pre>
				<!--- ####
				<p>A good idea is to use overlay images. This way you can create hard disk image once and tell Qemu to store changes in external file. You get rid of all the instability, because it is so easy to revert to previous system state.</p>
				#### -->
				<p>オーバーレイイメージを使ってみるのもいい考えです。 この方法だと一度ハードディスクイメージを作って、その後の変化は外部のファイルに保存します。 何か問題が起こったとき簡単に以前の状態に戻せるため安定して使うことができます。</p>

				<!--- ####
				<p>To create an overlay image, type:</p>
				#### -->
				<p>オーバーレイイメージを作るには:</p>
<pre>
qemu-img create -b [[base''image]] -f qcow [[overlay''image]]
</pre>
				<!--- ####
				<p>Substitute the hard disk image for base_image (in our case sidux.qcow). After that you can run qemu with:</p>
				#### -->
				<p>ハードディスクイメージをベースイメージ(ここではsidux.qcow)と取り替えます。 これから先はQEMUをスタートするのに:</p>
<pre>
qemu [overlay_image]
</pre>
				<p>のコマンドを使います。</p>
				<!--- ####
				<p>The original image will be left untouched. One hitch, the base image cannot be renamed or moved, the overlay remembers the base's full path.</p>
				#### -->
				<p>もとのイメージはそのまま手をつけずに保存されます。 このベースイメージの名前と場所はオーバーレイに記憶されるので、けっして変更してはいけません。</p>


			<!--- ####
			<h4>Using any real partition as the single primary partition of a hard disk image</h4>
			#### -->
			<h4>本当のパーティションをハードディスクイメージのプライマリパーティションとして使う</h4>

				<!--- ####
				<p>Sometimes, you may wish to use one of your system partition from within qemu (for instance, if you wish booting both your real machine or qemu using a given partition as root). You can do this using software RAID in linear mode (you need the linear.ko kernel driver) and a loopback device: the trick is to dynamically prepend a master boot record (MBR) to the real partition you wish to embed in a qemu raw disk image.</p>
				#### -->
				<p>時にはシステムパーティションの一つをQEMUの内部から使いたいことがあります。 (同じパーティションをルートとして実際に起動したりQEMUから起動したりしたい場合など)。 ソウトウェアRAIDをリニアモードで使い(そのためにはカーネルモジュールlinear.koが必要です)合わせてループバックデバイスを使うことで実現できます: QEMUのディスクイメージに埋め込みたい本物のパーティションの先頭にマスターブートレコード(MBR)をダイナミックに差し込むのがトリックです。</p>

				<!--- ####
				<p>Suppose you have a plain, unmounted /dev/sdaN partition with some filesystem on it you wish to make part of a qemu disk image. First, you create some small file to hold the MBR:</p>
				#### -->
				<p>仮にまだマウントされていないパーティション /dev/sdaN があって、何らかのファイルシステムにフォーマットされていて、これをQEMUのディスクイメージの一部に取り込みたいとします。 まず、MBRを保持する小さいファイルを作ります:</p>
<pre>
dd if=/dev/zero of=/path/to/mbr count=32
</pre>
				<!--- ####
				<p>Here, a 16 KB (32 * 512 bytes) file is created. It is important not to make it too small (even if the MBR only needs a single 512 bytes block), since the smaller it will be, the smaller the chunk size of the software RAID device will have to be, which could have an impact on performance. Then, you setup a loopback device to the MBR file:</p>
				#### -->
				<p>これで16 KB(32x512バイ)のファイルが作られました。 (MBRが必要なのは512バイトブロックが一つだけではあるけれど)このファイルのサイズが小さすぎないことが大切です。 あまり小さいとソフトウェアRAIDデバイスのチャンクサイズも小さくなってしまい、パフォーマンスに影響がでます。 ではMBRファイルのループバックデバイスを設定します:</p>
<pre>
losetup -f /path/to/mbr
</pre>
				<!--- ####
				<p>Let's assume the resulting device is /dev/loop0, because we wouldn't already have been using other loopbacks. Next step is to create the "merged" MBR + /dev/sdaN disk image using software RAID:</p>
				#### -->
				<p>すでにループデバイスが存在するとは限らないので仮にこれから作るループデバイスを /dev/loop0 としましょう。 次のステップはソフトウェアRAIDを使ってMBRとディスクイメージ/dev/sdaNを合併することです:</p>
<pre>
 modprobe linear
 mdadm --build --verbose /dev/md0 --chunk=16 --level=linear --raid-devices=2 /dev/loop0 /dev/sdaN
</pre>
				<!--- ####
				<p>The resulting /dev/md0 is what you will use as a qemu raw disk image (don't forget to set the permissions so that the emulator can access it). The last (and somewhat tricky) step is to set the disk configuration (disk geometry and partitions table) so that the primary partition start point in the MBR matches the one of /dev/sdaN inside /dev/md0 (an offset of exactly 16 * 512 = 16384 bytes in this example). Do this using fdisk on the host machine, not in the emulator: the default raw disc detection routine from qemu often results in non kilobyte-roundable offsets (such as 31.5 KB, as in the previous section) that cannot be managed by the software RAID code. Hence, from the the host:</p>
				#### -->
				<p>こうして作られた /dev/md0 をQEMUのディスクイメージファイルとして使います。 (エミュレータがアクセスで切るようにパーミッションを設定するのを忘れないように)。 最後の(一番トリッキーな)ステップはディスク設定(ディスクの形状とパーティションテーブル)においてMBRのプライマリパーティションのスタートポイントが /dev/md0 のなかの /dev/sdaN のポイントと一致するように(この例ではオフセットが16 x 512 = 16384バイトちょうどになるように)設定することです。 この作業はエミュレータの中では行わず、ホストマシーンの上でfdiskを使って行いましょう。 QEMUのデフォルトのロウディスク認識ルーチンはしばしばキロバイトで割り切れないオフセット(上の例だと31.5Kb)を出力するため、ソフトウェアRAIDコードでは扱えません。 だからホスト上で行います:</p>
<pre>
 fdisk /dev/md0
</pre>
				<!--- ####
				<p>There, create a single primary partition corresponding to /dev/sdaN, and play with the 's'ector command from the 'x'pert menu until the first cylinder (where the first partition starts), matches to the size of the MBR. Finally, 'w'rite the result to the file: you are done. You know have a partition you can mount directly from your host, as well as part of a qemu disk image:</p>
				#### -->
				<p>このプラグラムで /dev/sdaN に対応する単一のプライマリパーティションを作成し、XpertメニューのSectorコマンドを試しながら最初のシリンダ(初めのセクターが始まるところ)ばMBRのサイズと一致する設定を探し、Writeコマンドで結果を書き込んで終わりです。 これでこのパーティションをホストからでもQEMUのディスクイメージの一部としてでも使えるようになりました:</p>
<pre>
 qemu -hdc /dev/md0 [...]
</pre>
				<!--- ####
				<p>You can of course safely set any bootloader on this disk image using qemu, provided the original /boot/sdaN partition contains the necessary tools.</p>
				#### -->
				<p>もちろんこのディスクイメージにQEMUを使って(元の/boot/sdaNパーティションに必要なツールさえあれば)どんなブートローダでも設定できます。</p>


			<!--- ####
			<h4>Using the QEMU Accelerator Module</h4>
			#### -->
			<h4>QEMUのアクセレータモジュールを使う</h4>

				<!--- ####
				<p>The developers of qemu have created an optional kernel module to accelerate qemu to sometimes near native levels. This should be loaded with the option</p>
				#### -->
				<p>QEMUの開発者はQEMUを時にはネイティブに近い早さまで加速する追加のカーネルモジュールを作っています。 これをロードするには:</p>
<pre>
major=0
</pre>
				<!--- ####
				<p>to automate the creation of the required /dev/kqemu device. The following command</p>
				#### -->
				<p>必要な/dev/kqemuデバイスを自動的につくるには:</p>
<pre>
echo "options kqemu major=0" >> /etc/modprobe.conf
</pre>
				<!--- ####
				<p>This will amend modprobe.conf to ensure that the module option is added every time the module is loaded.</p>
				#### -->
				<p>このコマンドでmodprobe.confを修正して、モジュールがロードされる度にこのオプションが追加されるように設定されます。</p>

<pre>
qemu [...] -kernel-kqemu
</pre>
				<!--- ####
				<p>This enables full virtualization and thus improves speed considerably.</p>
				#### -->
				<p>これで最大限のバーチャリゼイションになりスピードがかなり早くなります。</p>

			<!--- ####
			<h4>To activate qemu:</h4>
			#### -->
			<h4>qemuをアクティブにするには:</h4>
<pre>
qemu -cdrom /tmp/pkg/sidux-debug.iso -net nic -net user -m 512
</pre>
		<!--- ####
		<p><a href="http://fabrice.bellard.free.fr/qemu/qemu-doc.html">QEMU Project </a> </p>
		#### -->
		<p><a href="http://www.nongnu.org/qemu/user-doc.html">QEMUプロジェクトの公式ドキュメント </a> </p>
		<!--- ####
		<p><a href="http://wiki2.archlinux.org/index.php/Qemu">Some content for QEMU for the sidux-manual was accessed off this site under GNU Free Documentation License 1.2 and modified for the sidux-manual</a> </p>
		#### -->
		<p><a href="http://wiki.archlinux.org/index.php/Qemu">QEMUについての内容の一部はこのサイトからGNU Free Documentation License 1.2に基づいて取得されsidux-manual用に変更されています</a> </p>


	</div>
	<div id="rev">Page last revised 13/04/2010 1450 UTC</div>

</div>
</body>
</html>
