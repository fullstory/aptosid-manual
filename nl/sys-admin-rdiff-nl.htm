<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="nl">
<head>
	<title>aptosid Manuals - rdiff</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<div id="menu"> <!-- menu starts here nl lang maintained by eislon -->
<!--aptosid Operating System Manual menu-version-02.09.2010.11.03 -->
<!-- menu last updated by bluewater 2010.11.03 1130 hrs UTC -->
	<div id="menu-header">
	      <a href="http://aptosid.com/"><img src="../lib/logos/manual-aptosid-logo.png" title="Naar aptosid.com forums and wiki" alt="aptosid.com logo" /></a>
	</div>
	<ul id="top-list">
		<li><a href="manual-search-nl.htm#search-on"> <img src="../lib/logos/manual-search-22x22.png" title="Search Manual" alt="Search" />Zoeken Online Offline</a> </li>
		<!--<li><a href="http://manual.aptosid.com/meta-manual">Gemeenschap Software Selecties</a></li>-->
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/aptosid-lang-100x64.png" title="Kies een andere taal - Choose another language" alt="lang-switch" /></a>
	</div>
	<ul>
<li onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-nl.htm">aptosid OS Manual</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-nl.htm#welcome-gen">aptosid OS Manual &#8658;</a>
					<ul class="sub2-menu" id="sm1a">
					  <li><a href="credits-nl.htm#cred-team">Credits</a></li>
					</ul>
					</li>
		<li><a href="welcome-nl.htm#how-to">How to use this manual &#8658;</a>
					<ul class="sub2-menu" id="sm1b">
					  <li><a href="welcome-nl.htm#how-to">How to use this manual</a></li>
					  <li><a href="welcome-nl.htm#table-contents">Table of Contents</a></li>
					</ul>
					</li>
		<li><a href="help-nl.htm#help-gen">Getting Help &#8658;</a>
					<ul class="sub2-menu" id="sm1c">
					  <li><a href="help-nl.htm#help-gen">Where and how to get help</a></li>
					  <li><a href="help-nl.htm#paste">IRC !paste</a></li>
					</ul>
					</li>
		<li><a href="wel-quickstart-nl.htm#welcome-quick">aptosid Quick Start Guide</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-dl-burning-nl.htm">ISO Content, Releases, Download Mirrors and Burning</a>
			   <ul class="sub-menu" id="sm2">
				<li><a href="cd-content-nl.htm#cd-content">ISO Content and system requirements &#8658;</a>
					<ul class="sub2-menu" id="sm2a">
					  <li><a href="sys-admin-release-nl.htm#rolling">Release Notes</a></li>
					</ul>
					</li>
		    <li><a href="cd-dl-burning-nl.htm#download-aptosid">aptosid Mirrors, Downloading and Burning &#8658;</a>
				<ul class="sub2-menu" id="sm2b">
					  <li><a href="cd-dl-burning-nl.htm#md5">md5 Checksum</a></li>
					  <li><a href="cd-dl-burning-nl.htm#burn-nero">Burning in Windows</a></li>
					  <li><a href="cd-dl-burning-nl.htm#burn-linux">Burning in Linux</a></li>
					  <li><a href="cd-no-gui-burn-nl.htm#burning-no-gui">burniso script</a></li>
					  <li><a href="cd-no-gui-burn-nl.htm#burn-no-gui-gen">Burning without a GUI</a></li><li><a href="cd-dl-burning-nl.htm#download-aptosid">aptosid Download Mirrors</a></li>
					</ul>
					</li>
		      </ul>
		</li>
<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="live-mode-nl.htm">Live Mode</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="live-mode-nl.htm#rootpw">Root-password on the aptosid-Live ISO</a></li>
				<li><a href="live-mode-nl.htm#live-cd-installsoft">Installing software whilst on a Live-ISO</a></li>
			</ul>
		</li>
<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="term-konsole-nl.htm">The Terminal / Konsole</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="term-konsole-nl.htm#term-kon"> Terminal / Konsole &#8658;</a>
					<ul class="sub2-menu" id="sm4a">
					  <li><a href="term-konsole-nl.htm#term-kon"> Terminal / Konsole</a></li>
					  <li><a href="term-konsole-nl.htm#cli-help">Command Line Help</a></li>
					  <li><a href="help-nl.htm#init3-tools">Tools to know in text mode (tty) - init 3</a></li>
					  <li><a href="term-konsole-nl.htm#term-cmds">Linux Terminal Commands List</a></li>
					</ul>
					</li>
			  <li><a href="term-konsole-nl.htm#sux"> sux / sudo</a></li>
		    </ul>
		</li>
<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="cheatcodes-nl.htm">CheatCodes</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="cheatcodes-nl.htm#cheatcodes">aptosid specific Live-ISO Cheatcodes</a></li>
				<li><a href="cheatcodes-nl.htm#cheatcodes-linux">Linux generic Cheatcodes</a></li>
				<li><a href="cheatcodes-vga-nl.htm#vga">VGA Codes</a></li>
			</ul>
		</li>
<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="part-gparted-nl.htm">Partitioning Your Hard Drive</a>
		<ul class="sub-menu" id="sm6">
			<li><a href="part-gparted-nl.htm#hd-ntfs3g">Writing on NTFS partitions with ntfs-3g</a></li>
			<li><a href="part-lvm-nl.htm#part-lvm">Partitioning to use LVM - Logical Volume Manager</a></li>
			<li><a href="part-gparted-nl.htm#partition">Partitioning with a GUI &#8658;</a>
					<ul class="sub2-menu" id="sm6a">
					  <li><a href="part-gparted-nl.htm#partition">Partitioning your HD using GParted / KDE Partition Manager</a></li>
					  <li><a href="part-gparted-nl.htm#ntfs">NTFS partition Resizing using GParted / KDE Partition Manager</a></li>
					</ul>
					</li>
		<li><a href="part-cfdisk-nl.htm#partition">Partitioning with CLI &#8658;</a>
					 <ul class="sub2-menu" id="sm6b">
					    <li><a href="part-cfdisk-nl.htm#partition">Partitioning  your HD using cfdisk</a></li>
					    <li><a href="part-cfdisk-nl.htm#formating">Formatting after partitioning with cfdisk</a></li>
					</ul>
					</li>
		<li><a href="part-size-examp-nl.htm#part-example">Partitioning Basics &#8658;</a>
					<ul class="sub2-menu" id="sm6c">
					  <li><a href="part-size-examp-nl.htm#part-example">Partition Size Examples</a></li>
					  <li><a href="part-uuid-nl.htm#uuid">UUID, Partition Labelling and fstab</a></li>
					  <li><a href="part-cfdisk-nl.htm#disknames">Disk Naming in brief</a></li>
					</ul>
					</li>
		      </ul>
		</li>
<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="hd-install-nl.htm">Installation options - HD, USB, VM and Cryptroot</a>
		<ul class="sub-menu" id="sm7">
		  <li><a href="hd-install-nl.htm#Inst-prep">Install Preparation &#8658;</a>
					<ul class="sub2-menu" id="sm7a">
					  <li><a href="hd-install-nl.htm#Inst-prep">Install Preparation </a></li>
					  <li><a href="hd-install-nl.htm#Installation">Installing to your HD</a></li>
					  <li><a href="hd-install-nl.htm#first-hd-boot">First Boot Up</a></li>
					</ul>
					</li>
		<li><a href="hd-install-opts-nl.htm#fromiso">Booting fromiso &#8658;</a>
					<ul class="sub2-menu" id="sm7b">
					  <li><a href="hd-install-opts-nl.htm#fromiso">Booting fromiso - Overview</a></li>
					  <li><a href="hd-install-opts-nl.htm#fromiso-grub-leg">Booting 'fromiso' with grub-legacy</a></li>
					  <li><a href="hd-install-opts-nl.htm#grub2-fromiso">Booting 'fromiso' with Grub 2</a></li>
					  <li><a href="hd-install-opts-nl.htm#fromiso-persist">fromiso and persist</a></li>
					</ul>
					</li>
		<li><a href="hd-install-opts-nl.htm#usb-hd">Installing to USB drives &#8658;</a>
					<ul class="sub2-menu" id="sm7c">
					  <li><a href="hd-install-opts-nl.htm#usb-hd">Installing on a USB-HD - aptosid specific - aptosid-on-stick</a></li>
					  <li><a href="hd-ins-opts-oos-nl.htm#raw-usb">Writing aptosid to a USB/SSD stick with any Linux, MS Windows or Mac OS X system</a></li>
					</ul>
					</li>
		  <li><a href="hd-install-crypt-nl.htm#install-crypt">Installing to encryted partitions - cryptroot</a></li>
		  <li><a href="nbdboot-nl.htm#nbd1">Booting aptosid over a network</a></li>
		  <li><a href="hd-install-vmopts-nl.htm#vmopts">Virtual Machine installation options</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-nl.htm">Graphic Cards, Monitors, Xorg &amp; Miscellaneous Drivers</a>
	<ul class="sub-menu" id="sm8">
		<li><a href="hw-dev-mon-nl.htm#mon-res">Screen Resolution and Monitors  &#8658;</a>
					<ul class="sub2-menu" id="sm8a">
					  <li><a href="hw-dev-mon-nl.htm#mon-res">Screen Resolution and Monitors</a></li>
					  <li><a href="hw-dev-mon-nl.htm#xrandr">Dual Monitors and xrandr</a></li>
					  <li><a href="hw-dev-mon-nl.htm#mon-binary">Dual Monitors (using binaries)</a></li>
					</ul>
					</li>
		<li><a href="hw-dev-hw-dri-nl.htm#non-free-3d">Graphic card proprietry drivers &#8658;</a>
					<ul class="sub2-menu" id="sm8b">
					  <li><a href="hw-dev-hw-dri-nl.htm#non-free-3d">Binary, non-free drivers for Nvidia &amp; xorg.conf</a></li>
					  <li><a href="hw-dev-hw-dri-nl.htm#non-free-3d-2">non-free drivers for ATI, Radeon and others</a></li>
					</ul>
					</li>
			  <li><a href="hw-dev-hw-dri-nl.htm#non-free-firmware">Hardware needing non-free firmware drivers</a></li>
			  <li><a href="hw-dev-hw-dri-nl.htm#non-free">Adding non-free to Sources List</a></li>
			  <li><a href="hw-dev-hw-dri-nl.htm#native-nv-ati">FOSS xorg drivers for nVidia, ATI, Radeon, Intel &amp; xorg.conf</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="wm-kde-nl.htm">Window Managers</a>
		    <ul class="sub-menu" id="sm9">
			  <li><a href="wm-kde-nl.htm">Window Managers &#8658;</a>
					  <ul class="sub2-menu" id="sm9a">
					    <li><a href="wm-xfce-nl.htm#xfce-notes">Useful Xfce extras</a></li>
					    <li><a href="wm-kde-nl.htm#install-add">Useful extra KDE Apps</a></li>
					    <li><a href="wm-kde-nl.htm#desk-freeze">Desktop Freezes</a></li>
					    <li><a href="wm-kde-nl.htm#kde-login">Cant login in KDE</a></li>
					    <li><a href="wm-kde-nl.htm#ch-th">Changing Themes</a></li>
					</ul>
					</li>
		      <li><a href="wm-kde-nl.htm#dm">Display Managers - dm</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="internet-connecting-nl.htm">Internet connecting, WiFi, LAN and Networks</a>
		    <ul class="sub-menu" id="sm11">
			<li><a href="lamp-apache-nl.htm">aptosid LAMP Stack &#8658;</a>
					<ul class="sub2-menu" id="sm11a">
					    <li><a href="lamp-apache-nl.htm#serv-apache">aptosid LAMP Stack</a></li>
					    <li><a href="lamp-apache-nl.htm#serv-ftp">FTP Clients</a></li>
					    <li><a href="lamp-apache-nl.htm#serv-sec">Security Protocols</a></li>
					    <li><a href="lamp-apache-nl.htm#serv-ssl">SSL</a></li>
					    <li><a href="lamp-sql-nl.htm#serv-mysql">MySQL Setup</a></li>
					    <li><a href="lamp-ppp-nl.htm#serv-php">PHP in Apache</a></li>
					    <li><a href="ntp-server-nl.htm#ntp-server">Timeserver Setup</a></li>
					</ul>
					</li>
		<li><a href="tor-privoxy-nl.htm#tor">Firewalls and Privacy &#8658;</a>
					<ul class="sub2-menu" id="sm11b">
					    <li><a href="tor-privoxy-nl.htm#tor">Tor</a></li>
					    <li><a href="tor-privoxy-nl.htm#privoxy">Privoxy</a></li>
					    <li><a href="internet-connecting-nl.htm#firewalls">Firewalls</a></li>
					</ul>
					</li>
		<li><a href="ssh-nl.htm#ssh-x">SSH and Samba &#8658;</a>
					<ul class="sub2-menu" id="sm11c">
						  <li><a href="samba-nl.htm#setup">Samba-Server Setup</a></li>
						  <li><a href="samba-nl.htm#configure">Configuring SAMBA (Windows)</a></li>
						  <li><a href="ssh-nl.htm#ssh-fs">SSH Remote Mounting</a></li>
						  <li><a href="ssh-nl.htm#ssh-x">X Window Apps via SSH</a></li>
						  <li><a href="ssh-nl.htm#ssh-f">GUI SSH with Konqueror</a></li>
						  <li><a href="ssh-nl.htm#ssh-w">SSH X-Forwarding from Windows-PC</a></li>
						  <li><a href="ssh-nl.htm#ssh">SSH and Security</a></li>
					</ul>
					</li>
		<li><a href="internet-connecting-nl.htm#netcardconfig">WIFI connections &#8658;</a>
						<ul class="sub2-menu" id="sm11d">
						    <li><a href="internet-connecting-nl.htm#netcardconfig">Getting Online - Ceni</a></li>
						    <li><a href="inet-wpagui-nl.htm#wpa-roaming-gui">WiFi - WPA_GUI</a></li>
						    <li><a href="inet-setup-nl.htm#net-set1">WiFi - Setting up for WiFi Roaming</a></li>
						    <li><a href="internet-connecting-wpa-nl.htm#wpa">WiFi - wpasupplicant</a></li>
						    <li><a href="inet-ifplug-nl.htm#hotswitch">Network switching between WiFi and Cable</a></li>
					</ul>
					</li>
		<li><a href="internet-connecting-nl.htm#netcardconfig">Wired Connections &#8658;</a>
						<ul class="sub2-menu" id="sm11e">
						    <li><a href="internet-connecting-nl.htm#dial-mod">56k Modems</a></li>
						    <li><a href="internet-connecting-nl.htm#netcardconfig">Getting Online - Ceni</a></li>
					</ul>
					</li>
				</ul>
			    </li>
<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="sys-admin-apt-nl.htm">Package Management and dist-upgrade</a>
	<ul class="sub-menu" id="sm12">
		<li><a href="sys-admin-apt-nl.htm#apt-cook">APT Cookbook and Sources list &#8658;</a>
					<ul class="sub2-menu" id="sm12a">
					    <li><a href="sys-admin-apt-nl.htm#apt-cook">APT-Guide Cookbook and Sources list</a></li>
					    <li><a href="sys-admin-apt-nl.htm#apt-install">Installing a new package</a></li>
					    <li><a href="sys-admin-apt-nl.htm#apt-delete">Deleting a package</a></li>
					    <li><a href="sys-admin-apt-nl.htm#apt-downgrade">Package Hold and downgrading</a></li>
					    <li><a href="sys-admin-apt-nl.htm#apt-cache">Package searching with apt-cache</a></li>
					    <li><a href="sys-admin-apt-nl.htm#gui-pacsea">GUI Package searching</a></li>
					</ul>
				</li>
		<li><a href="sys-admin-kern-upg-nl.htm#kern-upgrade">Upgrading the kernel &#8658;</a>
					<ul class="sub2-menu" id="sm12b">
					    <li><a href="sys-admin-kern-upg-nl.htm#kern-remove">Removing Kernels</a></li>
					    <li><a href="sys-admin-kern-upg-nl.htm#kern-upgrade">Upgrading the kernel</a></li>
					    <li><a href="sys-admin-kern-upg-nl.htm#dmakms">Installing kernel modules dynamically with dmakms</a></li>
					</ul>
				</li>
		<li><a href="sys-admin-apt-nl.htm#apt-upgrade">Upgrade an Installed System -  dist-upgrade - Overview &#8658;</a>
					<ul class="sub2-menu" id="sm12c">
					    <li><a href="sys-admin-upgrade-nl.htm#live-cd-upgrade">Upgrading by Live-ISO</a></li>
					    <li><a href="sys-admin-apt-locarmirr-nl.htm#approx">dist-upgrade of multiple PCs on a LAN</a></li>
					    <li><a href="sys-admin-apt-nl.htm#apt-upgrade">Upgrade an Installed System -  dist-upgrade - Overview</a></li>
					    <li><a href="sys-admin-apt-nl.htm#du-st">Upgrade an Installed System -  dist-upgrade - The Steps</a></li>
					</ul>
				  </li>
			    </ul>
		</li>
<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-gen-nl.htm">System Administration</a>
	<ul class="sub-menu" id="sm13">
		<li><a href="bios-freedos-nl.htm#bois-prep">Upgrading the BIOS with FreeDOS</a></li>
		<li><a href="vir-rkits-nl.htm#virus-rkits">Virus and Rootkit Scanners</a></li>
		<li><a href="hd-install-nl.htm#adduser">Adding Users and Passwords &#8658;</a>
					<ul class="sub2-menu" id="sm13a">
					    <li><a href="hd-install-nl.htm#adduser">Adding a new user</a></li>
					    <li><a href="sys-admin-gen-nl.htm#pw-lost">Lost root passwords, new passwords</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-gen-nl.htm#start-services">Services and init runlevels &#8658;</a>
					<ul class="sub2-menu" id="sm13b">
					    <li><a href="sys-admin-gen-nl.htm#start-services">Services enable/disable</a></li>
					    <li><a href="sys-admin-gen-nl.htm#init">aptosid runlevels - init</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-rsync-nl.htm#rsync">Backing up the system &#8658;</a>
					  <ul class="sub2-menu" id="sm13c">
					    <li><a href="sys-admin-rdiff-nl.htm#rdiff">Back-Up with rdiff</a></li>
					    <li><a href="sys-admin-rsync-nl.htm#rsync">Back-Up with rsync</a></li>
					    <li><a href="home-nl.htm#home-bu">Moving /home</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-gen-nl.htm#fonts">CUPS, Fonts and Sound &#8658;</a>
					  <ul class="sub2-menu" id="sm13d">
					     <li><a href="sys-admin-gen-nl.htm#fonts">Fonts</a></li>
					     <li><a href="sys-admin-gen-nl.htm#cups">CUPS - Printing System</a></li>
					     <li><a href="sys-admin-gen-nl.htm#sound">Sound Mixers</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-grub2-nl.htm#grub2">Grub2 &#8658;</a>
					  <ul class="sub2-menu" id="sm13f">
					    <li><a href="sys-admin-grub2-nl.htm#chroot">Grub2 - Recovering Grub with chroot</a></li>
					    <li><a href="sys-admin-grub2-nl.htm#mbr-over-grub2">Grub2 - MBR Overwritten</a></li>
					    <li><a href="sys-admin-grub2-nl.htm#multi-os">Grub2 - Dual and Multibooting</a></li>
					    <li><a href="sys-admin-grub2-nl.htm#grub1-grub2">Grub2 -Upgrading from Grub1</a></li>
					    <li><a href="sys-admin-grub2-nl.htm#grub2">Grub2 - Overview</a></li>
					</ul>
					</li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
	<div class="divider" id="rdiff">
			<h2 id="top-header">Een backup van het systeem maken met rdiff-backup</h2>
				<p>rdiff-backup is een programma om je bestanden te 'backuppen' (het kan op verschillende *nix-porten gedraaid worden).</p>

				<p class="highlight-2">Voer de commando's in als root in de konsole, tenzij anders vermeld.</p>

				<p>
          *het is geschikt om misgelopen dist-upgrades, kernel-upgrades enz te herstellen (trouwens ook prima om individuele bestanden terug te halen).
          <br />
				*het maakt alleen een backup van wat er veranderd is, zoals rsync dat doet (dus iedere backup neemt maar weinig tijd in beslag).<br />
				*het houdt bij wat er verandert (dat betekent dat je een bestand kunt terug halen dat je drie weken geleden verwijderd hebt!).<br />
				*het maakt veilige backups over een netwerk (gebruikt daarbij ssh)<br />
				*het maakt een backup van partities terwijl ze gemount (aangekoppeld) zijn. (dus het is erg makkelijk om een dagelijkse backup in te stellen ... umounten (ontkoppelen) is niet nodig).<br />
				*het kan alles herstellen als je harde schijf over de kop gaat en je een nieuwe moet kopen.<br />
				*het past zich aan om backups te maken ook binnen grotere netwerken (linux doet het hier goed, windows is moeilijker) en wordt gebruikt in het bedrijfsleven.<br />
				*het is een command-line applicatie, dus het is zeer geschikt als je ervan houdt om dingen als automatische backups op een krachtige manier te doen (bijvoorbeeld een bash script dat aangeroepen wordt door cron).<br />
				*het herinnert zich en gaat om met bestandseigendom en -permissie, en ook met symbolische links (en dat soort zaken), zodat je als je iets herstelt of terughaalt, dat precies zo terugkrijgt als het was.</p>

			<h6>Wat je nodig hebt</h6>
				<p>rdiff-backup bewaart een volledige (uncompressed) kopie van de files waar je een backup van maakt, en ook een geschiedenis (incremental backups). Dit betekent dat de ruimte die je gebruikt om backups te maken groter moet zijn dan die waar je een backup van maakt.  Als je een backup maakt van 100 gig, heb je daar misschien wel 120 gig voor nodig (bij voorkeur op een aparte schijf!).</p>

			<h6>Hoe je het moet instellen</h6>
				<p>Laten we zeggen dat er het volgende in je pc zit:<br />
				* een harde schijf van 100 gig (sda) die in gebruik is, met koppelpunten (mounts): sda1 voor de root partitie, en sda5 om muziek en andere bestanden op te slaan, en sda6 voor swap (wisselheugen).<br />
				* een lege harde schijf van 200 gig (sdb), die niet gebruikt wordt, met één koppelpunt (mount) op sdb1 .... deze gebruiken we om onze backup op te maken.<br />
				* IP addres 192.168.0.1</p>

				<p>Het eerste wat je moet doen is rdiff-backup installeren:</p>
<pre>
# apt-get install rdiff-backup
</pre>
				<p>Hoewel je van iedere directory een backup kunt maken, gaan we er hier van uit dat je een backup maakt van een hele partitie ... je wilt een backup maken van sda1 en sda5 (en niet van sda6), en dus maak je een paar directories aan waar je je data op gaat slaan:</p>
<pre>
# mkdir -p /media/sdb1/rdiff-backups/192.168.0.1/root
# mkdir -p /media/sdb1/rdiff-backups/192.168.0.1/sda5
</pre>
				<p>Je hebt een eigen IP adres nodig voor als je deze computer wilt gebruiken om ook een backup te maken vanaf een andere computer (dit wordt later behandeld).</p>

			<h6>Het maken van een backup</h6>

				<p>rdiff-backup gebruikt de syntax <span class="highlight-3">rdiff-backup source-dir dest-dir</span>. Opmerking: specificeer altijd de namen van directories, niet van bestanden.</p>

				<p>Om een backup te maken van sda5, doe het volgende:</p>
<pre>
# rdiff-backup /media/sda5 /media/sdb1/rdiff-backups/192.168.0.1/sda5
</pre>
				<p>En om een backup van de root-partitie te maken, doe je:</p>
<pre>
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/sdb1/rdiff-backups/192.168.0.1/root
</pre>
				<p>Alle "AF_UNIX path too long" foutmeldingen kun je negeren.<br />Het kan allemaal een tijdje duren omdat dit de eerste keer is dat er een backup van de partitie gemaakt wordt. rdiff-back maakt dus een backup van de hele partitie (niet alleen van de verschillen). Merk op dat je niet van alles een backup wilt maken: niet van /tmp omdat deze altijd verandert; niet van /proc of /sys omdat hier geen echte bestanden op staan; bovendien willen we ook geen backup van mounts (koppelpunten), zoals in /media - als je daar wel een backup van maakt, doe je dat in dit geval van sdb1 en kom je terecht in een eeuwige 'loop'. Een manier om daaraan te ontkomen is om van de (andere) mounts een aparte backup te maken.</p>

				<p>Je voert '/proc/*' in in plaats van alleen '/proc' omdat hierdoor slim genoeg wel een backup gemaakt wordt van de directorienaam /proc, maar alles in de directory met rust laat. Hetzelfde geldt voor /tmp, /sys en nog bijdehanter: alle namen van de koppelpunten (mountpoints).</p>

				 <p>Als je dus je rootpartitie vernietigt en een volledig herstel uitvoert zullen de directorienamen: /tmp, /proc, /sys, en de mountpoints aangemaakt worden (zoals dat ook hoort). Als /tmp niet bestaat terwijl X opstart, zou deze daarover kunnen klagen. Daardoor werkt deze mogelijk dan niet. Zie voor meer informatie de handleiding over: --exclude en --include).</p>

			<h6>Directories herstellen vanaf backups</h6>

				<p>rdiff-backup gebruikt dee syntax:</p>
<pre>
rdiff-backup -r &lt;from-when&gt; &lt;source-dir&gt; &lt;dest-dir&gt;
</pre>
				<p>Als je nu per ongeluk de directorie /media/sda7/foto's verwijderd hebt, kun je dit herstellen door het volgende in te voeren:</p>
<pre>
# rdiff-backup -r now /media/sdb1/rdiff-backups/192.168.0.1/sda5/foto's /media/sda5/foto's
</pre>
				<p>De optie "-r now" betekent: herstel vanaf de laatste backup. Als je van alles periodiek een backup maakte (laat we zeggen met crontab), en je je tot een paar dagen terug niet realiseerde dat de foto's directorie ontbrak, zou je een backup van een paar dagen eerder moeten gebruiken (en niet "now", aangezien de laatste backup aangeeft dat de foto's directorie ontbreekt). Misschien wil je ook wel gewoon om wat voor reden dan ook teruggaan naar een eerdere versie of iets dergelijks.</p>

				<p>Als je iets wilt herstellen van drie dagen terug, gebruik dan "-r 3D" ... maar, zoals de handleiding aangeeft, let hier dan wel even op:</p>

				<p class="highlight-1">"3D" refereert aan de onmiddellijke 72 uur vóór het huidige moment, en als er toen geen backup gemaakt is, herstelt rdiff-backup de situatie zoals die met de backup daarvóór vastgelegd is. Bijvoorbeeld in bovengenoemd situatie: als "3D" gebruikt wordt en er zijn alleen backups van 2 en 4 dagen geleden, dan wordt de directorie teruggezet zoals die 4 dagen geleden was (dus denk daar even aan als je een herstel wilt uitvoeren).</p>

				<p>Het volgende commando zal de data en tijdstippen weergeven waarop de backups van sda5 werden uitgevoerd:</p>
<pre>
# rdiff-backup -l /media/sdb1/rdiff-backups/192.168.0.1/sda5
</pre>
			<h5>Partities herstellen</h5>

				<p>Je kunt ook hele partities (mounts) terugzetten, tenslotte is een mount point (koppelpunt) eigenlijk gewoon een directorie.</p>

				<p class="highlight-2">WAARSCHUWING: Herstel je root-partitie niet als je erin geboot bent! Met één commando verlies je alle bestanden op al je partities, ook alle backups die op een aparte schijf staan!!<br /> rdiff-backup doet precies waarvoor het opdracht krijgt ... als de backup voor de root-partitie lege mount points (koppelpunten) heeft, dus om de situatie te herstellen naar hoe die was, verwijdert diff-backup alles in de mounts.</p>

				<p>Om sda5 terug te zetten van de laatste backup, doe je gewoon:</p>
<pre>
# rdiff-backup -r now /media/sdb1/rdiff-backups/192.168.0.1/sda5 /media/sda5
</pre>
			<h5>De root-partitie herstellen</h5>

				<p>
          Maar de root-partitie terugzetten is minder simpel. Zet de root-partitie niet terug, zolang deze aangekoppeld is (zie daarvoor de waarschuwing hierboven).<br />Het kan echt nuttig zijn om de root-partitie te herstellen. Als je onder het installeren/upgraden de zaak verprutst of de boel verpest bij het installeren van een nieuwe kernel, kun je met een gerust hart alles terugdraaien naar hoe je het had. Dat kost je maar 20 minuten.
        </p>

				<p>Een van de manieren om een root-partitie te herstellen is, om in een ongebruikte linux-partitie te booten - als je er één op je harde schijf hebt. Dan kun je elke partitie herstellen die je maar wilt, aangezien die dan niet gemount is als root. Boot erin, nadat je die partitie hersteld hebt, en alles is precies hetzelfde als wanneer je een backup had gebruikt - precies hetzelfde! Deze manier is verreweg de makkelijkste.</p>

				<p>Een andere manier om je root-partitie te herstellen is om de aptosid live cd te gebruiken en vanaf de live cd de zaak te herstellen. rdiff-backup staat erop. Mocht die niet staan op de aptosid live cd versie die jij gebruikt, dan kun je in grub (bootoptions, (Cheatcodes)) de cheatcode "unionfs" typen - dat houdt in dat je applicaties op je live cd kunt installeren. Boot gewoon en type de volgende commando's:</p>
<pre>
$ sudo su
# wget -O /etc/apt/sources.list http://aptosid.com/files/misc/sources.list
# apt-get update
# apt-get install rdiff-backup
</pre>
				<h6>Ok, nu gaan we herstellen:</h6>
<pre>
# mount /dev/sda1 /media/sda1
# mount /dev/sdb1 /media/sdb1
# rdiff-backup -r now /media/sdb1/rdiff-backups/192.168.0.1/root /media/sda1
</pre>

				<p>NB: Als je geen aptosid cd hebt maar je gebruikt een livecd met 'klik' ondersteuning, dan kun je rdiff-backup installeren door 'klik' te gebruiken en dan het volgende aan te roepen:</p>
<pre>
$ sudo ~/.zAppRun ~/Desktop/rdiff-backup_0.13.4-5.cmg rdiff-backup -r now /media/sdb1/rdiff-backups/192.168.0.1/root /media/sda1
</pre>

				<p>Het is raadzaam om het herstelproces te controleren als je van je root-partitie een backup maakt (met de bedoeling een herstel uit te voeren als dat nodig is). Niets ergers dan denken dat alles in orde zal komen en dan iets onverwachts tegenkomen in een noodsituatie.</p>

							<p>If the hard drive has been changed or reformatted, recheck the UUIDs, (or Labels), in <span class="highlight-3">/boot/grub/menu.lst (grub-legacy) or files in /etc/grub.d (grub2)</span> and <span class="highlight-3">/etc/fstab</span>, and alter accordingly. An easy way to get the information to alter the menu.lst and fstab files, if required, is as root:</p>

<pre>
blkid
</pre>

			<h5>Een backup maken van andere pc's</h5>

				<p>Je kunt ook een backup maken van andere pc's op je eigen pc. Voorwaarde is wel dat je eigen pc gebruik kan maken van het ssh-protocol naar de bedoelde pc-op-afstand - en je moet natuurlijk genoeg opslagcapaciteit hebben op je eigen pc. De ssh-server moet op die andere pc draaien. Hij hoeft niet in je lokale LAN te staan - hij mag overal op de wereld zijn.</p>

				<p>Laten we ervan uitgaan dat je andere pc over het volgende beschikt:<br />
				1) een 100 gig harde schijf (sda) die in gebruik is en waarbij alles dus is aangekoppeld,<br />
				2) sda1 gebruikt voor de root-partitie,<br />
				3) sda5 gebruikt voor het opslaan van een paar tijdelijke gegevens waar we geen backup van willen maken,<br />
				4) en sda6 als swap <br />
				5) IP addres 192.168.0.2</p>

				<p>NB: van alletwee de 100 gig schijven kan normaal gesproken niet een backup gemaakt worden op een 200 gig grote harde schijf, als je rdiff-backup gebruikt (dit omdat er dan geen plek is voor de zogenaamde 'incremental files'). Aangezien je geen backup maakt van sda5 van je pc-op-afstand en trouwens ook omdat normaal gesproken je harde schijf niet voor de volle 100% vol zit, kun je er vanuit gaan dat je genoeg ruimte hebt voor een backup. Het is wel zo dat elke keer dat je met rdiff-backup een backup maakt er meer van die zogenaamde 'incremental files' aangemaakt worden. Deze nemen dus meer en meer plek in beslag.</p>

				<p>Je kunt rdiff-backup opdracht geven om slechts backups van een maand oud te bewaren (dat commando geven we je hier verderop), en dat neemt natuurlijk lang niet zoveel ruimte in beslag dan backups over de periode van ene jaar. Daarnaast .... als je over ene periode van ene jaar backups bewaart dan horen daar ook weer de nodige 'incremental files' bij.</p>

				<p>Het eerste dat je moet doen is rdiff-backup op de pc-op-afstand te installeren (op elke pc waarvan je een backup wil maken en ook op de pc die als backup-server dienst doet moet rdiff-backup staan.)</p>

				<p>Om een backup te maken van de pc-op-afstand op jouw pc (192.168.0.1), voer je het volgende in: <span class="highlight-4">Let op het gebruik van twee keer de dubbele punt :: </span></p>
<pre>
# mkdir /media/sdb1/rdiff-backups/192.168.0.2/root
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' 192.168.0.2::/ /media/sdb1/rdiff-backups/192.168.0.2/root
</pre>
				<p>Als je nou een directory wil herstellen op je pc-op-afstand, begin dan de 'restore' op of je eigen pc of op de pc-op-afstand.</p>

				<p>Zo herstel je de directory /usr/local/games op je pc-op-afstand, vanaf die pc:</p>
<pre>
# rdiff-backup -r now 192.168.0.1::/media/sdb1/rdiff-backups/192.168.0.1/root/usr/local/games /usr/local/games
</pre>
				<p>Zo herstel je de directory /usr/local/games op je pc-op-afstand, vanaf je eigen pc:</p>
<pre>
# rdiff-backup -r now /media/sdb1/rdiff-backups/192.168.0.1/root/usr/local/games 192.168.0.2::/usr/local/games
</pre>
				<p>Gebruik dezelfde syntax als je je root partitie herstelt vanaf een live cd (de pc-op-afstand is dan wel met een live cd opgestart ... zie hierboven).</p>

			<h5>Automatische backups:</h5>

				<p>Als je backups maakt van andere pc's op je lokale pc, is het eerste dat je moet doen wachtwoordloze ssh logins mogelijk maken, gebruikmakend van ssh-keys.<span class="highlight-2"> Let er op dat we het hier heben over wachtwoordloze ssh-logins als 'root'. Dit kun je zo inperken dat alleen rdiff-backup commando's zo uitgevoerd worden. - maar dit valt buiten de scope van dit topic. Ik verwijs daarom naar de <a href="ssh-nl.htm#ssh-s">SSH Configuration</a> </span>. We gaan uit van volledig vertrouwen en we zetten hier de eenvoudigste manier op van hetr verkrijgen van wachtwoordloze logins.</p>

				<p>Doe het volgende vanaf je lokale pc:</p>
<pre>
# [ -f /root/.ssh/id_rsa ] || ssh-keygen -t rsa -f /root/.ssh/id_rsa
</pre>
				<p>En dan twee keer 'enter' voor lege wachtwoorden. Daarna doe je:</p>
<pre>
# cat /root/.ssh/id_rsa.pub | ssh 192.168.0.2 'mkdir -p /root/.ssh;\
> cat - >>/root/.ssh/authorized_keys2'
</pre>
				<p>Je zult om je root-wachtwoord gevraagd worden:</p>

				<p>Je kunt nu naar de pc-op-afstand ssh-en als root zonder een wachtwoord te hoeven invoeren, en rdiff-backup kan nu geautomatiseerd worden.</p>

				<p>Maak tenslotte een bash-script dat alle rdiff-backup commando's bevat. Dat van ons ziet er dan ongeveer zo uit:</p>


<pre>
#!/bin/bash
RDIFF=/usr/bin/rdiff-backup
echo
echo "=======Backing up 192.168.0.1 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*'\
 --exclude '/sys/*' --exclude '/media/*/*'\
 / /media/sdb1/rdiff-backups/192.168.0.1/root
echo "(and purge increments older than 1 month)"
${RDIFF} --remove-older-than 1M\
 --force /media/sdb1/rdiff-backups/192.168.0.1/root
echo
echo "=======Backing up 192.168.0.1 mount sda5======="
${RDIFF} --ssh-no-compression --exclude /media/sda5/myjunk /media/sda5\
 /media/sdb1/rdiff-backups/192.168.0.1/sda5
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M\
 --force /media/sdb1/rdiff-backups/192.168.0.1/sda5
echo
echo "=======Backing up 192.168.0.2 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' --exclude '/mnt/*/*' 192.168.0.2::/media/sdb1/rdiff-backups/192.168.0.2/root
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M\
 --force /media/sdb1/rdiff-backups/192.168.0.2/root
</pre>


				<p>Je kunt dit bash-script nu "myrdiff-backups.bash" noemen en het in de /usr/local/bin plaatsen op je lokale (backup-server) machine, en het uitvoerbaar maken. Start het script en overtuig je ervan dat het goed werkt.</p>

				<p>Tenslotte kun je 'cron' gebruiken om het elke avond om 8 uur te laten draaien. De hieronder weergegeven regel in de 'crontab' van de 'root' doet het hem:</p>
<pre>
# crontab -e
en voeg de volgende regel toe:
0 20 * * * /usr/local/bin/myrdiff-backups.bash
</pre>

		<div id="rev">Inhoud het laatst gewijzigd op 14/08/2010 0100 UTC</div>
</div>
</div>
</body>
</html>
