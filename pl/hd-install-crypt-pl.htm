<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>Podręcznik aptosid - Encryption Installations</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<!-- Last translation revision bluewater 01/11/2010 1120 -->
<div id="menu"> <!-- menu starts here pl lang maintained by -->
<!--aptosid Operating System Manual menu-version-02.10.2011.03.14 REPO -->
<!-- menu last updated by bluewater 2011.03.14 0620 hrs UTC -->
	<div id="menu-header">
	      <a href="http://aptosid.com/"><img src="../lib/logos/manual-aptosid-logo.png" title="Przejdź do aptosid.com, forum oraz wiki" alt="aptosid.com logo" /></a>
	</div>
	<ul id="top-list">
		<li><a href="manual-search-pl.htm#search-on"> <img src="../lib/logos/manual-search-22x22.png" title="Search Manual" alt="Search" /> Szukaj</a> </li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/aptosid-lang-100x64.png" title="Wybierz inny język" alt="lang-switch" /></a>
	</div>
	<ul>
<li onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-pl.htm">Podręcznik aptosid</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-pl.htm#welcome-gen">Podręcznik aptosid &#8658;</a>
					<ul class="sub2-menu" id="sm1a">
					  <li><a href="credits-pl.htm#cred-team">Przypisy</a></li>
					</ul>
					</li>
		<li><a href="welcome-pl.htm#how-to">Jak używać tego podręcznika &#8658;</a>
					<ul class="sub2-menu" id="sm1b">
					  <li><a href="welcome-pl.htm#how-to">Jak używać tego podręcznika</a></li>
					  <li><a href="welcome-pl.htm#table-contents">Spis treści</a></li>
					</ul>
					</li>
		<li><a href="help-pl.htm#help-gen">Uzyskiwanie pomocy &#8658;</a>
					<ul class="sub2-menu" id="sm1c">
					  <li><a href="help-pl.htm#help-gen">Gdzie, i jak uzyskać pomoc</a></li>
					  <li><a href="help-pl.htm#paste">IRC !wklej</a></li>
					</ul>
					</li>
		<li><a href="wel-quickstart-pl.htm#welcome-quick">Szybki start z aptosid</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-dl-burning-pl.htm">Zawartość obrazów, Wydania, Pobieranie, Serwery lustrzane, Wypalanie</a>
			   <ul class="sub-menu" id="sm2">
				<li><a href="cd-content-pl.htm#cd-content">Zawartość ISO, i wymagania systemowe &#8658;</a>
					<ul class="sub2-menu" id="sm2a">
					  <li><a href="sys-admin-release-pl.htm#rolling">Notki Wydania</a></li>
					</ul>
					</li>
		    <li><a href="cd-dl-burning-pl.htm#download-aptosid">Serwery lustrzane, Pobieranie, i wypalanie aptosid &#8658;</a>
				<ul class="sub2-menu" id="sm2b">
					  <li><a href="cd-dl-burning-pl.htm#md5">Sumy MD5</a></li>
					  <li><a href="cd-dl-burning-pl.htm#burn-nero">Wypalanie w Windows</a></li>
					  <li><a href="cd-dl-burning-pl.htm#burn-linux">Wypalanie w Linux</a></li>
					  <li><a href="cd-no-gui-burn-pl.htm#burning-no-gui">Skrypt burniso</a></li>
					  <li><a href="cd-no-gui-burn-pl.htm#burn-no-gui-gen">Wypalanie bez GUI</a></li>
					  <li><a href="cd-dl-burning-pl.htm#download-aptosid">Serwery Lustrzane dla pobierania aptosid'a</a></li>
					</ul>
					</li>
		      </ul>
		</li>
<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="live-mode-pl.htm">Tryb Live</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="live-mode-pl.htm#rootpw">Hasło root'a na aptosid-Live</a></li>
				<li><a href="live-mode-pl.htm#live-cd-installsoft">Instalacja oprogramowania w trybie Live-CD</a></li>
			</ul>
		</li>
<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="term-konsole-pl.htm">Terminal / Konsola</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="term-konsole-pl.htm#term-kon"> Terminal / Konsola &#8658;</a>
					<ul class="sub2-menu" id="sm4a">
					  <li><a href="term-konsole-pl.htm#term-kon"> Terminal / Konsola</a></li>
					  <li><a href="term-konsole-pl.htm#colours"> Coloured terminal prompts</a></li>
					  <li><a href="term-konsole-pl.htm#cli-help">Linia komend - Pomoc</a></li>
					  <li><a href="help-pl.htm#init3-tools">Narzędzia trybu tekstowego (tty) - init 3</a></li>
					  <li><a href="term-konsole-pl.htm#term-cmds">Konsolowe komendy</a></li>
					</ul>
					</li>
			  <li><a href="term-konsole-pl.htm#sux"> sux / sudo</a></li>
		    </ul>
		</li>
<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="cheatcodes-pl.htm">Kody startowe</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="cheatcodes-pl.htm#cheatcodes">Specyficzne kody dla ISO aptosid</a></li>
				<li><a href="cheatcodes-pl.htm#cheatcodes-linux">Powszechne kody Linux'a</a></li>
				<li><a href="cheatcodes-vga-pl.htm#vga">Kody VGA</a></li>
			</ul>
		</li>
<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="part-gparted-pl.htm">Partycjonowanie dysku twardego</a>
		<ul class="sub-menu" id="sm6">
			<li><a href="part-gparted-pl.htm#hd-ntfs3g">Zapis na partycje NTFS z użyciem ntfs-3g</a></li>
			<li><a href="part-lvm-pl.htm#part-lvm">Partitioning to use LVM - Logical Volume Manager</a></li>
			<li><a href="part-gparted-pl.htm#partition">Partycjonowanie dysku - aplikacje z graficznym intrefejsem użytkownika &#8658;</a>
					<ul class="sub2-menu" id="sm6a">
					  <li><a href="part-gparted-pl.htm#partition">Partycjonowanie twojego dysku z użyciem G-Parted / Partycjonera KDE</a></li>
					  <li><a href="part-gparted-pl.htm#ntfs">Zmiana rozmiaru partycji NTFS, z użyciem G-Parted / Partycjonera KDE</a></li>
					</ul>
					</li>
		<li><a href="part-cfdisk-pl.htm#partition">Partycjonowanie dysku - konsola &#8658;</a>
					 <ul class="sub2-menu" id="sm6b">
					    <li><a href="part-cfdisk-pl.htm#partition">Partycjonowanie dysku z użyciem cfdisk</a></li>
					    <li><a href="part-cfdisk-pl.htm#formating">Formatowanie dysku po partycjonowaniu z użyciem cfdisk</a></li>
					</ul>
					</li>
		<li><a href="part-size-examp-pl.htm#part-example">Podstawy partycjonowania &#8658;</a>
					<ul class="sub2-menu" id="sm6c">
					  <li><a href="part-size-examp-pl.htm#part-example">Przykładowe rozmiary partycji</a></li>
					  <li><a href="part-uuid-pl.htm#uuid">UUID, Rebuilding fstab and creating new mount points</a></li>
					  <li><a href="part-cfdisk-pl.htm#disknames">Nazewnictwo dysków</a></li>
					</ul>
					</li>
		      </ul>
		</li>
<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="hd-install-pl.htm">Opcje instlalacji - HD, USB, VM and Cryptroot</a>
		<ul class="sub-menu" id="sm7">
		  <li><a href="hd-install-pl.htm#Inst-prep">Przygotowanie do instalacji &#8658;</a>
					<ul class="sub2-menu" id="sm7a">
					  <li><a href="hd-install-pl.htm#Inst-prep">Przygotowanie do instalacji</a></li>
					  <li><a href="hd-install-pl.htm#Installation">Instalacja na dysku twardym</a></li>
					  <li><a href="hd-install-pl.htm#first-hd-boot">Pierwsze uruchomienie</a></li>
					</ul>
					</li>
		<li><a href="hd-install-opts-pl.htm#fromiso">Uruchamianie z obrazu ISO &#8658;</a>
					<ul class="sub2-menu" id="sm7b">
					  <li><a href="hd-install-opts-pl.htm#fromiso">Uruchamianie z Obrazu ISO - Przegląd</a></li>
					  <li><a href="hd-install-opts-pl.htm#fromiso-grub-leg">Uruchamianie z obrazu ISO - GRUB 1</a></li>
					  <li><a href="hd-install-opts-pl.htm#grub2-fromiso">Uruchamianie z obrazu ISO - GRUB 2</a></li>
					  <li><a href="hd-install-opts-pl.htm#fromiso-persist">Tryby fromiso, i persist</a></li>
					</ul>
					</li>
		<li><a href="hd-install-opts-pl.htm#usb-hd">Instalacja na nośnik USB &#8658;</a>
					<ul class="sub2-menu" id="sm7c">
					  <li><a href="hd-install-opts-pl.htm#usb-hd">Instalacja na dysk USB-HDD</a></li>
					  <li><a href="hd-ins-opts-oos-pl.htm#raw-usb">Zapis aptosid na dysk USB/SSD/Flash z użyciem jakiegokolwiek systemu z rodziny Windows, Linux lub Mac OS X</a></li>
					</ul>
					</li>
		  <li><a href="hd-install-crypt-pl.htm#install-crypt">Instalacja na zaszyfrowanej partycji - cryptroot</a></li>
		  <li><a href="nbdboot-pl.htm#nbd1">Uruchamianie aptosid poprzez sieć</a></li>
		  <li><a href="hd-install-vmopts-pl.htm#vmopts">Opcje instalacji maszyny wirtualnej</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="gpu-pl.htm">Graphic cards, monitors, Xorg,  &amp; drivers</a>
	<ul class="sub-menu" id="sm8">
		<li><a href="hw-dev-mon-pl.htm#mon-res">Rozdzielczość ekranu, i Monitor &#8658;</a>
					<ul class="sub2-menu" id="sm8a">
					  <li><a href="hw-dev-mon-pl.htm#mon-res">Rozdzielczość ekranu ,i Monitory</a></li>
					  <li><a href="hw-dev-mon-pl.htm#xrandr">Dwa monitory i xrandr</a></li>
					  <li><a href="hw-dev-mon-pl.htm#mon-binary">Dwa Monitory (używając binariów)</a></li>
					</ul>
					</li>
		<li><a href="gpu-pl.htm#foss-xorg">GPU firmware &#8658;</a>
					<ul class="sub2-menu" id="sm8b">
					  <li><a href="gpu-pl.htm#ati-3d">AMD/ATI 3D drivers</a></li>
					  <li><a href="gpu-pl.htm#intel">Intel 2D and 3D drivers</a></li>
					  <li><a href="gpu-pl.htm#nvidia">Nvidia 3D drivers</a></li>
					  <li><a href="gpu-pl.htm#foss-xorg">Open Source Xorg drivers</a></li>
					</ul>
					</li>
			  <li><a href="nf-firm-pl.htm#fw-detect">Firmware detection - non-free </a></li>
			  <li><a href="nf-firm-pl.htm#non-free-firmware">Adding non-free to Sources List</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="wm-kde-pl.htm">Menadżery Okien</a>
		    <ul class="sub-menu" id="sm9">
			  <li><a href="wm-kde-pl.htm">Menadżery Okien &#8658;</a>
					  <ul class="sub2-menu" id="sm9a">
					    <li><a href="wm-xfce-pl.htm#xfce-notes">Przydatne dodatki dla XFCE</a></li>
					    <li><a href="wm-kde-pl.htm#install-add">Przydatne aplikacje dla KDE</a></li>
					    <li><a href="wm-kde-pl.htm#desk-freeze">Zamrażanie pulpitu</a></li>
					    <li><a href="wm-kde-pl.htm#kde-login">Nie można zalogować się do KDE</a></li>
					    <li><a href="wm-kde-pl.htm#ch-th">Zmiana motywów</a></li>
					</ul>
					</li>
		      <li><a href="wm-kde-pl.htm#dm">Menadżery logowania - dm</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="inet-ceni-pl.htm">Łączenie z internetem, WiFi, LAN ,i inne typy sieci</a>
		    <ul class="sub-menu" id="sm11">
			<li><a href="lamp-apache-pl.htm">LAMP w aptosid &#8658;</a>
					<ul class="sub2-menu" id="sm11a">
					    <li><a href="lamp-apache-pl.htm#serv-apache">LAMP w aptosid</a></li>
					    <li><a href="lamp-apache-pl.htm#serv-ftp">Klienty FTP</a></li>
					    <li><a href="lamp-apache-pl.htm#serv-sec">Protokoły bezpieczeństwa</a></li>
					    <li><a href="lamp-apache-pl.htm#serv-ssl">SSL</a></li>
					    <li><a href="lamp-sql-pl.htm#serv-mysql">Ustawienia MySQL</a></li>
					    <li><a href="lamp-ppp-pl.htm#serv-php">PHP w Apache</a></li>
					    <li><a href="ntp-server-pl.htm#ntp-server">Ustawienia Serwera czasu</a></li>
					</ul>
					</li>
		<li><a href="tor-privoxy-pl.htm#tor">Zapora ogniowa ,i prywatność &#8658;</a>
					<ul class="sub2-menu" id="sm11b">
					    <li><a href="tor-privoxy-pl.htm#tor">Tor</a></li>
					    <li><a href="tor-privoxy-pl.htm#privoxy">Privoxy</a></li>
					    <li><a href="inet-ceni-pl.htm#firewalls">Zapory</a></li>
					</ul>
					</li>
		<li><a href="ssh-pl.htm#ssh-x">SSH ,i Samba &#8658;</a>
					<ul class="sub2-menu" id="sm11c">
						  <li><a href="samba-pl.htm#setup">Ustawienia serwera Samba</a></li>
						  <li><a href="samba-pl.htm#configure">konfiguracja SAMBA (Windows)</a></li>
						  <li><a href="ssh-pl.htm#ssh-fs">Zdalny dostęp SSH</a></li>
						  <li><a href="ssh-pl.htm#ssh-x">Graficzne aplikacje poprzez SSH</a></li>
						  <li><a href="ssh-pl.htm#ssh-f">Graficzne SSH przy użyciu Konqueror</a></li>
						  <li><a href="ssh-pl.htm#ssh-w">SSH X-Forwarding z Windows</a></li>
						  <li><a href="ssh-pl.htm#ssh">SSH i bezpieczeństwo</a></li>
					</ul>
					</li>
		<li><a href="inet-ceni-pl.htm#netcardconfig">Połączenia WiFi &#8658;</a>
						<ul class="sub2-menu" id="sm11d">
						    <li><a href="inet-ceni-pl.htm#netcardconfig">Łączenie z siecią - Ceni</a></li>
						    <li><a href="inet-wpagui-pl.htm#wpa-roaming-gui">WiFi - WPA_GUI</a></li>
						    <li><a href="inet-setup-pl.htm#net-set1">WiFi - Ustawianie Roaming'u WiFi</a></li>
						    <li><a href="inet-wpa-pl.htm#wpa">WiFi - wpasupplicant</a></li>
						    <li><a href="inet-ifplug-pl.htm#hotswitch">Sieć - Przełączanie interfejsów sieciowych</a></li>
					</ul>
					</li>
		<li><a href="inet-ceni-pl.htm#netcardconfig">Połączenia kablowe &#8658;</a>
						<ul class="sub2-menu" id="sm11e">
						    <li><a href="inet-ceni-pl.htm#dial-mod">Modemy 56K</a></li>
						    <li><a href="inet-ceni-pl.htm#netcardconfig">Połączenia przy użyciu modemów 56K - Ceni</a></li>
					</ul>
					</li>
				</ul>
			    </li>
<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="sys-admin-apt-pl.htm">Zarządzanie pakietami i ich aktualizacja</a>
	<ul class="sub-menu" id="sm12">
		<li><a href="sys-admin-apt-pl.htm#apt-cook">APT i Lista repozytoriów/źródeł &#8658;</a>
					<ul class="sub2-menu" id="sm12a">
					    <li><a href="sys-admin-apt-pl.htm#apt-cook">Podręcznik APT'a i lista repozytoriów/źródeł </a></li>
					    <li><a href="sys-admin-apt-pl.htm#apt-install">Instalacja nowego pakietu</a></li>
					    <li><a href="sys-admin-apt-pl.htm#apt-delete">Usuwanie pakietu</a></li>
					    <li><a href="sys-admin-apt-pl.htm#apt-downgrade">Zatrzymywanie pakietów oraz cofanie do wcześniejszych wersji</a></li>
					    <li><a href="sys-admin-apt-pl.htm#apt-cache">Wyszukiwanie pakietów z użyciem apt-cache</a></li>
					    <li><a href="sys-admin-apt-pl.htm#gui-pacsea">Graficzne wyszukiwanie pakietów</a></li>
					</ul>
				</li>
		<li><a href="sys-admin-kern-upg-pl.htm#kern-upgrade">Aktualizacja jądra &#8658;</a>
					<ul class="sub2-menu" id="sm12b">
					    <li><a href="sys-admin-kern-upg-pl.htm#kern-remove">Usuwanie jąder</a></li>
					    <li><a href="sys-admin-kern-upg-pl.htm#kern-upgrade">Aktualizacja jądra</a></li>
					    <li><a href="sys-admin-kern-upg-pl.htm#dmakms">Instalacja modułów jądra z użyciem dmakms</a></li>
					</ul>
				</li>
		<li><a href="sys-admin-apt-pl.htm#apt-upgrade">Aktualizacja zainstalowanego systemu - Przegląd &#8658;</a>
					<ul class="sub2-menu" id="sm12c">
					    <li><a href="sys-admin-upgrade-pl.htm#live-cd-upgrade">Aktualizacja z użyciem obrazu ISO</a></li>
					    <li><a href="sys-admin-apt-locarmirr-pl.htm#approx">Aktualizacja systemów na kilku komputerach poprzez LAN</a></li>
					    <li><a href="sys-admin-apt-pl.htm#apt-upgrade">Aktualizacja zainstalowanego systemu - Przegląd</a></li>
					    <li><a href="sys-admin-apt-pl.htm#du-st">Aktualizacja zainstalowanego systemu - Kroki</a></li>
					</ul>
				  </li>
			    </ul>
		</li>
<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-gen-pl.htm">Administracja systemem</a>
	<ul class="sub-menu" id="sm13">
		<li><a href="bios-freedos-pl.htm#bois-prep">Aktualizacja BIOS'u z użyciem FreeDOS</a></li>
		<li><a href="vir-rkits-pl.htm#virus-rkits">Skanery wirusów i rootkitów</a></li>
		<li><a href="hd-install-pl.htm#adduser">Dodawanie użytkownika z hasłem &#8658;</a>
					<ul class="sub2-menu" id="sm13a">
					    <li><a href="hd-install-pl.htm#adduser">Dodawanie nowego użytkownika</a></li>
					    <li><a href="sys-admin-gen-pl.htm#pw-lost">Zapomniane hasło root'a, nowe hasło</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-gen-pl.htm#start-services">Usługi i poziomy startu &#8658;</a>
					<ul class="sub2-menu" id="sm13b">
					    <li><a href="sys-admin-gen-pl.htm#start-services">Włączanie/Wyłączanie usług</a></li>
					    <li><a href="sys-admin-gen-pl.htm#init">Poziomy uruchamiania aptosid - init</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-rsync-pl.htm#rsync">Kopia zapasowa systemu &#8658;</a>
					  <ul class="sub2-menu" id="sm13c">
					    <li><a href="sys-admin-rdiff-pl.htm#rdiff">Kopia zapasowa systemu przy użyciu rdiff</a></li>
					    <li><a href="sys-admin-rsync-pl.htm#rsync">Kopia zapasowa systemu przy użyciu rsync</a></li>
					    <li><a href="home-pl.htm#home-bu">Przenoszenie /home</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-gen-pl.htm#fonts">CUPS, czcionki i dźwięk &#8658;</a>
					  <ul class="sub2-menu" id="sm13d">
					     <li><a href="sys-admin-gen-pl.htm#fonts">Czcionki</a></li>
					     <li><a href="sys-admin-gen-pl.htm#cups">CUPS - system obsługi urządzeń drukujących</a></li>
					     <li><a href="sys-admin-gen-pl.htm#sound">Mixery dźwięku</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-grub2-pl.htm#grub2">Grub2 &#8658;</a>
					  <ul class="sub2-menu" id="sm13f">
					    <li><a href="sys-admin-grub2-pl.htm#chroot">Grub2 - Przywracanie GRUB'a w środowisku chroot</a></li>
					    <li><a href="sys-admin-grub2-pl.htm#mbr-over-grub2">Grub2 - Nadpisywanie MBR</a></li>
					    <li><a href="sys-admin-grub2-pl.htm#multi-os">Grub2 - Uruchamianie wielu systemów operacyjnych</a></li>
					    <li><a href="sys-admin-grub2-pl.htm#grub1-grub2">Grub2 -Aktualizacja z Grub'a w wersji 1</a></li>
					    <li><a href="sys-admin-grub2-pl.htm#grub2">Grub2 - Przegląd</a></li>
					</ul>
					</li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
		<div class="divider" id="install-crypt">
				<h2 id="top-header">Installing to a cryptroot</h2>

							<p><span class="highlight-2">Please note: There are some caveats using this guide for encrypting root or data partitions. These are:</span> </p>
						    <ul>

							<li>This is a basic guide to get you started. It is your responsibilty to learn more about LUKS, cryptsetup and encryption. Sources and Resources are linked at the bottom of this page which will be of help, however the list is definitely not exhaustive.</li>

							<li>cryptsetup cannot encrypt an existing data partition, so you must create a new partition, set it up with cryptsetup and then move your data onto it.</li>

							<li>You can also use key files and have multiple keys for the data, (up to 8,  including the removal of keys), which is outside the scope of this guide.</li>

							<li><span class="highlight-3">Do not forget the passphrases as you will lose access to everything! Even a chroot without knowing the passphrases will not of be of any help except for /boot.</span></li>

							<li>Early in the boot process you will be asked for your passphrase for the crypt device and the system will boot up as expected.</li>
						    </ul>
					      <h3>Encryption examples:</h3>
						    <ul>
							<li><a href="hd-install-crypt-pl.htm#lvm">Using crypt within LVM groups</a>.</li>

							<li><a href="hd-install-crypt-pl.htm#simple">Notes for crypt with traditional partitioning methods</a>.</li>
						    </ul>

			      </div>

			      <div class="divider" id="lvm">
					      <h2>Encryption within LVM groups</h2>

							<p><span class= "highlight-3">This example uses crypt inside the LVM volume to enable you let you split your home from <span class= "highlight-2"> / </span> and have a swap partition without needing multiple passwords and is applicable from aptosid-2010-03-apate and later.</span></p>

							<p>Before running the installer you must prepare the filesystems which will be used for the installation. For basic LVM partitioning  guidelines, you need to refer to <a href="part-lvm-pl.htm#part=lvm">Logical Volume Manager - LVM partitioning</a>. </p>

							<p>You will need at least an unencrypted <span class= "highlight-3">/boot </span>filesystem and an encrypted <span class= "highlight-2"> / </span>filesystem and also create encrypted <span class= "highlight-3">/home and swap</span> filesystems. </p>
						  <ol>
							<li>If you are not planning to use an existing lvm volume group then create a normal lvm volume group. This example will assume that the volume group is called <span class= "highlight-3">vg</span>  to hold your boot and encrypted data.</li>

							<li>You will need a logical volume for /boot and the encrypted data so use <span class= "highlight-3">lvcreate</span> to create the logical volumes in <span class= "highlight-3">vg</span> volume group with the sizes you want:
<pre>
lvcreate -n boot --size 250m vg
lvcreate -n crypt --size 300g vg
</pre>
							Here you have named the logical volumes boot and crypt and made them 250Mb and 300Gb respectively.
							</li>
							<li>Create the filesystem for <span class= "highlight-3">/boot</span> so it will be available in the installer:
<pre>
mkfs.ext4 /dev/mapper/vg-boot
</pre>
							</li>
							<li>Use <span class= "highlight-3">cryptsetup</span> to encrypt <span class= "highlight-3">vg-crypt</span> using the faster xts option with the highest strength key length of 512bit and then open it. This will ask you for your password twice to set it and then a third time to open it. Open it here under the default boot time cryptopts target name of cryptroot:
<pre>
cryptsetup --verify-passphrase --cipher aes-xts-plain:sha512 luksFormat /dev/mapper/vg-crypt
</pre>

<pre>
cryptsetup luksOpen /dev/mapper/vg-crypt cryptroot
</pre>
							</li>
							<li>Now use lvm inside the encrypted device to create a second volume group that will be used for the <span class= "highlight-3">/swap</span> and <span class= "highlight-3">/home</span> devices. <span class= "highlight-3">pvcreate</span> cryptroot to make it a physical volume and use it with <span class= "highlight-3">vgcreate</span> to create another volume group, we call it <span class= "highlight-3">cryptvg</span>:
<pre>
pvcreate /dev/mapper/cryptroot
vgcreate cryptvg /dev/mapper/cryptroot
</pre>
							</li>
							<li>Next use <span class= "highlight-3">lvcreate</span> with the new encrypted <span class= "highlight-3">cryptvg</span> volume group to create the <span class= "highlight-2"> / </span>, <span class= "highlight-3">/swap</span> and <span class= "highlight-3">/home </span>logical volumes with the sizes you want:

<pre>
lvcreate -n swap --size 2g cryptvg
lvcreate -n root --size 40g cryptvg
lvcreate -n home --size 80g cryptvg
</pre>
							Here you have named the logical volumes swap, root and home and made them 2Gb, 40Gb and 80Gb respectively.
							</li>
							<li>Create the filesystems for cryptvg-swap, cryptvg-root and cryptvg-home so they are available in the installer:
<pre>
mkswap /dev/mapper/cryptvg-swap
mkfs.ext4 /dev/mapper/cryptvg-root
mkfs.ext4 /dev/mapper/cryptvg-home
</pre>
							</li>

							<li><b>Now you are ready to run the installer where you should use:</b><br />
							<span class= "highlight-3">vg-boot</span> for <span class= "highlight-3">/boot</span>,<br />
							<span class= "highlight-3">cryptvg-root</span> for <span class= "highlight-2"> /</span>,<br />
							<span class= "highlight-3">cryptvg-home</span> for <span class= "highlight-3">/home</span>,<br />
							and <span class= "highlight-3">cryptvg-swap</span> for <span class= "highlight-3">swap</span></li>
						    </ol>

							<p>The installed system should end up with a kernel command line including the following options:</p>
<pre>
root=/dev/mapper/cryptvg-root cryptopts=source=/dev/mapper/vg-crypt,target=cryptroot,lvm=cryptvg-root
</pre>
							<p>You now have the crypt and boot under the vg lvm volume group and the root, home and swap inside the vgcrypt lvm volume group which is inside your password protected encrypted device.</p>

			      </div>
			  <div class="divider" id="simple">
					<h2>Notes for crypt with traditional partitioning methods</h2>

							<p>The first thing to decide is how you want to layout your disk. You will need a minimum of 2 partitions, one normal partition for your <span class="highlight-3">/boot</span> and one for the encypted data. </p>

							<p>Assuming you require swap (which should also be encrypted) you will need a third partition and will have to enter the password for swap seperately during bootup (so you will have two password prompts). </p>

							<p>It is possible to use keys for the swap from inside the encrypted system with traditional partitioning, however you will not be able to suspend to disk. Due to these issues, the better option in the long term is to use  LVM volumes with fully encrypted partitions and keys.</p>

							<!--<p>It is possible to use keys for the swap from inside the encrypted system with traditional partitioning, however you will not be able to suspend to disk. Due to these issues, LVM volumes with fully encrypted partitions with keys is definitely the better option in the long term.</p>-->

			      <h6> Essential assumptions:</h6>
						  <ul>
							<li> There are just 3 plain partitions on this disk:<br />
							<span class="highlight-3"> /boot</span>,  of 250mb<br />
							<span class="highlight-3"> swap</span>, of 2 gig<br />
							<span class="highlight-2"> / </span> and <span class="highlight-3"> /home</span> combined (for example, the balance).</li>

							<li>2 passphrases will be required, 1 for swap the other for the <span class="highlight-2"> / </span> and <span class="highlight-3"> /home</span> combined.</li>
						   </ul>

							<p>Now that you have the partitioning done, you need to prepare the encrypted partitions so that they will be recognised by the installer.</p>

							<p>If you have been using a GUI partitioning application, close it and open a terminal, as the encryption  commands need to be done from the command line.</p>

					      <h5>The /boot partition</h5>
							<p>Make the <span class="highlight-3">/boot </span> partition an ext4 partition, if you have not already done so:</p>
<pre>
/sbin/mkfs.ext4 /dev/sda1
</pre>




					      <h5>Encrypted swap partition</h5>

							<p>For the <span class="highlight-3">encrypted swap</span> you first need to format and open the raw device, <span class="highlight-3">/dev/sda2</span>, as an encrypted device, like the vg-crypt device above but opening it under a different name, swap.</p>

<pre>
cryptsetup --verify-passphrase --cipher aes-xts-plain:sha512 luksFormat /dev/sda2
</pre>

<pre>
cryptsetup luksOpen /dev/sda2 swap
</pre>

							<p>Format the created <span class="highlight-3">/dev/mapper/swap</span> so it will show up in the installer:</p>

<pre>
/sbin/mkswap /dev/mapper/swap
</pre>

					      <h5>Encrypted / partition</h5>
							<p>For the <span class="highlight-3">encrypted /</span> you first need to format and open the raw device, <span class="highlight-3">/dev/sda3</span>, as an encrypted device, like the vg-crypt device above.</p>

<pre>
cryptsetup --verify-passphrase --cipher aes-xts-plain:sha512 luksFormat /dev/sda3
</pre>

<pre>
cryptsetup luksOpen /dev/sda3 cryptroot
</pre>

							<p>Format the created <span class="highlight-3">/dev/mapper/cryptroot</span> so it will show up in the installer:</p>

<pre>
/sbin/mkfs.ext4 /dev/mapper/cryptroot
</pre>

					  <h3>Open the installer</h3>
							<p><b>Now you are ready to run the installer where you should use:</b><br />
							<span class= "highlight-3">sda1</span> for <span class= "highlight-3">/boot</span>,<br />
							<span class= "highlight-3">sda2</span> for <span class= "highlight-3">swap</span> and, <br />
							<span class= "highlight-3">cryptroot</span> for <span class= "highlight-2"> /</span> and <span class= "highlight-3"> /home</span>.</p>

							<p>The installed system should end up with a kernel command line including the following options (though your UUID will be used):</p>
<pre>
root=/dev/mapper/cryptroot cryptopts=source=UUID=12345678-1234-1234-1234-1234567890AB,target=cryptroot
</pre>
							<p>You now have /boot in a plain partition, an encrypted password protected swap along with an encrypted root and /home.</p>

			      </div>
				  <h3>Sources and Resources:</h3>
							<p>Required reading:</p>

<pre>
man cryptsetup
</pre>
							<p><a href="http://code.google.com/p/cryptsetup/">LUKS</a>.</p>

							<p><a href="http://www.redhat.com/">Redhat</a> and <a href="http://www.redhat.com/Fedora/">Fedora </a>.</p>

							<p><a href="http://www.enterprisenetworkingplanet.com/netsecur/article.php/3683011"> Protect Your Stuff With Encrypted Linux Partitions</a>.</p>

							<p><a href="http://blog.bodhizazen.net/linux/kvm-how-to-use-encrypted-images/">KVM how to use encrypted images</a>.</p>

							<p><a href="http://aptosid.com/index.php?module=wikula&amp;tag=FullDiskEncryptionTheDebianWay">aptosid wiki</a>.</p>

	<div id="rev">Page last revised 06/11/2010 1350 UTC</div>

</div>
</body>
</html>
