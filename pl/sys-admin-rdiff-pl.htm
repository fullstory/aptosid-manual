<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>sidux Manuals - rdiff</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<div id="menu"> <!-- menu starts here pl lang maintainer maslot-->
<!--Welcome to the Official sidux-manual  01.21-2007-07-20 -->
<!-- menu last updated by bluewater 20/07/2007 1300rs AEST 20/07/2007 0300hrs UTC -->
<img src="../lib/logos/sidux-logo.png" alt="logo" id="menu-header" />
	<ul id="top-list">
		<li><a href="http://sidux.com/">To sidux.com</a></li>
		<li><a href="http://manual.sidux.com/meta-manual">sidux Meta-Manual</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-lang-50.png" title="Choose another language" alt="lang-switch" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-pl.htm">OS instrukcji sidux</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-pl.htm#welcome-gen">OS instrukcji sidux</a></li>
				<li><a href="welcome-pl.htm#how-to">Jak korzystać z tej instrukcji</a></li>
				<li><a href="welcome-pl.htm#table-contents">Spis treści</a></li>
				<li><a href="help-pl.htm#help-gen">Gdzie otrzymać pomoc</a></li>
				<li><a href="credits-pl.htm#cred-team">Autorzy</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-content-pl.htm">Zawartość CD</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-pl.htm#cd-content">Zawartość CD</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="cd-dl-burning-pl.htm">Pobieranie i wypalanie CD</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="cd-dl-burning-pl.htm#download-sidux">Pobieranie i wypalanie CD</a></li>
				<li><a href="cd-dl-burning-pl.htm#md5">Suma kontrolna md5</a></li>
				<li><a href="cd-dl-burning-pl.htm#burn-nero">Wypalanie CD w Windows</a></li>
				<li><a href="cd-dl-burning-pl.htm#burn-linux">Wypalanie CD w Linuksie</a></li>
				<li><a href="cd-dl-burning-pl.htm#xdelta">Korzystanie z xdelta</a></li>
				<li><a href="cd-no-gui-burn-pl.htm">Wypalenie CD bez GUI</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="live-mode-pl.htm">Tryb Live</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="live-mode-pl.htm#rootpw">Hasło roota na sidux-LiveCD?</a></li>
				<li><a href="live-mode-pl.htm#live-cd-installsoft">Instalowanie oprogramowania w trakcie sesji Live-CD</a></li>
				<li><a href="live-mode-pl.htm#ntfs-3g">Zapisywanie na partycji NTFS przy pomocy ntfs-3g</a></li>
		</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="term-konsole-pl.htm">Terminal/Konsola</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="term-konsole-pl.htm#konsole">Terminal/Konsola</a></li>
				<li><a href="term-konsole-pl.htm#cli-help">Pomoc dla linii komend</a></li>
				<li><a href="term-konsole-pl.htm#term-cmds">Lista poleceń konsoli</a></li>
				<li><a href="term-konsole-pl.htm#shell-scripts">Instalowanie skryptów.sh</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="cheatcodes-pl.htm">Opcje startowe</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="cheatcodes-pl.htm#cheatcodes">Opcje startowe</a></li>
				<li><a href="cheatcodes-vga-pl.htm#vga">Opcje startowe dla VGA</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="part-gparted-pl.htm">Partycjonowanie twardego dysku</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="part-gparted-pl.htm#partition">Partycjonowanie HD przy pomocy GParted</a></li>
				<li><a href="part-gparted-pl.htm#ntfs">Zmiana rozmiaru partycji NTFS przy pomocy GParted</a></li>				
				<li><a href="part-uuid-pl.htm#uuid">UUID, nazywanie partycji i fstab</a></li>
				<li><a href="part-cfdisk-pl.htm#partition">Partycjonowanie HD przy pomocy cfdisk</a></li>
				<li><a href="part-cfdisk-pl.htm#formating">Formatowanie partycji po partycjonowaniu przy pomocy cfdisk</a></li>
			<li><a href="part-size-examp-pl.htm#part-example">Przykład podziału na partycje</a></li>
		</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hd-install-pl.htm">Opcje instalacji</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hd-install-pl.htm#Inst-prep">Przygotowanie do instalacji</a></li>
				<li><a href="hd-install-pl.htm#Installation">Instalacja na twardy dysk</a></li>
				<li><a href="hd-install-pl.htm#first-hd-boot">Pierwsze uruchomienie systemu</a></li>
				<li><a href="hd-install-opts-pl.htm#fromiso">Uruchamianie 'fromiso'</a></li>
				<li><a href="hd-install-opts-pl.htm#usb-hd">Instalacja na USB-HD</a></li>
				<li><a href="hd-install-opts-pl.htm#qemu">Instalacja poprzez QEMU</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-pl.htm">Karty graficzne, pozostały sprzęt i sterowniki</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="hw-dev-hw-dri-pl.htm#hd-ntfs3g">Zapisywanie na NTFS</a></li>
				<li><a href="hw-dev-hw-dri-pl.htm#mon-res">Rozdzielczość ekranu i monitory</a></li>
				<li><a href="hw-dev-hw-dri-pl.htm#non-free-3d">Binarne, niewolne sterowniki dla: Nvidia / ATI</a></li>
				<li><a href="hw-dev-hw-dri-pl.htm#native-nv-ati">Wolne sterowniki xorg dla nVidia, ATI, Radeon, Intel</a></li>
				<li><a href="hw-dev-hw-dri-pl.htm#non-free">Sprzęt potrzebujący niewolnych sterowników</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="wm-kde-pl.htm">Menadżery okien</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="wm-kde-pl.htm#desk-freeze">Pulpit KDE przestaje reagować</a></li>
				<li><a href="wm-kde-pl.htm#kde-login">Brak możliwości logowania do KDE</a></li>
				<li><a href="wm-kde-pl.htm#ch-th">Zmiana tematów</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="lamp-apache-pl.htm">System LAMP sidux</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="lamp-apache-pl.htm#serv-apache">system LAMP sidux</a></li>
				<li><a href="lamp-apache-pl.htm#serv-ftp">klienty FTP</a></li>
				<li><a href="lamp-apache-pl.htm#serv-sec">Protokoły bezpieczeństwa</a></li>
				<li><a href="lamp-apache-pl.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-pl.htm#serv-mysql">Konfiguracja MySQL</a></li>
				<li><a href="lamp-ppp-pl.htm#serv-php">PHP w Apache</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-apt-pl.htm">Instalowanie/Usuwanie i instalowanie starszej wersji pakietu</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="sys-admin-apt-pl.htm#apt-cook">Przewodnik po APT /  Sources list</a></li>
				<li><a href="sys-admin-meta-pl.htm#meta-pack">Instalator metapakietów</a></li>
				<li><a href="sys-admin-meta-pl.htm#meta-proxy">Instalator metapakietów i proxy</a></li>
				<li><a href="sys-admin-apt-pl.htm#apt-install">Instalowanie nowych pakietów</a></li>
				<li><a href="sys-admin-apt-pl.htm#apt-delete">Usuwanie pakietu</a></li>
				<li><a href="sys-admin-apt-pl.htm#apt-downgrade">Instalowanie starszej wersji pakietu</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 14 );" onmouseout="startTime();" ><a href="sys-admin-apt-pl.htm">Administracja systemem</a>
			<ul class="sub-menu" id="sm14">
				<li><a href="sm-siduxcc-pl.htm#sm">smxi Syntax Command Sets</a></li>
				<li><a href="sm-siduxcc-pl.htm#siduxcc">siduxcc</a></li>
				<li><a href="sys-admin-apt-pl.htm#apt-upgrade">Aktualizacja systemu</a></li>
				<li><a href="sys-admin-upgrade-pl.htm#live-cd-upgrade">Aktualizacja przy użyciu Live-CD</a></li>
				<li><a href="sys-admin-kern-upg-pl.htm#kern-upgrade">Aktualizacja kernela</a></li>
				<li><a href="sys-admin-rdiff-pl.htm#rdiff">Backup przy pomocy rdiff</a></li>
				<li><a href="sys-admin-rsync-pl.htm#rsync">Backup przy pomocy rsync</a></li>
				<li><a href="vir-rkits-pl.htm#virus-rkits">Skanery wirusów i rootkitów</a></li>
				<li><a href="sys-admin-gen-pl.htm#start-services">Włączanie usług </a></li>
				<li><a href="sys-admin-gen-pl.htm#pw-lost">Utrata hasła roota</a></li>
				<li><a href="sys-admin-gen-pl.htm#fonts">Fonty</a></li>
				<li><a href="sys-admin-gen-pl.htm#cups">CUPS</a></li>
				<li><a href="sys-admin-grub-bootman2-pl.htm#mbr-grub-boot">Nadpisanie MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-pl.htm#dual-boot">Dual and Multibooting</a></li>
				<li><a href="sys-admin-grub-bootman2-pl.htm#boot-grub-floppy">Tworzenie dyskietki startowej</a></li>
				<li><a href="sys-admin-grub-bootman2-pl.htm#remove-grub">Usuwanie gruba z MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-pl.htm#what-is-grub">Menadżer uruchamiania - Grub</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="internet-connecting-pl.htm">Internet i sieć</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="ntp-server-pl.htm#ntp-server">Konfiguracja serwera czasu</a></li>
				<li><a href="tor-privoxy-pl.htm#tor">Tor</a></li>
				<li><a href="tor-privoxy-pl.htm#privoxy">Privoxy</a></li>
				<li><a href="internet-connecting-pl.htm#firewalls">Firewalle</a></li>
				<li><a href="samba-pl.htm#configure">Konfiguracja Samba (Windows)</a></li>
				<li><a href="samba-pl.htm#setup">Konfiguracja serwera Samba</a></li>
				<li><a href="ssh-pl.htm#ssh-fs">Zdalne montowanie zasobów przez SSH</a></li>
				<li><a href="ssh-pl.htm#ssh-x">Aplikacje X Window poprzez SSH</a></li>
				<li><a href="ssh-pl.htm#ssh-f">GUI SSH z Konquerorem</a></li>
				<li><a href="ssh-pl.htm#ssh-w">SSH + X z komputera z Windows</a></li>
				<li><a href="ssh-pl.htm#ssh-s">Konfiguracja SSH</a></li>
				<li><a href="ssh-pl.htm#ssh">SSH i bezpieczeństwo</a></li>
				<li><a href="internet-connecting-pl.htm#dial-mod">Modemy 56k</a></li>
				<li><a href="internet-connecting-pl.htm#ndiswrapper">Uruchamianie Ndiswrapper</a></li>
				<li><a href="internet-connecting-wpa-pl.htm#wpa">WIFI-wlan</a></li>
				<li><a href="internet-connecting-pl.htm#internetsharing">Dzielenie internetu</a></li>
				<li><a href="internet-connecting-pl.htm#netcardconfig">Konfiguracja internetu</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --></div>
<div id="main-page">
	<div class="divider" id="rdiff">
			<h2 id="top-header">Tworzenie kopii zapasowej przy pomocy rdiff-backup</h2>
				<p>rdiff-backup jest narzędziem do robienia kopii zapasowej twoich plików. (Może działać na wielu różnych portach *nix ).<br />
				Z siduksem jesteś w komfortowej sytuacji, ponieważ masz wybór sposobu inicjacji procesu, DIY (Do IT Yourself - zrób to sam) lub skryptowa</p>

				<p><a href="http://techpatterns.com/forums/about831.html">To jest skryptowa wersja h2</a></p>

			<h5>Tu zostanie opisana wersja DIY</h5>

			<h6>rdiff-backup</h6>

				<p class="highlight-2">Uruchamiaj polecenia jako root w konsoli, chyba że instrukcje będą inne.</p>

				<p>*świetne do przywrócenia systemu po nieudanej aktualizacji systemu, kernela itp. (i także do przywrócenia pojedynczych plików).<br />
				*robi kopię zapasową tego co się zmieniło, tak jak rsync (więc każdy backup nie trwa długo).<br />
				*zachowuje historię zmian (co oznacza, że możesz przywrócić plik, który usunąłeś trzy tygodnie temu!)<br />
				*zabezpiecza backupy poprzez sieć (używając ssh).<br />
				*tworzy kopię partycji, gdy są zamontowane (więc łatwo zautomatyzować codzienny backup ... nie potrzebne odmontowywanie).<br />
				*Może odzyskać wszystko, jeśli twój twardy dysk zepsuje się i będziesz musiał kupić nowy.<br />
				*skalowalny do tworzenia kopii zapasowej wielkich sieci i jest używany przez przedsiębiorstwa.<br />
				*jest aplikacją linii poleceń, co jest świetne dla tych, którzy wykonują takie zadania jak automatyczne kopie zapasowe (np. skrypty bash uruchamiane przez cron).<br />
				*zapamiętuje i radzi sobie z uprawnieniami plików, a także obsługuje skróty symboliczne, więc kiedy przywrócisz dane, będą one dokładnie w tej samej postaci.</p>

			<h6>Czego potrzebujesz</h6>
				<p>rdiff-backup przechowuje całą (nieskompresowaną) kopię plików, a także historię (przyrostowe kopie zapasowe), co oznacza, że miejsce do przechowywania twojej kopii zapasowej musi być większe niż to, co chcesz zachować. Jeśli tworzyć kopię 100 GB danych, możesz potrzebować 120 GB przestrzeni (najlepiej na oddzielnym dysku!).</p>

			<h6>Konfiguracja</h6>
				<p>Załóżmy, że twój pc ma nastepujące parametry:<br />
				* twardy dysk 100 GB (hda), który jest używany, hda1 używany jako partycja główna, hda5 przechowuje muzykę i inne pliki i hda6 to swap.<br />
				* dodatkowy twardy dysk 200 GB (hdb), który nie jest używany, z jedną partycją hdb1, którą użyjemy na kopie zapasowe.<br />
				* Adres IP 192.168.0.1</p>

				<p>Najpierw należy zainstalować rdiff-backup:</p>
<pre>
# apt-get install rdiff-backup
</pre>
				<p>Chociaż możesz zrobić kopię zapasową dowolnego katalogu, zakładamy, że zrobimy kopię całej partycji. Chcemy zrobić backup hda1 i hda5 (nie chcemy kopii hda6), a więc stworzymy katalogi do przechowywania danych:</p>
<pre>
# mkdir /media/hdb1/rdiff-backups/192.168.0.1/root
# mkdir /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>Musisz użyć adresu IP, ponieważ będzie to przydatne przy tworzeniu kopii zapasowej innego komputera (omówione w dalszej części instrukcji).</p>

			<h6>Tworzenie kopii bezpieczeństwa</h6>

				<p>rdiff-backup używa składni <span class="highlight-3">rdiff-backup katalog-źródłowy katalog-docelowy</span>. Uwaga: zawsze określaj nazwy katalogów, a nie nazwy plików.</p>

				<p>Aby stworzyć kopię hda5, wykonaj polecenie:</p>
<pre>
# rdiff-backup /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>Aby zrobić kopię partycji głównej, uruchom:</p>
<pre>
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/hdb1/rdiff-backups/192.168.0.1/root
</pre>
				<p>Wszystkie błędy "AF_UNIX path too long" mogą zostać zignorowane. Proces może potrwać chwilę, ponieważ jest to pierwszy raz, kiedy tworzona jest kopia zapasowa, więc rdiff-backup będzie musiał zrobić kopię całej partycji (nie tylko różnice). Zwróć uwagę, że nie robimy kopii /tmp, ponieważ ciągle się zmienia, ani /proc lub /sys, ponieważ one nie zawierają prawdziwych plików, nie chcemy także tworzyć kopii montowanych zasobów. Jeśli zrobiłbyś kopię /media, wtedy robiłbyć kopię hdb1, co doprowadziłoby do nieskończonej pętli! Sposobem na to jest tworzenie backupów osobno.</p>

				<p>Powodem, dla którego należy wpisać '/proc/*' zamiast samego '/proc', jest to, że pierwszy wariant będzie tworzył kopię samej nazwy katalogu /proc, a zignoruje wszystko inne. To samo jest prawdziwe dla /tmp, /sys, oraz dla nazw punktów montowania.</p>

				 <p>W ten sposób, jeśli zniszczysz partycję główną i dokonasz pełnego przywrócenia partycji, /tmp, /proc, /sys i punkty montowania zostaną stworzone (tak jak powinny). Jeśli /tmp nie będzie istniał, kiedy X zostanie uruchomiony, mogą się pojawić komunikaty o błędach (Patrz: strona man, aby zdobyć więcej informacji o --exclude i --include).</p>

			<h6>Przywracanie katalogów z kopii zapasowej</h6>

				<p>rdiff-backup używa składni:</p>
<pre>
rdiff-backup -r &lt;skąd&gt; &lt;katalog-źródłowy&gt; &lt;katalog-docelowy&gt;
</pre>
				<p>Teraz, jeśli przypadkowo skasowałeś katalog /media/hda7/photos, możesz przywrócić go przy pomocy:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5/photos /media/hda5/photos
</pre>
				<p>Opcja "-r now" oznacza przywrócenie z ostatniej kopii bezpieczeństwa. Jeśli tworzyłeś backupy okresowo (np. przez crontab), i nie zauważyłeś, że katalog photos zaginął kilka dni temu, będziesz potrzebował dokonać przywrócenia danych z backupu z przed kilku dni (a nie "now", ponieważ otrzymasz komunikat, że katalog photos nie istnieje). A może po prostu chcesz przywrócić wcześniejszą wersję danych.</p>

				<p>Jeśli chcesz przywrócić dane z przed 3 dni, użyj opcji "-r 3D", ale zwróć uwagę:</p>

				<p class="highlight-1">"3D" odnosi się do 72 godzin przed czasem obecnym i jeśli nie było żadnego backupu zrobionego w tym czasie, rdiff-backup przywróci stan z wcześniejszego backupu. Na przykład, w powyższym przypadku, jeśli użyta jest opcja "3D" i będą tylko kopie z przed 2 dni i z przed 4 dni, katalog zostanie przywrócony ze stanu z przed 4 dni (więc musisz myśleć o tym przed przywróceniem danych).</p>

				<p>Aby zrobić listę backupów zrobionych dla hda5, wykonaj polecenie:</p>
<pre>
# rdiff-backup -l /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
			<h5>Przywracanie partycji</h5>

				<p>Możesz także przywrócić całą partycję, przecież punkt montowania jest po prostu katalogiem.</p>

				<p class="highlight-2">UWAGA: Nie przywracaj partycji głównej, kiedy uruchomiłeś z niej system! Przy pomocy jednego polecenia stracisz wszystkie pliki na wszystkich partycjach, włączając w to wszystkie backupy na oddzielnym twardym dysku!! rdiff-backup robi dokładnie to, o co jest proszony. Jeśli backup dla partycji głównej ma puste punkty montowania, aby przywrócić zachowane dane, skasuje wszystko na zamontowanych napędach, żeby wszystko było identyczne z  backupem.</p>

				<p>Aby przywrócić hda5 z ostatniego backupu, po prostu wpisujemy:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5 /media/hda5
</pre>
			<h5>Przywracanie partycji głównej</h5>

				<p>Przywracanie partycji głównej nie jest takie łatwe. Nie przywracaj partycji głównej, gdy jest zamontowana (patrz powyższe ostrzeżenie). Naprawdę użyteczna jest możliwość przywrócenia partycji głównej, kiedy zepsujesz coś przy instalacji/aktualizacji czy instalowaniu nowego kernela, a przywrócenie stanu poprzedniego potrwa tylko 20 minut.</p>

				<p>Jedną z metod przywrócenia partycji głównej jest start z dodatkowej partycji linuksowej, jeśli masz taką na twardym dysku. Wtedy będziesz mógł przywrócić partycję główną, ponieważ nie będzie zamontowana jako root ("/"). Po przywróceniu partycji, wystartuj z niej, a będzie dokładnie taka sama jak poprzednio! To jest najprostsza metoda.</p>

				<p>Inną metodą przywrócenia partycji głównej jest wystartowanie z sidux-live cd. rdiff-backup jest włączony do siduksa. W przypadku, gdy wersja sidux live-cd, którą posiadasz nie zawiera rdiff, możesz wpisać w linii poleceń gruba (Opcje startowe) "unionfs", co spowoduje, że będziesz mógł instalować aplikacje na live cd. Po prostu wystartuj i wpisz następujące polecenia:</p>
<pre>
$ sudo su
# wget -O /etc/apt/sources.list http://sidux.com/files/misc/sources.list
# apt-get update
# apt-get install rdiff-backup
</pre>
				<h6>Teraz dokonajmy przywrócenia partycji:</h6>
<pre>
# mount /dev/hda1 /media/hda1
# mount /dev/hdb1 /media/hdb1
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>Uwaga: Jeśli nie masz sidux CD i twoje Live-CD wspiera klik, możesz zainstalować przy użyciu Klik:</p>
<pre>
$ sudo ~/.zAppRun ~/Desktop/rdiff-backup_0.13.4-5.cmg rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>Zaleca się, aby każdy, kto tworzy kopię zapasową partycji głównej (z intencją przywrócenia jej, jeśli zajdzie taka potrzeba) powinien przetestować proces przywracania. </p>

			<h5>Tworzenie kopii zapasowej dysku innego komputera</h5>

				<p>Możesz tworzyć kopie zapasowe dysku innego komputera na twoim komputerze, jeśli lokalny komputer może połączyć się z innym przy pomocy ssh (i jeśli masz wolne miejsce na lokalnym komputerze). Serwer ssh (sshd) musi działać na zdalnym  pc. Drugi komputer nie musi być w lokalnej sieci.</p>

				<p>Załóżmy, że zdalny komputer posiada:<br />
				1) dysk twardy 100 GB (hda), który jest w użyciu, z zamontowanymi zasobami,<br />
				2) hda1 użyte jako partycja główna,<br />
				3) hda5 przechowuje niektóre pliki tymczasowe, których nie chcemy zachowywać,<br />
				4) i hda6 na swap <br />
				5) adres IP to 192.168.0.2</p>

				<p>Uwaga: oba dyski 100 GB nie mogą mieć kopii zapasowej na 200 GB dysku przy użyciu rdiff-backup (ponieważ nie będzie miejsca na przyrostowe pliki), ale ponieważ nie robisz kopii hda5 na zdalnym pc (i ponieważ twarde dyski nie są zwykle pełne, chociaż nie polegaj na tym) to możesz założyć, że jest wystarczająco miejsca. Za każdym razem, kiedy rdiff-backup wykona kolejny backup, coraz więcej przyrostowych plików będzie tworzone, i zajmie to coraz więcej miejsca.</p>

				<p>Możesz nakazać rdiff-backup, aby zachowywał jedynie backupy nie starsze niż 1 miesiąc (polecenie to będzie pokazane później), a wtedy mniej miejsca będzie wykorzystane na pliki przyrostowe. </p>

				<p>Pierwszą rzeczą jest zainstalowanie rdiff-backup na zdalnej maszynie (każdy komputer, którego dysku chcesz wykonać kopię zapasową musi mieć zainstalowany rdiff-backup).</p>

				<p>Aby zrobić kopie zapasową zdalnego pc na lokalnym, uruchom na lokalnym pc (np. 192.168.0.1): <span class="highlight-4">Zwróć uwagę na użycie podwójnych dwukropków :: </span></p>
<pre>
# mkdir /media/hdb1/rdiff-backups/192.168.0.2/root
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' 192.168.0.2::/media/hdb1/rdiff-backups/192.168.0.2/root
</pre>
				<p>Teraz, jeśli chcesz przywrócić katalog na zdalnym pc, uruchom przywracanie albo na lokalnym, albo na zdalnym komputerze.</p>

				<p>Tak przywrócisz katalog /usr/local/games na zdalnym komputerze, inicjując proces ze zdalnego komputera:</p>
<pre>
# rdiff-backup -r now 192.168.0.1::/media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games /usr/local/games
</pre>
				<p>Tak przywrócisz katalog /usr/local/games na zdalnym komputerze, inicjując proces z lokalnego komputera:</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games 192.168.0.2::/usr/local/games
</pre>
				<p>Użyj taką samą składnię, kiedy przywracasz partycję główną z live cd (zdalny pc został uruchomiony przy pomocy live cd - patrz powyżej).</p>

			<h5>Automatyczne kopie bezpieczeństwa:</h5>

				<p>Jeśli wykonujesz kopie bezpieczeństwa innego komputera na swojej lokalnej maszynie, najpierw uaktywnij bezhasłowe logowanie ssh przy użyciu kluczy ssh. <span class="highlight-2">Zwróć uwagę, że mowa o bezhasłowym logowaniu ssh jako root. Można to zrobić w ten sposób, by tylko polecenie rdiff-backup było wykonywane, ale ta kwestia jest poza tematem tej instrukcji - patrz <a href="samba-pl.htm#ssh-s">Konfiguracja SSH</a> </span>  Zakładamy pełne zaufanie i ustawimy najprostszy sposób osiągnięcia bezhasłowego logowania ssh.</p>

				<p>Z lokalnego pc, wykonaj następujące polecenie:</p>
<pre>
# [ -f /root/.ssh/id_rsa ] || ssh-keygen -t rsa -f /root/.ssh/id_rsa
</pre>
				<p>I wciśnij dwa razy enter dla braku hasła. Następnie wykonaj polecenie:</p>
<pre>
# cat /root/.ssh/id_rsa.pub | ssh 192.168.0.2 'mkdir -p /root/.ssh;\<!--dunno if this is wrong-->
> cat - >>/root/.ssh/authorized_keys2'
</pre>
				<p>Zostaniesz poproszony o hasło roota.</p>

				<p>Teraz możesz uruchomić ssh na zdalnym komputerze jako root bez wpisywania hasła i rdiff-backup może być automatyzowany.</p>

				<p>Następnie, stwórz skrypt basha, który zawiera wszystkie polecenia rdiff-backup. Nasz skrypt basha może wyglądać tak:</p>


<pre>
#!/bin/bash
RDIFF=/usr/bin/rdiff-backup
echo
echo "=======Backing up 192.168.0.1 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/hdb1/rdiff-backups/192.168.0.1/root
echo "(and purge increments older than 1 month)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/root
echo
echo "=======Backing up 192.168.0.1 mount hda5======="
${RDIFF} --ssh-no-compression --exclude /media/hda5/myjunk /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo
echo "=======Backing up 192.168.0.2 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' --exclude '/mnt/*/*' 192.168.0.2::/media/hdb1/rdiff-backups/192.168.0.2/root
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.2/root
</pre>


				<p>Teraz możesz nazwać ten skrypt "myrdiff-backups.bash" i umieścić go /usr/local/bin na naszej lokalnej maszynie (backup serwer) i nadać mu atrybut wykonywalności. Uruchom skrypt i sprawdź, czy działa.</p>

				<p>Na koniec możesz przy użyciu crona uruchamiać go każdego wieczora o 20:00. Następująca linia w crontabie roota będzie mieć ten skutek:</p>
<pre>
# crontab -e
i wpisz następującą linię
0 20 * * * /usr/local/bin/myrdiff-backups.bash
</pre>

			<div id="rev">Strona ostatnio modyfikowana 11/06/2007 1800 UTC</div>
</div>
</div>
</body>
</html>
