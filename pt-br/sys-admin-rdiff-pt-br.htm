<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>Manuais do aptosid - rdiff (RO)</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<!-- Last translation revision by ceti 13/08/2009 1044 hrs UTC -->
<div id="menu"> <!-- menu starts here pt-br lang maintained by ceti-->
<!--aptosid Operating System Manual menu-version-02.11.2011.04.23 -->
<!-- menu last updated by bluewater 2011.04.26 1425 hrs UTC -->
	<div id="menu-header">
	      <a href="http://aptosid.com/"><img src="../lib/logos/manual-aptosid-logo.png" title="Ir para aptosid.com forums e wiki" alt="aptosid.com logo" /></a>
	</div>
	<ul id="top-list">
		<li><a href="manual-search-pt-br.htm#search-on"><img src="../lib/logos/manual-search-22x22.png" title="Search Manual" alt="Search" /> Procurar Online Offline</a> </li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/aptosid-lang-100x64.png" title="Escolha outra língua - Choose another language" alt="troca-língua" /></a>
	</div>
	<ul>
<li onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-pt-br.htm">Manual do Sistema Operacional aptosid</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-pt-br.htm#welcome-gen">Manual do SO aptosid &#8658;</a>
					<ul class="sub2-menu" id="sm1a">
					  <li><a href="credits-pt-br.htm#cred-team">Créditos</a></li>
					</ul>
					</li>
		<li><a href="welcome-pt-br.htm#how-to">Como usar este manual &#8658;</a>
					<ul class="sub2-menu" id="sm1b">
					  <li><a href="welcome-pt-br.htm#how-to">Como usar este manual</a></li>
					  <li><a href="welcome-pt-br.htm#table-contents">Índice</a></li>
					</ul>
					</li>
		<li><a href="help-pt-br.htm#help-gen">Como conseguir ajuda &#8658;</a>
					<ul class="sub2-menu" id="sm1c">
					  <li><a href="help-pt-br.htm#help-gen">Onde e como obter ajuda</a></li>
					  <li><a href="help-pt-br.htm#paste">IRC !paste</a></li>
					</ul>
					</li>
		<li><a href="wel-quickstart-pt-br.htm#welcome-quick">Guia Rápido do aptosid</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-dl-burning-pt-br.htm">Conteúdo das ISOs, lançamentos, espelhos e como queimar</a>
			   <ul class="sub-menu" id="sm2">
				<li><a href="cd-content-pt-br.htm#cd-content">Conteúdo das ISOs e requisitos do sistema &#8658;</a>
					<ul class="sub2-menu" id="sm2a">
					  <li><a href="sys-admin-release-pt-br.htm#rolling">Notas de Lançamento</a></li>
					</ul>
					</li>
		    <li><a href="cd-dl-burning-pt-br.htm#download-aptosid">Espelhos ('mirrors') do aptosid, como baixar e como queimar &#8658;</a>
				<ul class="sub2-menu" id="sm2b">
					  <li><a href="cd-dl-burning-pt-br.htm#md5">Como verificar o md5</a></li>
					  <li><a href="cd-dl-burning-pt-br.htm#burn-nero">Como queimar no Windows</a></li>
					  <li><a href="cd-dl-burning-pt-br.htm#burn-linux">Como queimar no Linux</a></li>
					  <li><a href="cd-no-gui-burn-pt-br.htm#burning-no-gui">O script burniso</a></li>
					  <li><a href="cd-no-gui-burn-pt-br.htm#burn-no-gui-gen">Como queimar sem interface gráfica</a></li>
					  <li><a href="cd-dl-burning-pt-br.htm#download-aptosid">Espelhos para baixar o aptosid</a></li>
					</ul>
					</li>
		      </ul>
		</li>
<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="live-mode-pt-br.htm">O modo Live</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="live-mode-pt-br.htm#rootpw">Senha do root na ISO aptosid-Live</a></li>
				<li><a href="live-mode-pt-br.htm#live-cd-installsoft">Como instalar software estando no modo Live-ISO</a></li>
			</ul>
		</li>
<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="term-konsole-pt-br.htm">Terminal / Konsole</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="term-konsole-pt-br.htm#term-kon"> Terminal / Konsole &#8658;</a>
					<ul class="sub2-menu" id="sm4a">
					  <li><a href="term-konsole-pt-br.htm#term-kon"> Terminal / Konsole</a></li>
					  <li><a href="term-konsole-pt-br.htm#colours"> Coloured terminal prompts</a></li>
					  <li><a href="term-konsole-pt-br.htm#cli-help">Ajuda pela linha de comando</a></li>
					  <li><a href="help-pt-br.htm#init3-tools">Ferramentas a conhecer no modo texto (tty) - init 3</a></li>
					  <li><a href="term-konsole-pt-br.htm#term-cmds">Lista de comandos de Terminal no Linux</a></li>
					</ul>
					</li>
			  <li><a href="term-konsole-pt-br.htm#sux"> sux / sudo</a></li>
		    </ul>
		</li>
<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="cheatcodes-pt-br.htm">"Cheatcodes"</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="cheatcodes-pt-br.htm#cheatcodes">Cheatcodes específicas da Live-ISO do aptosid</a></li>
				<li><a href="cheatcodes-pt-br.htm#cheatcodes-linux">Cheatcodes genéricas do Linux</a></li>
				<li><a href="cheatcodes-vga-pt-br.htm#vga">Códigos VGA</a></li>
			</ul>
		</li>
<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="part-gparted-pt-br.htm">Como particionar seu HD</a>
		<ul class="sub-menu" id="sm6">
			<li><a href="part-gparted-pt-br.htm#hd-ntfs3g">Escrevendo em partições NTFS com o ntfs-3g</a></li>
			<li><a href="part-lvm-pt-br.htm#part-lvm">Partitioning to use LVM - Logical Volume Manager</a></li>
			<li><a href="part-gparted-pt-br.htm#partition">Como particionar pela interface gráfica &#8658;</a>
					<ul class="sub2-menu" id="sm6a">
					  <li><a href="part-gparted-pt-br.htm#partition">Como particionar o HD usando GParted / Gerenciador de partições do KDE</a></li>
					  <li><a href="part-gparted-pt-br.htm#ntfs">Como redimensionar a partição NTFS com o GParted / Gerenciador de partições do KDE</a></li>
					</ul>
					</li>
		<li><a href="part-cfdisk-pt-br.htm#partition">Como particionar pela linha de comando &#8658;</a>
					 <ul class="sub2-menu" id="sm6b">
					    <li><a href="part-cfdisk-pt-br.htm#partition">Como particionar seu HD com o cfdisk</a></li>
					    <li><a href="part-cfdisk-pt-br.htm#formating">Como formatar após o particionamento com o cfdisk</a></li>
					</ul>
					</li>
		<li><a href="part-size-examp-pt-br.htm#part-example">O básico do particionamento &#8658;</a>
					<ul class="sub2-menu" id="sm6c">
					  <li><a href="part-size-examp-pt-br.htm#part-example">Exemplos de tamanhos de partições</a></li>
					  <li><a href="part-uuid-pt-br.htm#uuid">UUID, Rebuilding fstab and creating new mount points</a></li>
					  <li><a href="part-cfdisk-pt-br.htm#disknames">Uma geral sobre nomeação de discos</a></li>
					</ul>
					</li>
		      </ul>
		</li>
<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="hd-install-pt-br.htm">Opções de instalação - HD, USB, VM and Cryptroot</a>
		<ul class="sub-menu" id="sm7">
		  <li><a href="hd-install-pt-br.htm#Inst-prep">Preparação &#8658;</a>
					<ul class="sub2-menu" id="sm7a">
					  <li><a href="hd-install-pt-br.htm#Inst-prep">Preparação da instalação </a></li>
					  <li><a href="hd-install-pt-br.htm#Installation">Como instalar no HD</a></li>
					  <li><a href="hd-install-pt-br.htm#first-hd-boot">Primeira inicialização</a></li>
					</ul>
					</li>
		<li><a href="hd-install-opts-pt-br.htm#fromiso">Como dar o 'boot' com fromiso &#8658;</a>
					<ul class="sub2-menu" id="sm7b">
					  <li><a href="hd-install-opts-pt-br.htm#fromiso">Como inicializar com fromiso - visão geral</a></li>
					  <li><a href="hd-install-opts-pt-br.htm#grub2-fromiso">Como inicializar com 'fromiso' e Grub 2</a></li>
					  <li><a href="hd-install-opts-pt-br.htm#fromiso-persist">fromiso e persist</a></li>
					</ul>
					</li>
		<li><a href="hd-install-opts-pt-br.htm#usb-hd">Como instalar em drives USB &#8658;</a>
					<ul class="sub2-menu" id="sm7c">
					  <li><a href="hd-install-opts-pt-br.htm#usb-hd">Como instalar em um HD-USB - específico do aptosid - aptosid-on-stick</a></li>
					  <li><a href="hd-ins-opts-oos-pt-br.htm#raw-usb">Instalando em dispositivo USB/SSD com qualquer sistema Linux, MS Windows ou Mac OSX</a></li>
					</ul>
					</li>
		  <li><a href="hd-install-crypt-pt-br.htm#install-crypt">Installing to encryted partitions - cryptroot</a></li>
		  <li><a href="nbdboot-pt-br.htm#nbd1">Inicializando o aptosid através de uma rede</a></li>
		  <li><a href="hd-install-vmopts-pt-br.htm#vmopts">Opções de instalação de Máquina Virtual</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="gpu-pt-br.htm">Placas de Vídeo, dispositivos diversos, xorg &amp;  drivers</a>
	<ul class="sub-menu" id="sm8">
		<li><a href="hw-dev-mon-pt-br.htm#mon-res">Monitores e resolução de tela &#8658;</a>
					<ul class="sub2-menu" id="sm8a">
					  <li><a href="hw-dev-mon-pt-br.htm#mon-res">Monitores e resolução de tela</a></li>
					  <li><a href="hw-dev-mon-pt-br.htm#xrandr">Monitores múltiplos (Dual Monitors) e a xrandr</a></li>
					  <li><a href="hw-dev-mon-pt-br.htm#mon-binary">Monitores múltiplos usando binários</a></li>
					</ul>
					</li>
		<li><a href="gpu-pt-br.htm#foss-xorg">GPU firmware &#8658;</a>
					<ul class="sub2-menu" id="sm8b">
					  <li><a href="gpu-pt-br.htm#ati-3d">AMD/ATI 3D drivers</a></li>
					  <li><a href="gpu-pt-br.htm#intel">Intel 2D and 3D drivers</a></li>
					  <li><a href="gpu-pt-br.htm#nvidia">Nvidia 3D drivers</a></li>
					  <li><a href="gpu-pt-br.htm#foss-xorg">Open Source Xorg drivers</a></li>
					</ul>
					</li>
			  <li><a href="nf-firm-pt-br.htm#fw-detect">Firmware detection - non-free </a></li>
			  <li><a href="nf-firm-pt-br.htm#non-free-firmware">Adding non-free to Sources List</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="wm-dm-pt-br.htm">Gerenciadores de janelas</a>
		    <ul class="sub-menu" id="sm9">
			  <li><a href="wm-dm-pt-br.htm">KDE and XFCE Gerenciadores de janelas &#8658;</a>
					  <ul class="sub2-menu" id="sm9a">
					    <li><a href="wm-dm-pt-br.htm#xfce-notes">Extras úteis para o Xfce</a></li>
					    <li><a href="wm-dm-pt-br.htm#install-add">Extras úteis para o KDE</a></li>
					    <li><a href="wm-dm-pt-br.htm#desk-freeze">Congelamentos do desktop</a></li>
					    <li><a href="wm-dm-pt-br.htm#kde-login">"Não consigo entrar no KDE"</a></li>
					    <li><a href="wm-dm-pt-br.htm#ch-th">Como mudar os temas</a></li>
					</ul>
					</li>
		      <li><a href="wm-dm-pt-br.htm#dm">Installing additional Display Managers</a></li>
		</ul>
		</li>
<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="inet-ceni-pt-br.htm">Conexão com a Internet, WiFi, LAN e redes</a>
		    <ul class="sub-menu" id="sm11">
			<li><a href="lamp-apache-pt-br.htm">aptosid LAMP Stack &#8658;</a>
					<ul class="sub2-menu" id="sm11a">
					    <li><a href="lamp-apache-pt-br.htm#serv-apache">aptosid LAMP Stack</a></li>
					    <li><a href="lamp-apache-pt-br.htm#serv-ftp">Clientes FTP</a></li>
					    <li><a href="lamp-apache-pt-br.htm#serv-sec">Protocolos de segurança</a></li>
					    <li><a href="lamp-apache-pt-br.htm#serv-ssl">SSL</a></li>
					    <li><a href="lamp-sql-pt-br.htm#serv-mysql">Configuração do MySQL</a></li>
					    <li><a href="lamp-ppp-pt-br.htm#serv-php">PHP no Apache</a></li>
					    <li><a href="ntp-server-pt-br.htm#ntp-server">Configuração do servidor de data/hora</a></li>
					</ul>
					</li>
		<li><a href="tor-privoxy-pt-br.htm#tor">Firewalls e privacidade &#8658;</a>
					<ul class="sub2-menu" id="sm11b">
					    <li><a href="tor-privoxy-pt-br.htm#tor">Tor</a></li>
					    <li><a href="tor-privoxy-pt-br.htm#privoxy">Privoxy</a></li>
					    <li><a href="inet-ceni-pt-br.htm#firewalls">Firewalls</a></li>
					</ul>
					</li>
		<li><a href="ssh-pt-br.htm#ssh-x">SSH e Samba &#8658;</a>
					<ul class="sub2-menu" id="sm11c">
						  <li><a href="samba-pt-br.htm#setup">Configuração do servidor Samba</a></li>
						  <li><a href="samba-pt-br.htm#configure">Como configurar o Samba (Windows)</a></li>
						  <li><a href="ssh-pt-br.htm#ssh-fs">Como montar um SSH remoto</a></li>
						  <li><a href="ssh-pt-br.htm#ssh-x">Aplicações do X via SSH</a></li>
						  <li><a href="ssh-pt-br.htm#ssh-f">SSH com o Konqueror</a></li>
						  <li><a href="ssh-pt-br.htm#ssh-w">SSH com X-Forwarding a partir do Windows</a></li>
						  <li><a href="ssh-pt-br.htm#ssh">SSH e segurança</a></li>
					</ul>
					</li>
		<li><a href="inet-ceni-pt-br.htm#netcardconfig">Conexões wifi &#8658;</a>
						<ul class="sub2-menu" id="sm11d">
						    <li><a href="inet-ceni-pt-br.htm#netcardconfig">Como ficar online - ceni</a></li>
						    <li><a href="inet-wpagui-pt-br.htm#wpa-roaming-gui">WiFi - interface WPA_</a></li>
						    <li><a href="inet-setup-pt-br.htm#net-set1">WiFi - como configurar o modo "Roaming"</a></li>
						    <li><a href="inet-wpa-pt-br.htm#wpa">WiFi - wpasupplicant</a></li>
						    <li><a href="inet-ifplug-pt-br.htm#hotswitch">Como permutar entre wifi e cabo</a></li>
					</ul>
					</li>
		<li><a href="inet-ceni-pt-br.htm#netcardconfig">Conexões com fio &#8658;</a>
						<ul class="sub2-menu" id="sm11e">
						    <li><a href="inet-ceni-pt-br.htm#dial-mod">Modems 56k</a></li>
						    <li><a href="inet-ceni-pt-br.htm#netcardconfig">Como ficar online - ceni</a></li>
					</ul>
					</li>
				</ul>
			    </li>
<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="sys-admin-apt-pt-br.htm">Gerenciamento de pacotes e dist-upgrade</a>
	<ul class="sub-menu" id="sm12">
		<li><a href="sys-admin-apt-pt-br.htm#apt-cook">Guia do APT e a sources list &#8658;</a>
					<ul class="sub2-menu" id="sm12a">
					    <li><a href="sys-admin-apt-pt-br.htm#apt-cook">Guia do APT e a sources list</a></li>
					    <li><a href="sys-admin-apt-pt-br.htm#apt-install">Como instalar um novo pacote</a></li>
					    <li><a href="sys-admin-apt-pt-br.htm#apt-delete">Como deletar um pacote</a></li>
					    <li><a href="sys-admin-apt-pt-br.htm#apt-downgrade">Pacotes em HOLD (espera) e como rebaixar pacotes</a></li>
					    <li><a href="sys-admin-apt-pt-br.htm#apt-cache">Como pesquisar pacotes com o apt-cache</a></li>
					    <li><a href="sys-admin-apt-pt-br.htm#gui-pacsea">Como pesquisar pacotes com a interface gráfica</a></li>
					</ul>
				</li>
		<li><a href="sys-admin-kern-upg-pt-br.htm#kern-upgrade">Como atualizar o kernel &#8658;</a>
					<ul class="sub2-menu" id="sm12b">
					    <li><a href="sys-admin-kern-upg-pt-br.htm#kern-remove">Como remover kernels</a></li>
					    <li><a href="sys-admin-kern-upg-pt-br.htm#kern-upgrade">Como atualizar o kernel</a></li>
					    <li><a href="sys-admin-kern-upg-pt-br.htm#dmakms">Como instalar módulos do kernel dinamicamente com o dmakms</a></li>
					</ul>
				</li>
		<li><a href="sys-admin-apt-pt-br.htm#apt-upgrade">Como atualizar todo o sistema -  dist-upgrade - visão geral &#8658;</a>
					<ul class="sub2-menu" id="sm12c">
					    <li><a href="sys-admin-upgrade-pt-br.htm#live-cd-upgrade">Atualização com uma Live-ISO</a></li>
					    <li><a href="sys-admin-apt-locarmirr-pt-br.htm#approx">dist-upgrade de múltiplos PCs em uma LAN</a></li>
					    <li><a href="sys-admin-apt-pt-br.htm#apt-upgrade">Como atualizar todo o sistema -  dist-upgrade - visão geral</a></li>
					    <li><a href="sys-admin-apt-pt-br.htm#du-st">Como atualizar todo o sistema -  dist-upgrade - os passos</a></li>
					</ul>
				  </li>
			    </ul>
		</li>
<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-gen-pt-br.htm">Administração do sistema</a>
	<ul class="sub-menu" id="sm13">
		<li><a href="bios-freedos-pt-br.htm#bois-prep">Como atualizar a BIOS com o FreeDOS</a></li>
		<li><a href="vir-rkits-pt-br.htm#virus-rkits">Antivirus  e caçadores de rootkits</a></li>
		<li><a href="hd-install-pt-br.htm#adduser">Como adicionar usuários e senhas &#8658;</a>
					<ul class="sub2-menu" id="sm13a">
					    <li><a href="hd-install-pt-br.htm#adduser">Como adicionar um novo usuário</a></li>
					    <li><a href="sys-admin-gen-pt-br.htm#pw-lost">Perda da senha root, nova senha</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-gen-pt-br.htm#start-services">Serviços e runlevels &#8658;</a>
					<ul class="sub2-menu" id="sm13b">
					    <li><a href="sys-admin-gen-pt-br.htm#start-services">Habilitar/desabilitar serviços</a></li>
					    <li><a href="sys-admin-gen-pt-br.htm#pkill">Killing a service or process</a></li>
					    li><a href="sys-admin-gen-pt-br.htm#init">Runlevels no aptosid - init</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-rsync-pt-br.htm#rsync">Como fazer backups do sistema &#8658;</a>
					  <ul class="sub2-menu" id="sm13c">
					    <li><a href="sys-admin-rdiff-pt-br.htm#rdiff">Backup com o rdiff</a></li>
					    <li><a href="sys-admin-rsync-pt-br.htm#rsync">Backup com o rsync</a></li>
					    <li><a href="home-pt-br.htm#home-bu">Como mover sua /home</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-gen-pt-br.htm#fonts">CUPS, fontes e som &#8658;</a>
					  <ul class="sub2-menu" id="sm13d">
					     <li><a href="sys-admin-gen-pt-br.htm#fonts">Fontes</a></li>
					     <li><a href="sys-admin-gen-pt-br.htm#cups">CUPS - sistema de impressão</a></li>
					     <li><a href="sys-admin-gen-pt-br.htm#sound">Mixadores de som</a></li>
					</ul>
					</li>
		<li><a href="sys-admin-grub2-pt-br.htm#grub2">Grub2 &#8658;</a>
					  <ul class="sub2-menu" id="sm13f">
					    <li><a href="sys-admin-grub2-pt-br.htm#chroot">Grub2 - Recovering Grub with chroot</a></li>
					    <li><a href="sys-admin-grub2-pt-br.htm#mbr-over-grub2">Grub2 - sobrescrição da MBR</a></li>
					    <li><a href="sys-admin-grub2-pt-br.htm#multi-os">Grub2 - boots duplos e múltiplos</a></li>
					    <li><a href="sys-admin-grub2-pt-br.htm#grub1-grub2">Grub2 - como atualizar a partir do Grub1</a></li>
					    <li><a href="sys-admin-grub2-pt-br.htm#grub2">Grub2 - visão geral</a></li>
					</ul>
					</li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>

<div id="main-page">
	<div class="divider" id="rdiff">
			<h2 id="top-header">Como Fazer Back-up do Sistema com o rdiff-backup</h2>
				<p>rdiff-backup é uma ferramenta usada para fazer back-ups (cópias) de seus arquivos. Ele roda em diversos sistemas *nix.</p>

				<p class="highlight-2">Rode os comandos como root no terminal/console, a menos que se diga outra coisa.</p>

				<p>* ótimo para recuperar dist-upgrades e atualizações do kernel que falharam etc (e também para restaurar arquivos individuais).<br />
				* só faz back-ups do que tiver sofrido alterações, como faz o rsync (donde cada back-up não demorar muito).<br />
				* mantém um histórico das mudanças (portanto, você pode recuperar um arquivo que você apagou três semanas atrás!)<br />
				* faz back-ups seguros pela rede (usando ssh).<br />
				* faz back-ups de partições enquanto estão montadas (portanto, é fácil automatizar back-ups diários... não há necessidade de desmontar).<br />
				* pode restaurar tudo se seu HD morrer e você tiver de comprar um novo.<br />
				* reconfigura-se para fazer back-ups de grandes redes (fácil no Linux; no Windows é mais complicado) e é usado em negócios.<br />
				* é um aplicativo de linha de comando, portanto é ótimo para quem gosta de fazer coisas como automatizar back-ups (usando um script chamado pelo cron).<br />
				* lembra e lida bem com donos de arquivos e permissões e também com links simbólicos (e todo esse tipo de coisa); assim, após uma restauração, tudo fica exatamente como era antes.</p>

			<h6>Do que você vai precisar</h6>
				<p>rdiff-backup mantém uma cópia inteira (não comprimida) dos arquivos objeto do back-up e guarda, igualmente, um histórico (back-ups incrementais), o que significa que você vai precisar de um espaço maior do que aquele que está sendo copiado. Por exemplo, se você vai fazer um back-up de 100GB de espaço, você vai precisar de 120GB (de preferência, em um HD separado!).</p>

			<h6>Como configurá-lo</h6>
				<p>Digamos que seu computador tenha:<br />
				* um HD de 100GB (sda), com sda1 usada como partição root, sda5 para guardar músicas e outros arquivos e sda6 como partição swap.<br />
				* outro HD de 200GB (sdb), não utilizado no momento, apenas com a partição sdb1; use-a para seus back-ups.<br />
				* endereço IP 192.168.0.1</p>

				<p>A primeira coisa a fazer é instalar rdiff-backup:</p>
<pre>
# apt-get install rdiff-backup
</pre>
				<p>Embora você possa fazer cópia de qualquer diretório, nosso exemplo é para back-ups de partições inteiras...queremos fazer back-up das partições sda1 e sda5; vamos, então, criar alguns diretórios para armazenar os dados:</p>
<pre>
# mkdir -p /media/sdb1/rdiff-backups/192.168.0.1/root
# mkdir -p /media/sdb1/rdiff-backups/192.168.0.1/sda5
</pre>
				<p>Você precisa do endereço IP bem especificado para o caso de usar esta máquina para fazer o back-up de outra (assunto coberto mais tarde).</p>

			<h6>Como fazer o back-up</h6>

				<p>rdiff-backup usa a sintaxe <span class="highlight-3">rdiff-backup source-dir dest-dir</span>. Nota: especifique sempre os nomes dos diretórios, não os nomes dos arquivos.</p>

				<p>Para fazer cópia de sda5, execute:</p>
<pre>
# rdiff-backup /media/sda5 /media/sdb1/rdiff-backups/192.168.0.1/sda5
</pre>
				<p>e para a partição root:</p>
<pre>
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/sdb1/rdiff-backups/192.168.0.1/root
</pre>
				<p>Qualquer mensagem de erro "AF_UNIX path too long" pode ser ignorada. Isso vai demorar um pouco, porque é a primeira vez que você faz um back-up dessa partição e, assim, o rdiff-backup terá de fazer cópia de tudo (e não apenas das diferenças). Note que não queremos fazer back-up do diretório /tmp, pois ele sempre muda, nem de /proc ou /sys, que não contêm arquivos reais, e nem de pontos de montagem. Se você fizer back-up dos pontos de montagem, então você estará copiando sdb1 e você poderá cair em um loop (círculo vicioso) infinito! Uma maneira de evitar isso é fazer back-up dos pontos de montagem separadamente.</p>

				<p>A razão de você ter colocado '/proc/*' e não apenas '/proc' é que o nome do diretório /proc fará parte do back-up, mas seu conteúdo será ignorado. O mesmo vale para /tmp, /sys e todos os nomes dos pontos de montagem.</p>

				 <p>Desse jeito, se você destruir sua partição /root e restaurá-la, /tmp, /proc, /sys e os nomes dos pontos de montagem serão criados (como deve ser). Se /tmp não existir quando o X for iniciado, ele vai reclamar. (Veja as páginas de manual para saber mais sobre --exclude e --include).</p>

			<h6>Como restaurar diretórios a partir de back-ups</h6>

				<p>rdiff-backup usa a sintaxe:</p>
<pre>
rdiff-backup -r &lt;de-quando&gt; &lt;dir-fonte&gt; &lt;dir-destino&gt;
</pre>
				<p>Se você deletar acidentalmente o diretório /media/sda7/fotos, você pode restaurá-lo com:</p>
<pre>
# rdiff-backup -r now /media/sdb1/rdiff-backups/192.168.0.1/sda5/fotos /media/sda5/fotos
</pre>
				<p>A opção "-r now" significa que é para restaurar a partir do último back-up. Se você tem feito cópias regularmente de tudo (via crontab, p. ex.) e só reparou dias depois que o diretório de fotos foi apagado, você terá de fazer o back-up a partir de alguns dias atrás (e não 'now' - agora -). Ou talvez você apenas queira voltar a uma versão anterior de alguma coisa.</p>

				<p>Se você quiser restaurar a partir de três dias atrás, então use "-r 3D" ... mas, como dizem as páginas de manual, note o seguinte:</p>

				<p class="highlight-1">"3D" se refere a 72 horas antes do presente e se não houver backup daquele dia, o rdiff-backup restaura a partir da data imediatamente anterior. No caso acima, por exemplo, se "3D" for usado e somente existir back-ups de 2 e 4 dias atrás, o diretório será restaurado a seu estado de 4 dias atrás. (Portanto, você terá de pensar um pouco antes de restaurar).</p>

				<p>Usando o seguinte, você terá datas e horas dos back-ups de sda5:</p>
<pre>
# rdiff-backup -l /media/sdb1/rdiff-backups/192.168.0.1/sda5
</pre>
			<h5>Como restaurar partições</h5>

				<p>Você pode também restaurar partições inteiras (mounts), pois um ponto de montagem nada mais é que um diretório.</p>

				<p class="highlight-2">ATENÇÃO: Não restaure a partição root, se ela está em uso!!! Com apenas um comando, você perderá todos os arquivos em todas as partições, inclusive todos seus back-ups, mesmo que estiverem em HDs separados!! O rdiff-backup segue exatamente as instruções que recebeu...se o back-up para a partição root tiver pontos de montagens vazios, então para restaurar ao estado do back-up, ele deleta tudo nos pontos de montagem, para que tudo fique igual ao back-up.</p>

				<p>Para restaurar sda5 para o último back-up, faça isto:</p>
<pre>
# rdiff-backup -r now /media/sdb1/rdiff-backups/192.168.0.1/sda5 /media/sda5
</pre>
			<h5>Como restaurar a partição root</h5>

				<p>Restaurar a partição root não é tão simples. Não a restaure enquanto ela estiver montada (veja o aviso acima). É realmente útil poder restaurar a partição root, porque se você bagunçar tudo quando estiver instalando/atualizando ou quando estiver instalando um novo kernel etc, você tem a tranquilidade de saber que tudo pode voltar a ser como era antes em apenas 20 minutos.</p>

				<p>Um modo de restaurar a partição root é dar o boot em outra distribuição Linux que por acaso você tiver instalado. Assim, você será capaz de restaurar a partição root que você quer porque ela não está montada. Após restaurá-la, dê o boot por ela e perceba que as coisas estão exatamente como eram quando você fez o back-up. Este é de longe o jeito mais fácil.</p>

				<p>Outra maneira de restaurar a partição root é dar o boot pelo LiveCd do aptosid e restaurar a partir dele, pois o rdiff-backup está incluído no CD. Se acaso ele não estiver na sua versão do LiveCD, digite no Grub (Bootoptions, Cheatcodes) a "cheatcode" 'unionfs' para ser capaz de instalar aplicações no modo LiveCD. Simplesmente carregue o aptosid e digite no terminal:</p>
<pre>
$ sudo su
# wget -O /etc/apt/sources.list http://aptosid.com/files/misc/sources.list
# apt-get update
# apt-get install rdiff-backup
</pre>
				<h6>Agora, vamos restaurar:</h6>
<pre>
# mount /dev/sda1 /media/sda1
# mount /dev/sdb1 /media/sdb1
# rdiff-backup -r now /media/sdb1/rdiff-backups/192.168.0.1/root /media/sda1
</pre>

				<p>Nota: se você não tiver um CD do aptosid, mas se o LiveCD que você estiver usando tiver suporte do Klik, você pode instalar o rdiff-backup por ele e chamando:</p>
<pre>
$ sudo ~/.zAppRun ~/Desktop/rdiff-backup_0.13.4-5.cmg rdiff-backup -r now /media/sdb1/rdiff-backups/192.168.0.1/root /media/sda1
</pre>

				<p>É recomendável que todos que fizerem back-ups da partição root (com a intenção de restaurá-la) testem o processo de restauração. Nada pior que pensar que tudo está correto e só descobrir algo inesperado numa emergência.</p>

							<p>Se você mudou seu HD ou formatou-o novamente, volte a checar as UUIDs (ou rótulos) em <span class="highlight-3">/boot/grub/menu.lst (grub-legacy) or files in /etc/grub.d (grub2)</span> e <span class="highlight-3">/etc/fstab</span>, e faça as alterações necessárias. Um jeito fácil de obter as informações para alterar esses arquivos, se preciso for, é abrir um terminal e digitar, como root:</p>

<pre>
blkid
</pre>

			<h5>Como fazer back-ups de outros PCs</h5>

				<p>Você pode fazer back-ups de outros PCs a partir de sua máquina local, desde que seja possível a conexão de sua máquina com as outras, através do ssh (e desde que você tenha espaço sobrando em seu HD). O servidor ssh (sshd) precisa estar rodando em um PC remoto. Os outros PCs não precisam estar em sua rede local, eles podem estar em qualquer lugar do mundo.</p>

				<p>Vamos assumir que seu PC remoto tenha as seguintes características:<br />
				1) um HD de 100GB (sda1), em uso, somente com pontos de montagem<br />
				2) sda1 usado para a partição root<br />
				3) sda5 onde guardamos alguns arquivos temporários, que não serão objeto do back-up<br />
				4) sda6 para swap <br />
				5) endereço IP 192.168.0.2</p>

				<p>Nota: ambos HDs de 100GB não podem, geralmente, ser copiados em um HD de 200GB com o rdiff-backup (porque não há espaço para os arquivos incrementais), mas já que você não vai fazer back-up da partição sda5 em seu PC remoto (e tendo em vista que HDs raramente estão 100% cheios, mas não confie tanto nisso), então você pode concluir que, sim, você tem espaço suficiente. Toda vez que o rdiff-backup fizer um back-up, mais arquivos incrementais serão criados, ocupando mais e mais espaço.</p>

				<p>Você pode pedir ao rdiff-backup para manter apenas os back-ups do último mês; assim seu HD estará menos cheio do que se o rdiff-backup guardar dados de um ano inteiro. Naturalmente, você pode guardar dados de um ano, mas você terá de comprar outro HD.</p>

				<p>Antes de mais nada, instale o rdiff-backup no PC remoto também (todos os computadores cujos back-ups você deseja fazer e também o servidor de back-up precisam do rdiff-backup instalado).</p>

				<p>Para copiar o PC remoto em seu PC local, rode neste (IP 192.168.0.1): <span class="highlight-4">Note o use de duplos dois pontos --> :: </span></p>
<pre>
# mkdir /media/sdb1/rdiff-backups/192.168.0.2/root
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' 192.168.0.2::/ /media/sdb1/rdiff-backups/192.168.0.2/root
</pre>
				<p>Se você quiser restaurar um diretório no PC remoto, a restauração pode ser iniciada tanto no PC remoto quanto no PC local.</p>

				<p>Por exemplo, para restaurar o diretório /usr/local/games no PC remoto, iniciando o processo nele mesmo:</p>
<pre>
# rdiff-backup -r now 192.168.0.1::/media/sdb1/rdiff-backups/192.168.0.1/root/usr/local/games /usr/local/games
</pre>
				<p>Para restaurar o diretório /usr/local/games no PC remoto, iniciando o processo no PC local:</p>
<pre>
# rdiff-backup -r now /media/sdb1/rdiff-backups/192.168.0.1/root/usr/local/games 192.168.0.2::/usr/local/games
</pre>
				<p>Use a mesma sintaxe quando for restaurar a partição root a partir do LiveCD (onde o boot do PC remoto foi feito via LiveCD... veja mais acima).</p>

			<h5>Como automatizar os back-ups:</h5>

				<p>Se você estiver fazendo back-ups de outros PCs em sua máquina local, a primeira coisa a fazer é ativar logins sem senha no ssh, usando chaves ssh. <span class="highlight-2">Note que estamos falando de logins como root. Você pode limitar o rdiff-backup de forma que apenas seus comandos sejam executados, mas isso está fora do escopo deste tópico. Favor ver <a href="ssh-pt-br.htm#ssh-s">Configuração do SSH</a> </span>. Vamos configurar a maneira mais simples de fazer logins sem senha.</p>

				<p>No PC local, faça o seguinte:</p>
<pre>
# [ -f /root/.ssh/id_rsa ] || ssh-keygen -t rsa -f /root/.ssh/id_rsa
</pre>
				<p>... e pressione [ENTER] duas vezes para senhas em branco. Então digite:</p>
<pre>
# cat /root/.ssh/id_rsa.pub | ssh 192.168.0.2 'mkdir -p /root/.ssh;\<!--dunno if this is wrong-->
> cat - >>/root/.ssh/authorized_keys2'
</pre>
				<p>O sistema vai pedir sua senha de root.</p>

				<p>Agora você pode se conectar com o PC remoto pelo ssh, sem precisar de digitar uma senha, e o back-up do diff-backup passa a ser automatizado.</p>

				<p>A seguir, crie um script que contenha todos os comandos do rdiff-backup. Esse script terá mais ou menos essa feição:</p>


<pre>
#!/bin/bash
RDIFF=/usr/bin/rdiff-backup
echo
echo "=======Back-up de 192.168.0.1 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/sdb1/rdiff-backups/192.168.0.1/root
echo "(e purgue incrementos mais antigos que 1 mês)"
${RDIFF} --remove-older-than 1M --force /media/sdb1/rdiff-backups/192.168.0.1/root
echo
echo "=======Back-up de 192.168.0.1 partição sda5======="
${RDIFF} --ssh-no-compression --exclude /media/sda5/myjunk /media/sda5 /media/sdb1/rdiff-backups/192.168.0.1/sda5
echo "(e purgue incrementos mais antigos que 1 mês)"
${RDIFF} --remove-older-than 1M --force /media/sdb1/rdiff-backups/192.168.0.1/sda5
echo
echo "=======Back-up de 192.168.0.2 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' --exclude '/mnt/*/*' 192.168.0.2::/media/sdb1/rdiff-backups/192.168.0.2/root
echo "(e purgue incrementos mais antigos que 1 mês)"
${RDIFF} --remove-older-than 1M --force /media/sdb1/rdiff-backups/192.168.0.2/root
</pre>


				<p>Dê o nome de "myrdiff-backups.bash" a esse script, coloque-o no diretório /usr/local/bin de seu PC local (servidor de back-up), e torne-o executável. Rode o script para ter certeza de que funciona.</p>

				<p>Por fim, vamos pedir ao cron para rodá-lo todas as noites, às 20:00h. Insira a linha abaixo no crontab,como root:</p>
<pre>
# crontab -e
e insira a seguinte linha:
0 20 * * * /usr/local/bin/myrdiff-backups.bash
</pre>

			<div id="rev">Content last revised 14/08/2010 0100 UTC</div>
</div>
</div>
</body>
</html>
