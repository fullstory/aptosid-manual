<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="ro">
<head>
	<title>sidux Manuals - rdiff</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<div id="menu"> <!-- menu starts here ro lang maintainer Adriana-->
<!--Welcome to the  sidux-manual Operating System Manual version-01.76.2008.10.14 -->
<!-- menu last updated by bluewater 14/10/2008 0800 hrs UTC -->
<a href="http://sidux.com/"><img src="../lib/logos/sidux-logo.png" title="La pagina sidux.com forums şi wiki" alt="sidux.com logo" id="menu-header" /></a>
	<ul id="top-list">
		<li><a href="manual-search-ro.htm#search-on"> <img src="../lib/logos/kappfinder.png" title="Caută Manualul" alt="Caută" /> Caută Online Offline</a> </li>
		<li><a href="http://manual.sidux.com/meta-manual">Meta-Manualul sidux</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-language-64.png" title="Alege o altă limbă străină - Choose another language" alt="lang-switch" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-ro.htm">Manualul SO sidux </a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-ro.htm#welcome-gen">Manualul SO sidux </a></li>
				<li><a href="welcome-ro.htm#how-to">Folosirea acestui manual</a></li>
				<li><a href="welcome-ro.htm#table-contents">Index</a></li>
				<li><a href="help-ro.htm#help-gen">De unde primiţi ajutor</a></li>
				<li><a href="help-ro.htm#paste">IRC !lipeste</a></li>
				<li><a href="credits-ro.htm#cred-team">Credite</a></li>
				<li><a href="wel-quickstart-ro.htm#welcome-quick">Ghidul de pornire rapida a lui sidux</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-content-ro.htm">Conţinutul CD-ului</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-ro.htm#cd-content">Conţinutul CD-ului</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="cd-dl-burning-ro.htm">Descărcarea şi scrierea CD-ului</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="cd-dl-burning-ro.htm#download-sidux">sidux Locaţii de Download, Descărcarea şi scrierea CD-ului</a></li>
				<li><a href="cd-dl-burning-ro.htm#md5">Verificarea cu suma de control md5 </a></li>
				<li><a href="cd-dl-burning-ro.htm#burn-nero">Scrierea în Windows</a></li>
				<li><a href="cd-dl-burning-ro.htm#burn-linux">Scrierea în Linux</a></li>
				<li><a href="cd-dl-burning-ro.htm#xdelta">Adăugirile xdelta (Patching)</a></li>
				<li><a href="cd-no-gui-burn-ro.htm#burning-no-gui">Scrierea CD-ului fără GUI (interfaţă grafică)</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="live-mode-ro.htm">Modul "Live"</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="live-mode-ro.htm#rootpw">Parola de root pe sidux-Live CD</a></li>
				<li><a href="live-mode-ro.htm#live-cd-installsoft">Instalarea de software în timpul lucrului de pe Live-CD</a></li>
				<li><a href="live-mode-ro.htm#ntfs-3g">Scrierea pe partiţii  NTFS cu ntfs-3g</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="term-konsole-ro.htm">Terminalul /Konsola</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="term-konsole-ro.htm#sux"> sux</a></li>
				<li><a href="term-konsole-ro.htm#term-kon"> Terminalul/Konsola</a></li>
				<li><a href="term-konsole-ro.htm#cli-help">Ajutor în Linia de Comandă</a></li>
				<li><a href="term-konsole-ro.htm#term-cmds">Lista Comenzilor în Terminalul Linux</a></li>
				<li><a href="term-konsole-ro.htm#shell-scripts">Instalarea Scripts.sh</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="cheatcodes-ro.htm">CheatCodes</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="cheatcodes-ro.htm#cheatcodes">cheatcode-uri specifice lui sidux (numai in Live-cd)</a></li>
				<li><a href="cheatcodes-ro.htm#cheatcodes-linux">Cheatcodes generice in Linux</a></li>
				<li><a href="cheatcodes-vga-ro.htm#vga"> Coduri VGA </a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="part-gparted-ro.htm">Partiţionarea Hard Discului</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="part-gparted-ro.htm#partition">Partiţionarea Hard Discului folosind GParted</a></li>
				<li><a href="part-gparted-ro.htm#ntfs">Redimensionarea partiţiilor NTFS folosind GParted</a></li>
				<li><a href="part-uuid-ro.htm#uuid">UUID, Etichetarea Partiţiilor şi fstab</a></li>
				<li><a href="part-cfdisk-ro.htm#disknames">Numirea Discurilor pe scurt</a></li>
				<li><a href="part-cfdisk-ro.htm#partition">Partiţionarea Hard discului folosind cfdisk</a></li>
				<li><a href="part-cfdisk-ro.htm#formating">Formatarea după partiţionarea cu cfdisk</a></li>
				<li><a href="part-size-examp-ro.htm#part-example">Exemple de mărimi de Partiţii </a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hd-install-ro.htm">Opţiuni de Instalare </a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hd-install-ro.htm#Inst-prep">Pregătirea Instalării</a></li>
				<li><a href="hd-install-ro.htm#Installation">Instalarea pe  Hard Disc</a></li>
				<li><a href="hd-install-ro.htm#first-hd-boot">Prima Pornire</a></li>
				<li><a href="hd-install-opts-ro.htm#fromiso">Pornirea 'fromiso'</a></li>
				<li><a href="hd-install-opts-ro.htm#fromiso-persist">fromiso şi persist</a></li>
				<li><a href="hd-install-opts-ro.htm#usb-hd">Instalarea pe un USB-Hard Disc</a></li>
				<li><a href="hd-install-opts-ro.htm#vtbox">Instalarea prin VirtualBox</a></li>
				<li><a href="hd-install-opts-ro.htm#qemu">Instalarea prin QEMU</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-ro.htm">Plăci Grafice, Dispozitive Hardware şi Drivere</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="hw-dev-hw-dri-ro.htm#hd-ntfs3g">Scrierea pe partiţii  NTFS cu ntfs-3g</a></li>
				<li><a href="hw-dev-mon-ro.htm#mon-res">Schimbarea rezoluţiei şi Monitoare</a></li>
				<li><a href="hw-dev-mon-ro.htm#xrandr">Monitori Duali si xrandr</a></li>
				<li><a href="hw-dev-mon-ro.htm#mon-binary">Monitori duali (folosind binare)</a></li>
				<li><a href="hw-dev-hw-dri-ro.htm#non-free-3d">Drivere non-free , binare pentru Nvidia / ATI</a></li>
				<li><a href="hw-dev-hw-dri-ro.htm#native-nv-ati">Drivere Free xorg pentru  nVidia , ATI , Radeon , Intel</a></li>
				<li><a href="hw-dev-hw-dri-ro.htm#non-free">Hardware ce necesită drivere non-free </a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="wm-kde-ro.htm"> Managere în mod grafic - KDE</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="wm-kde-ro.htm#desk-freeze">KDE Desktop se blochează</a></li>
				<li><a href="wm-kde-ro.htm#kde-login">Dacă nu poţi loga în KDE</a></li>
				<li><a href="wm-kde-ro.htm#ch-th">Schimbarea Temelor</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="lamp-apache-ro.htm">Setul LAMP din sidux </a>
			<ul class="sub-menu" id="sm11">
				<li><a href="ntp-server-ro.htm#ntp-server">Setarea Timeserver-ului </a></li>
				<li><a href="lamp-apache-ro.htm#serv-apache"> Setul LAMP din sidux</a></li>
				<li><a href="lamp-apache-ro.htm#serv-ftp">Clienţi FTP </a></li>
				<li><a href="lamp-apache-ro.htm#serv-sec">Protocoale de Securitate</a></li>
				<li><a href="lamp-apache-ro.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-ro.htm#serv-mysql">Setarea MySQL </a></li>
				<li><a href="lamp-ppp-ro.htm#serv-php">PHP în Apache</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="internet-connecting-ro.htm">Internet şi Networking</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="tor-privoxy-ro.htm#tor">Tor</a></li>
				<li><a href="tor-privoxy-ro.htm#privoxy">Privoxy</a></li>
				<li><a href="internet-connecting-ro.htm#firewalls">Firewalls</a></li>
				<li><a href="samba-ro.htm#configure">Configurarea SAMBA (Windows)</a></li>
				<li><a href="samba-ro.htm#setup">Setarea Serverului Samba </a></li>
				<li><a href="ssh-ro.htm#ssh-fs">Montarea de la distanţă SSH </a></li>
				<li><a href="ssh-ro.htm#ssh-x">Aplicaţii X Window via SSH</a></li>
				<li><a href="ssh-ro.htm#ssh-f">GUI SSH cu Konqueror</a></li>
				<li><a href="ssh-ro.htm#ssh-w">SSH X-Forwarding de la un Windows-PC</a></li>
				<li><a href="ssh-ro.htm#ssh">SSH şi Securitatea</a></li>
				<li><a href="internet-connecting-ro.htm#dial-mod">Modemuri 56k </a></li>
				<li><a href="internet-connecting-ndis-ro.htm#ndiswrapper-basic">Activarea Ndiswrapper</a></li>
				<li><a href="internet-connecting-ndis-ro.htm#ndiswrapper-advanced">Activarea Ndiswrapper -  Avansat</a></li>
				<li><a href="internet-connecting-wpagui-ro.htm#wpa-roaming-gui">WiFi - roaming ( a hoinari) WPA-GUI</a></li>
				<li><a href="internet-connecting-wpa-ro.htm#wpa-basic">WiFi - Ghid de baza pentru instalare</a></li>
				<li><a href="internet-connecting-wpa-ro.htm#wpa">WiFi - wpasupplicant</a></li>
				<li><a href="internet-connecting-ro.htm#netcardconfig">Conectarea Online - Ceni</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-apt-ro.htm">Instalarea/Ştergerea  sau Downgrading de pachet</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="sys-admin-apt-ro.htm#apt-cook">Ghid APT şi lista surselor</a></li>
				<li><a href="sys-admin-meta-ro.htm#meta-pack">Instalarea Meta-Pachetelor </a></li>
				<li><a href="sys-admin-meta-ro.htm#meta-proxy">Instalarea Meta sau proxies</a></li>
				<li><a href="sys-admin-apt-ro.htm#apt-install">Instalarea unui  pachet nou</a></li>
				<li><a href="sys-admin-apt-ro.htm#apt-delete">Ştergerea unui pachet</a></li>
				<li><a href="sys-admin-apt-ro.htm#apt-downgrade">Downgrading Hold de pachet</a></li>
				<li><a href="sys-admin-apt-ro.htm#apt-cache">Căutarea unui pachet cu apt-cache</a></li>
				<li><a href="sys-admin-apt-ro.htm#apt-kio">Căutarea unui pachet cu kio-apt</a></li>
				<li><a href="sys-admin-apt-ro.htm#apt-upgrade">Upgrade de Sistem instalat -  dist-upgrade</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 14 );" onmouseout="startTime();" ><a href="smxi-ro.htm">Administrarea Sistemului</a>
			<ul class="sub-menu" id="sm14">
				<li><a href="smxi-ro.htm#smxi">Sintaxa Setului de Comenzi din smxi </a></li>
				<li><a href="siduxcc-ro.htm#siduxcc">Centrul de control sidux</a></li>
				<li><a href="sys-admin-apt-ro.htm#apt-upgrade">Upgrade de Sistem instalat -  dist-upgrade</a></li>
				<li><a href="sys-admin-upgrade-ro.htm#live-cd-upgrade">Upgrade-ul folosind Live-CD</a></li>
				<li><a href="sys-admin-kern-upg-ro.htm#kern-upgrade">Upgrade-ul de kernel</a></li>
				<li><a href="sys-admin-rdiff-ro.htm#rdiff">Salvările cu rdiff</a></li>
				<li><a href="sys-admin-rsync-ro.htm#rsync">Salvările cu rsync</a></li>
				<li><a href="vir-rkits-ro.htm#virus-rkits">Scanerele Antivirus şi Rootkit </a></li>
				<li><a href="sys-admin-gen-ro.htm#start-services">Serviciile enable/disable</a></li>
				<li><a href="sys-admin-gen-ro.htm#pw-lost">Parolele de root pierdute</a></li>
				<li><a href="sys-admin-gen-ro.htm#fonts">Fonturi </a></li>
				<li><a href="sys-admin-gen-ro.htm#cups">CUPS</a></li>
				<li><a href="sys-admin-gen-ro.htm#init">sidux runlevels - init</a></li>
				<li><a href="sys-admin-grub-bootman2-ro.htm#mbr-grub-boot">Suprascrierea sectorului de boot din MBR </a></li>
				<li><a href="sys-admin-grub-bootman2-ro.htm#dual-boot">Booting Dual şi Multiplu </a></li>
				<li><a href="sys-admin-grub-bootman2-ro.htm#boot-grub-floppy">Crearea unei dischete de Boot </a></li>
				<li><a href="sys-admin-grub-bootman2-ro.htm#remove-grub">Scoaterea programului grub din MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-ro.htm#what-is-grub">Managerul de boot Grub </a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
	<div class="divider" id="rdiff">
			<h2 id="top-header">Salvările de Sistem cu rdiff</h2>
				<p>rdiff-backup este o unealtă folosită pentru a salva fişiere. (şi poate rula pe o  varietate de porturi  *nix ).<br />
				Situaţia frumoasă în legătură cu sidux este că puteţi alege cum să executaţi o mare varietate de procese , DIY (do it yourself) sau prin scripturi </p>

				<h3><a href="http://techpatterns.com/forums/about831.html">Aceasta este versiunea scriptică de la h2</a></h3>
	<div class="spacer02"></div>

			<h5>Ceea ce urmează este versiunea DIY </h5>

			<h6>rdiff-backup</h6>

				<p class="highlight-2">Rulaţi comenzile în  consolă ca root , dacă nu este specificat altcumva </p>

				<p>*foarte bun pentru recuperarea de după dist-upgrade sau kernel upgrade nereuşite, etc (şi deasemeni pentru a restaura fişiere individuale ) .<br />
				*salvează doar ceea ce este schimbat ca şi rsync  (deci fiecare backup nu durează mult ) .<br />
				*ţine un jurnal al schimbărilor (ceea ce înseamnă că puteţi restaura fişiere pe care le-aţi şters acu` trei săptămâni !) .<br />
				*face salvari în condiţii de securitate din reţea (folosind ssh).<br />
				*face salvarea unei partiţii întregi în timp ce este montată (este uşor să programaţi o salvare automată...fără să faceţi de-montare ).<br />
				*poate restaura totul în cazul în care discul devine inutilizabil şi trebuie să cumpăraţi altul .<br />
				*se autoconfigurează pentru a salva o reţea întreagă  (în linux este perfect , în windows un pic mai dificil) şi este folosit în afaceri .<br />
				*este o aplicaţie controlată din linia de comandă , foarte potrivită pentru cei care preferă să facă backup automat  (cum ar fi un bash script  lansat prin intermediul cron).<br />
				*memorează şi se descurcă foarte bine cu apartenenţa fişierelor şi permisiunile acestora precum şi cu link-urile simbolice (şi toate lucrurile de acest gen) deci când veţi face restaurarea toate vor fi exact cum au fost înainte .</p>

			<h6>Ce veţi avea nevoie</h6>
				<p>rdiff-backup ţine o copie completă (necompresată) a fişierelor pe care le salvaţi , deasemeni ţine un jurnal a ceea ce este salvat (incremental backups) , asta înseamnă că spaţiul pe care se salvează va fi mai mare decât ceea ce este salvat . Dacă salvaţi 100 giga de spaţiu este posibil să aveţi nevoie de 120 giga pentru a salva ( şi de preferat pe un hard separat !) .</p>

			<h6>Setările care trebuiesc făcute</h6>
				<p>Să spunem ca PC-ul dumneavoastră are următoarele :<br />
				* un hard de 100 giga ce este folosit (hda) , cu partiţia hda1 ca partiţie root , partiţia hda5 pentru a stoca muzică şi alte fişiere şi partiţia hda6 ca swap .<br />
				* un disc nefolosit de 200 giga (hdb) cu partiţia hdb1 ... şi pe care o vom folosi pentru salvările noastre .<br />
				* adresa IP  192.168.0.1</p>

				<p>Primul lucru ce trebuie făcut este să instalăm rdiff-backup :</p>
<pre>
# apt-get install rdiff-backup
</pre>
				<p>Acum veţi putea să salvaţi orice director , dar aici presupunem că salvam o întreagă partiţie ...vom salva partiţiile hda1 şi hda5 (nu şi hda6 ) iar pentru aceasta vom crea nişte directori în care vom stoca datele :</p>
<pre>
# mkdir -p /media/hdb1/rdiff-backups/192.168.0.1/root
# mkdir -p /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>Trebuie ca adresa IP să fie specificată exact pentru că se poate salva şi o partiţie din alt calculator , iar la restaurare să ştie pe care calculator să o facă (vom vedea mai departe).</p>

			<h6>Salvarea</h6>

				<p>rdiff-backup foloseşte sintaxa <span class="highlight-3">rdiff-backup source-dir dest-dir</span>. Notă : întotdeauna specificaţi numele directorului , nu numele fişierelor .</p>

				<p>Pentru a face salvarea partiţiei hda5 , rulaţi :</p>
<pre>
# rdiff-backup /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
				<p>Iar pentru a salva partiţia root , rulaţi :</p>
<pre>
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' / /media/hdb1/rdiff-backups/192.168.0.1/root
</pre>
				<p>Orice eroare de genul "AF_UNIX path too long" poate fi ignorată . Aceasta va dura ceva timp de vreme ce este prima oară când partiţia e salvata şi deci rdiff-backup va trebui să o scrie în întregime (şi nu numai diferenţele ) . Observaţi că nu salvam  /tmp deoarece acesta mereu se schimbă , şi nici  /proc sau  /sys din cauză ca acestea nu conţin fişiere reale , şi deasemeni nu vom salva punctele de montare . Dacă am face salvarea punctului de montare am salva de fapt hdb1, şi am intra într-o buclă infinită ! O altă cale este să salvaţi punctele de montare separat .</p>

				<p>Acum , motivul pentru care se foloseşte  '/proc/*' în loc de  '/proc' este că astfel ar fi salvat doar numele de director  /proc , şi ar fi ignorat tot ceea ce este în interiorul acestuia . La fel este valabil şi pentru /tmp, /sys , şi chiar pentru punctele de montare .</p>

				 <p>În acest fel , dacă vă veţi distruge partiţia root şi veţi apela la o restaurare completă numele directorilor  /tmp ,  /proc ,  /sys şi numele punctelor de montare vor fi create (aşa cum ar trebui). Dacă /tmp nu există când X porneşte  vi se va semnaliza .( Găsiţi mai multe în manpage pentru  --exclude şi  --include).</p>

			<h6>Restaurarea directorilor din salvările prealabile</h6>

				<p>rdiff-backup foloseşte sintaxa :</p>
<pre>
rdiff-backup -r &lt;from-when&gt; &lt;source-dir&gt; &lt;dest-dir&gt;
</pre>
				<p>Dacă din greşeală aţi şters directorul  /media/hda5/photos , îl puteţi restaura executând :</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5/photos /media/hda5/photos
</pre>
				<p>Opţiunea  "-r now" înseamnă restaurarea din ultima salvare făcută . Dacă aţi făcut salvări periodice  (via crontab, să spunem), şi nu v-aţi dat seama că acel director cu fotografii lipseste până acum câteva zile veţi avea nevoie de o restaurare dintr-o salvare făcută acum câteva zile (şi nu  "now", pentru că în ultima salvare făcută probabil acel director nu există). Sau poate că vreţi pur şi simplu să ajungeţi înapoi la o anumită versiune a unui program , ceva .</p>

				<p>Dacă doriţi să restauraţi la starea de acum trei zile folosiţi opţiunea  "-r 3D" ... dar , aşa cum este menţionat şi în manpages , reţineţi :</p>

				<p class="highlight-1">"3D" se referă la exact 72 ore înainte de momentul prezent , şi dacă nu există nici o salvare făcută la acel moment , rdiff-backup va restaura starea salvată anterior acestui moment . Ca în cazul de mai sus , de exemplu , dacă  "3D" este folosit , şi există salvări făcute cu 2 şi cu  4 zile în urmă , acel director va fi restaurat aşa cum era el cu 4 zile în urmă (deci va trebui să vă gândiţi bine înainte de a face restaurarea).</p>

				<p>Folosind următoarele comenzi veţi primi o listă cu data şi ora la care au fost făcute toate salvările pentru hda5 :</p>
<pre>
# rdiff-backup -l /media/hdb1/rdiff-backups/192.168.0.1/hda5
</pre>
			<h5>Restaurarea partiţiilor</h5>

				<p>Puteţi deasemeni restaura partiţii întregi (puncte de montare) , până la urmă un punct de montare este tot un director .</p>

				<p class="highlight-2">ATENŢIE : Nu încercaţi să restauraţi partiţia root atât timp cât lucraţi de pe ea ! Cu o singură comandă puteţi pierde toate fişierele de pe toate partiţiile , inclusiv salvările de pe un disc separat !! rdiff-backup face exact ce-i spuneţi să facă ... dacă salvarea pentru partiţia root are puncte de montare goale , programul  va şterge orice există în punctul de montare pentru a face să fie conform salvării existente .</p>

				<p>Pentru a restaura hda5 din ultima salvare vom executa :</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/hda5 /media/hda5
</pre>
			<h5>Restaurarea partiţiei root</h5>

				<p>Pentru a restaura partiţia root nu este la fel de simplu . Nu restauraţi niciodată partiţia root atât timp cât este montată (citiţi avertismentul de mai sus). Este foarte util să poţi restaura partiţia root , mai ales după o încercare nereuşită de upgrade sau de instalare a unui nou kernel (etc) ; veţi fi linistit stiind că puteţi întoarce lucrurile aşa cum au fost şi toate acestea în doar 20 minute .</p>

				<p>O cale de a restaura partiţia root este să bootaţi într-o partiţie linux neocupată , dacă aveţi una în computer . De acolo veţi putea restaura partiţia dorită , dacă nu este montată ca root . După ce restauraţi partiţia puteţi porni de pe ea şi veţi vedea că este exact ca înainte ...exact ! Aceasta nu este nicidecum cea mai uşoara metodă .</p>

				<p>O altă cale de a restaura partiţia root este să porniţi cu sidux live-cd şi să faceţi restaurarea de acolo. rdiff-backup este inclus în sidux.  În cazul în care versiunea sidux live-cd pe care o aveţi nu include şi rdiff, puteţi folosi la linia de comandă grub (Bootoptions, (Cheatcodes)) codul "unionfs" iar asta va însemna că veţi putea instala programe noi cât timp rulaţi de pe live cd . Doar porniţi şi lansaţi următoarele comenzi :</p>
<pre>
$ sudo su
# wget -O /etc/apt/sources.list http://sidux.com/files/misc/sources.list
# apt-get update
# apt-get install rdiff-backup
</pre>
				<h6>Acum vom face restaurarea :</h6>
<pre>
# mount /dev/hda1 /media/hda1
# mount /dev/hdb1 /media/hdb1
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>Notă : În cazul în care aveţi un Live-CD care suportă klik puteţi instala rdiff-backup folosind Klik şi rulând :</p>
<pre>
$ sudo ~/.zAppRun ~/Desktop/rdiff-backup_0.13.4-5.cmg rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root /media/hda1
</pre>

				<p>Este recomandat ca toţi cei care fac salvarea partiţiei root (cu intenţia de a o restaura la nevoie ) să facă un test al procesului de restaurare . Nimic nu este mai neplacut decât să te gândeşti că totul va fi în regulă după restaurare şi aceasta să nu reuşească din cauza a ceva neaşteptat  când ai mai mare nevoie .</p>

			<h5>Salvarea partiţiilor din alte computere </h5>

				<p>Puteţi să salvaţi partiţiile altor computere în computerul local atâta vreme cât vă puteţi conecta ssh la acele computere (şi aveţi destul spaţiu pe hard disc). Serverul ssh (sshd) trebuie să ruleze pe computerul comandat . Acesta nu trebuie să fie neaparat în reteaua locala , poate fi oriunde în lume .</p>

				<p>Să presupunem că PC-ul comandat are urmatoarele :<br />
				1) un hard de 100 giga (hda) în uz , cu următoarele,<br />
				2) hda1 ca partiţie root ,<br />
				3) hda5 unde sunt stocate nişte fişiere temporare şi pe care nu dorim să le salvăm ,<br />
				4) şi hda6 ca partiţie swap şi adresa IP  192.168.0.2</p>

				<p>Notă : două discuri de 100 giga de obicei nu pot fi salvate pe un disc de 200 giga folosind rdiff-backup (pentru că nu va mai fi loc şi pentru fişierele incrementale ), dar pentru că nu salvaţi şi partiţia hda5 de pe computerul comandat (şi pentru că de obicei discurile nu sunt 100% pline , dar nu vă bazaţi pe asta) va trebui întotdeauna să calculaţi dacă aveţi destul spaţiu pentru backup .De fiecare dată când rdiff-backup face o alta salvare , el va crea încă un fişier incremental , şi acesta va ocupa din ce în ce mai mult spaţiu .</p>

				<p>Puteţi specifica programului rdiff-backup să păstreze salvările doar din ultima lună (această comandă va fi detaliată mai târziu), şi aceasta va ocupa mai puţin spaţiu decât salvările unui an întreg . Bineînţeles ,dacă veţi dori să păstraţi salvările de pe parcursul întregului an veţi avea nevoie de spatiu pe hard corespunzător mărimii fişierelor incrementale făcute de-a lungul întregului an .</p>

				<p>Va trebui mai întâi să instalaţi rdiff-backup pe computerul comandat  (oricare computer căruia doriţi să-i faceţi salvări , inclusiv server backup , trebuie să aibă rdiff-backup instalat ).</p>

				<p>Pentru a salva datele din computerul comandat în calculatorul local rulaţi în computerul local (cu adresa , să zicem 192.168.0.1) : <span class="highlight-4">Fiţi atenţi la folosirea de două ori a semnului doua puncte  :: </span></p>
<pre>
# mkdir /media/hdb1/rdiff-backups/192.168.0.2/root
# rdiff-backup --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' 192.168.0.2::/ /media/hdb1/rdiff-backups/192.168.0.2/root 
</pre>
				<p>Acum dacă doriţi să restauraţi un director în computerul comandat puteţi iniţia restaurarea atât din computerul local cât şi din cel comandat .</p>

				<p>În exemplul următor veţi restaura fişierul /usr/local/games în computerul comandat , iniţializând restaurarea tot din computerul comandat :</p>
<pre>
# rdiff-backup -r now 192.168.0.1::/media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games /usr/local/games
</pre>
				<p>În exemplul ce urmează veţi restaura directorul  /usr/local/games în computerul comandat , iniţializând restaurarea din computerul local :</p>
<pre>
# rdiff-backup -r now /media/hdb1/rdiff-backups/192.168.0.1/root/usr/local/games 192.168.0.2::/usr/local/games
</pre>
				<p>Folosiţi cam aceaşi sintaxă când restauraţi partiţia root de pe un live cd (când computerul comandat a fost pornit de pe live cd ...vedeţi mai sus).</p>

			<h5>Salvările automate :</h5>

				<p>Dacă vreţi să salvaţi partiţiile  altor computere în computerul local primul lucru ce trebuie făcut este să activaţi logarea ssh fără parola folosind ssh keys . <span class="highlight-2">Reţineţi că acum vorbim despre logarea ssh ca root fără parolă . Acest lucru poate fi restricţionat în aşa fel încât numai comenzile rdiff-backup  să fie executate , dar prezentarea acestei secţiuni este în afara subiectului nostru deocamdată . Adresaţi-vă la <a href="ssh-ro.htm#ssh-s">Configurarea SSH </a> </span> . Vom presupune că suntem în deplină siguranţa , şi vom seta cel mai simplu mod de conectare ssh fără parolă .</p>

				<p>De pe PC-ul local executaţi următoarele :</p>
<pre>
# [ -f /root/.ssh/id_rsa ] || ssh-keygen -t rsa -f /root/.ssh/id_rsa
</pre>
				<p>Şi apăsaţi enter de doua ori pentru nicio parolă . Apoi faceţi :</p>
<pre>
# cat /root/.ssh/id_rsa.pub | ssh 192.168.0.2 'mkdir -p /root/.ssh;\<!--dunno if this is right-->
> cat - >>/root/.ssh/authorized_keys2'
</pre>
				<p>Vi se va cere parola de root .</p>

				<p>Acum puteţi loga ssh în computerul comandat fără să mai trebuiască să tastaţi parola şi se poate executa rdiff-backup în mod automat .</p>

				<p>Mai departe creaţi un script bash care să conţină toate comenzile rdiff-backup . Acest script va arăta cam aşa :</p>


<pre>
#!/bin/bash
RDIFF=/usr/bin/rdiff-backup
echo
echo "=======Backing up 192.168.0.1 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' /media/hdb1/rdiff-backups/192.168.0.1/root
echo "(and purge increments older than 1 month)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/root
echo
echo "=======Backing up 192.168.0.1 mount hda5======="
${RDIFF} --ssh-no-compression --exclude /media/hda5/myjunk /media/hda5 /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.1/hda5
echo
echo "=======Backing up 192.168.0.2 root======="
${RDIFF} --ssh-no-compression --exclude '/tmp/*' --exclude '/proc/*' --exclude '/sys/*' --exclude '/media/*/*' --exclude '/mnt/*/*' 192.168.0.2::/media/hdb1/rdiff-backups/192.168.0.2/root
echo "(and purge increments older than 1 months)"
${RDIFF} --remove-older-than 1M --force /media/hdb1/rdiff-backups/192.168.0.2/root
</pre>


				<p>Numiţi acest script "myrdiff-backups.bash" şi salvaţi-l în  /usr/local/bin din computerul local (serverul de backup) şi schimbaţi-l într-un executabil . Rulaţi scriptul şi asiguraţi-vă că funcţionează .</p>

				<p>În final puteţi seta cron să lanseze scriptul în fiecare seară la 8pm . Următoarea linie în root's crontab va face totul , deschideţi</p>
<pre>
# crontab -e
şi introduceţi următoarea linie
0 20 * * * /usr/local/bin/myrdiff-backups.bash
</pre>

			<div id="rev">Content last revised 05/12/2007 1230 UTC</div>
</div>
</div>
</body>
</html>
