<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="ru">
<head>
	<title>Руководство sidux - Сервер времени ntp-ru</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
	<style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
	<style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
	<link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
	<script type="text/javascript" src="../lib/css-js/menu2.js"></script>
</head>
<body>
<div id="menu"><!-- menu starts here -->
<!--Welcome to the Official sidux-manual version 01.04-2007-05-20 ru language maintained by RoEn and koslow-->
<!-- menu last updated by bluewater 20/05/2007 1300rs AEST 20/05/2007 0300hrs UTC -->
<img src="../lib/logos/sidux-logo.png" alt="logo" id="menu-header" />
	<ul id="top-list">
		<li><a href="http://sidux.com/">Назад к основному меню sidux</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-lang-50.png" title="Выбирайте Ваш язык" alt="Переключение языка" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-ru.htm">Добро пожаловать в руководство sidux</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-ru.htm#welcome-gen">Официальное руководство</a></li>
				<li><a href="welcome-ru.htm#how-to">Как пользоваться этим руководством?</a></li>
				<li><a href="welcome-ru.htm#table-contents">Индекс</a></li>
				<li><a href="help-ru.htm#help-gen">Где найти помощь?</a></li>
				<li><a href="credits-ru.htm#cred-team">Благодарности</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-content-ru.htm">Содержание LiveCD</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-ru.htm#cd-content">Содержание LiveCD</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="cd-dl-burning-ru.htm">Cкачать и записать ISO-образ</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="cd-dl-burning-ru.htm#download-sidux">Cкачать и записать ISO-образ</a></li>
				<li><a href="cd-dl-burning-ru.htm#md5">Проверка ISO-образа с md5</a></li>
				<li><a href="cd-dl-burning-ru.htm#burn-nero">Записка ISO-образа под Windows</a></li>
				<li><a href="cd-dl-burning-ru.htm#burn-linux">Записка ISO-образа под Linux</a></li>
				<li><a href="cd-dl-burning-ru.htm#xdelta">Xdelta-патчи</a></li>
				<li><a href="cd-no-gui-burn-ru.htm#burning-no-gui">Записка ISO-образа без графической интерфейса</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="live-mode-ru.htm">Режим LiveCD</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="live-mode-ru.htm#rootpw">Пароль root на LiveCD</a></li>
				<li><a href="live-mode-ru.htm#live-cd-installsoft">Установка ПО в режиме LiveCD</a></li>
				<li><a href="live-mode-ru.htm#ntfs-3g">Запись на NTFS в режиме LiveCD</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="term-konsole-ru.htm">Терминал/оболочка</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="term-konsole-ru.htm#term-kon">Терминал/оболочка</a></li>
				<li><a href="term-konsole-ru.htm#cli-help">Помощь при использовании оболочки</a></li>
				<li><a href="term-konsole-ru.htm#shell-scripts">Установка скриптов в терминале</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="cheatcodes-ru.htm">Применение cheat кодов при загрузке</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="cheatcodes-ru.htm#cheatcodes">Загрузочные коды</a></li>
				<li><a href="cheatcodes-vga-ru.htm#vga">Коды для видеоадаптера</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="part-gparted-ru.htm">Разделение жесткого диска</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="part-gparted-ru.htm#partition">Разделение с помошью gparted</a></li>
				<li><a href="part-gparted-ru.htm#ntfs">Изменение размера NTFS-разделов с gparted</a></li>
				<li><a href="part-uuid-ru.htm#uuid">Возобновление скрипта fstab</a></li>
				<li><a href="part-uuid-ru.htm#uuid">UUID, названия жестких дисков и скрипт fstab</a></li>
				<li><a href="part-cfdisk-ru.htm#partition">Разделение с cfdisk</a></li>
				<li><a href="part-cfdisk-ru.htm#formating">Форматирование с cfdisk</a></li>
				<li><a href="part-size-examp-ru.htm#part-example">Размеры разделa: примеры</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hd-install-ru.htm">Способы установки</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hd-install-ru.htm#Inst-prep">Подготовка установки</a></li>
				<li><a href="hd-install-ru.htm#Installation">Установка на жесткий диск</a></li>
				<li><a href="hd-install-ru.htm#first-hd-boot">Первоначальная загрузка с жесткого диска</a></li>
				<li><a href="hd-install-opts-ru.htm#fromiso">Загрузка с ISO-образа 'fromiso'</a></li>
				<li><a href="hd-install-opts-ru.htm#usb-hd">Установка на USB-диск</a></li>
				<li><a href="hd-install-opts-ru.htm#qemu">Установка через qemu</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-ru.htm">Видеоадаптеры, аппаратное обеспечение, оборудование и модулы</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="hw-dev-hw-dri-ru.htm#hd-ntfs3g">Запись на NTFS в режиме LiveCD</a></li>
				<li><a href="hw-dev-hw-dri-ru.htm#mon-res">Разрешение и экран монитора</a></li>
				<li><a href="hw-dev-hw-dri-ru.htm#nvidia-3d">Коммерческий 3D-модиль nVidia</a></li>
				<li><a href="hw-dev-hw-dri-ru.htm#ati-3d">Коммерческий 3D-модиль ATI</a></li>
				<li><a href="hw-dev-hw-dri-ru.htm#native-nv">Открытый модуль nv</a></li>
				<li><a href="hw-dev-hw-dri-ru.htm#native-ati">Открытый модуль ati</a></li>
				<li><a href="hw-dev-hw-dri-ru.htm#non-free">Оборудование с коммерческими требованиями фирм</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="wm-kde-ru.htm">Менеджер окон</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="wm-kde-ru.htm#desk-freeze">Рабочий стол KDE зависает</a></li>
				<li><a href="wm-kde-ru.htm#kde-login">Проблемы при входе в KDE</a></li>
				<li><a href="wm-kde-ru.htm#ch-th">Смена тем</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 14 );" onmouseout="startTime();" ><a href="lamp-apache-ru.htm">Сюита-пакет LAMP</a>
			<ul class="sub-menu" id="sm14">
				<li><a href="lamp-apache-ru.htm#serv-apache">Пакет LAMP в sidux</a></li>
				<li><a href="lamp-apache-ru.htm#serv-ftp">Клиенты FTP</a></li>
				<li><a href="lamp-apache-ru.htm#serv-sec">Надежные протоколы</a></li>
				<li><a href="lamp-apache-ru.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-ru.htm#serv-mysql">Установка пакет MySQL</a></li>
				<li><a href="lamp-ppp-ru.htm#serv-php">Применение PHP в Apache</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="internet-connecting-ru.htm">Интернет и локальная сеть</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="ntp-server-ru.htm#ntp-server">Установка сервера NTP</a></li>
				<li><a href="internet-connecting-ru.htm#firewalls">Мини-брандмауэр</a></li>
				<li><a href="ssh-ru.htm#ssh-fs">Подключение к удаленному компьютеру через ssh</a></li>
				<li><a href="ssh-ru.htm#ssh-x">Применение программ в X-Windows через ssh</a></li>
				<li><a href="ssh-ru.htm#ssh-f">Графическое применение с konqueror и ssh</a></li>
				<li><a href="ssh-ru.htm#ssh-w">Поддержка графической оболочки на базе X через ssh</a></li>
				<li><a href="ssh-ru.htm#ssh">Безопасность и ssh</a></li>
				<li><a href="samba-ru.htm#configure">Использованиe папок в Windows через samba</a></li>
				<li><a href="samba-ru.htm#setup">Установка сервера samba</a></li>
				<li><a href="internet-connecting-ru.htm#dial-mod">56kбит-модемы</a></li>
				<li><a href="internet-connecting-ru.htm#ndiswrapper">Ndiswrapper</a></li>
				<li><a href="internet-connecting-wpa-ru.htm#wpa">Беспроводная локальная сеть WLAN</a></li>
				<li><a href="internet-connecting-ru.htm#internetsharing">Совместное использование интернета</a></li>
				<li><a href="internet-connecting-ru.htm#netcardconfig">Интернет и локальная сеть</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="sys-admin-apt-ru.htm">Системная администрация</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="sys-admin-apt-ru.htm#apt-cook">Короткое руководство по apt</a></li>
				<li><a href="sys-admin-meta-ru.htm#meta-pack">Установка мета-пакетов</a></li>
				<li><a href="sys-admin-meta-ru.htm#meta-proxy">Установка Meta-пакеов и прохи</a></li>
				<li><a href="sys-admin-apt-ru.htm#apt-install">Установка новых пакетов</a></li>
				<li><a href="sys-admin-apt-ru.htm#apt-delete">Удаление пакетов</a></li>
				<li><a href="sys-admin-apt-ru.htm#apt-upgrade">Обновление инсталлированной системы</a></li>
				<li><a href="sys-admin-upgrade-ru.htm#live-cd-upgrade">Системное обновление с LiveCD</a></li>
				<li><a href="sys-admin-kern-upg-ru.htm#kern-upgrade">Обновление ядра</a></li>
				<li><a href="sys-admin-rdiff-ru.htm#rdiff">backup с rdiff</a></li>
				<li><a href="sys-admin-rsync-ru.htm#rsync">backup с rsync</a></li>
				<li><a href="vir-rkits-ru.htm#virus-rkits">Антивирус-программы и сканеры rootkit</a></li>
				<li><a href="sys-admin-gen-ru.htm#start-services">Запуск служб в sidux</a></li>
				<li><a href="sys-admin-gen-ru.htm#pw-lost">Забытый пароль root</a></li>
				<li><a href="sys-admin-gen-ru.htm#fonts">Виды шрифтов</a></li>
				<li><a href="sys-admin-grub-bootman2-ru.htm#mbr-grub-boot">Загрузочный сектор переписан</a></li>
				<li><a href="sys-admin-grub-bootman2-ru.htm#boot-grub-floppy">Создание загрузочной дискеты</a></li>
				<li><a href="sys-admin-grub-bootman2-ru.htm#remove-grub">Удаление grub с загрузочного сектора</a></li>
				<li><a href="sys-admin-grub-bootman2-ru.htm#what-is-grub">Grub - системный загрузчик</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
	<div class="divider" id="ntp-server">
			<h2 id="top-header">Установка сервера времени</h2>


				<p>В консоли как root</p>
<pre>
apt-cache search ntp
apt-get update &amp;&amp; apt-get install  ntp ntp-doc
update-rc.d -f ntp defaults
потом, после выполнения определенной конфигурации run update-rc.d
</pre>

				<p>Где в системе есть документы:</p>
<pre>
/usr/share/doc/ntp-doc/html/index.html 
и закладками это!
</pre>


				<p>Это обширная документация, и не все элементы этой документации должны быть релевантными для актуально поставленной задачи.</p>

				<p>ntp активирован только после перезагрузки, но время должно ставиться уже перед перезагрузкой как можно точнее.</p>

				<p>ntp работает как служба и ntpdate уже имеется в наличии&nbsp;в sidux. Активирован ли уже ntp, может проверяться следующим способом:</p>
<pre>
sux
rcconf
(используйте стрелки на клавиатуре для перемещения по списку, и клавишу пространство на месте * для выбора службы)
</pre>
				<p>ntp получает временной сигнал с одного из в /etc/ntp.conf перечисленного сервера. Этот файл может редактироваться.</p>
				<p>Как ntpdate, так и ntpd-Daemon [коротко: ntp] проверяют список временных серверов в /etc/ntp.conf начиная с первой записи. Здесь примерный список:</p>

<pre>
# pool.ntp.org maps to more than 100 low-stratum NTP servers.
# Your server will pick a different set every time it starts up.
#  *** Please consider joining the pool! ***
#  ***  <a href="http://www.pool.ntp.org/#join">http://www.pool.ntp.org/#join</a>  ***
server 192.168.3.24
server ntp.blueyonder.co.uk
server uk.pool.ntp.org
server 1.uk.pool.ntp.org
server 2.uk.pool.ntp.org
server 0.europe.pool.ntp.org
server 1.europe.pool.ntp.org
server 2.europe.pool.ntp.org
</pre>



				<p>Первая запись - это другой компьютер в сети, который&nbsp;точно так же имеет ntp. [IP сервера является 192.168.3.1']</p>
				<p>Вторая запись - это временной сервер интернет-провайдера (ISP), с которым связан этот компьютер (здесь: blueyonder.co.uk).</p>
				<p>Следующие записи являются с uk.pool.ntp.org, несколько временных серверов европейского пула примыкают к этому. Как правило являются серверы имени ISP (isp-nameservers) часто также временным сервером. Это можно проверять с:</p>

<pre>
ntpdate -v
</pre>


				<p>Эта команда не изменяет еще ничего во временной установке, а выдает время этого сервера, что выглядит, например, как указано ниже:</p>
<pre>
# ntpdate -v 192.168.3.24
19 Sep 19:09:27 ntpdate[13329]: ntpdate 4.2.2@1.1532-o Wed Aug  9 12:08:54 UTC 2006 (1)
</pre>


				<p>Затем должно ставиться &nbsp;право к доступу к локальным компьютерам, если это желаемо:</p>
<pre>
# Локальные пользователи могут спрашивать сервер ntp.
restrict 127.0.0.1 nomodify
restrict 192.168.24
</pre>


				<p>Активация временного сервера:</p>
<pre>
# К активации временного сервера в локальной субсети модифицируется следующая строка:
# (Обратите внимание, адрес является только примером. Приспособьте, пожалуйста, к собственной сети!))
broadcast 192.168.3.255
</pre>


				<p>Файл /etc/ntp.conf может казаться особенным, так как он рассматривается системой как diff файл (даже как только на него нажимается). Поэтому должен сначала ntp запуститься, прежде чем ставится время. Конкретно это значит на примере:</p>
<pre>
# ntpdate -u -b uk.pool.ntp.org
19 Sep 19:19:33 ntpdate[15641]: step time server 62.3.200.116 offset 0.001523 sec
</pre>


				<p>В связи с этим запускается ntp как служба, чтобы активировать временной сервер после каждой перезагрузки. Для теста запускается следующая команда:</p>
<pre>
ntpq -pn
</pre>


				<p>Если установка происходила правильно, команда должна была выдавать список похожий на следующий:</p>
<pre>
# ntpq -pn
remote           refid      st t when poll reach   delay   offset  jitter
----------------------------------------------------------------------------
192.168.3.24    .INIT.          16 u    - 1024    0    0.000    0.000   0.000
+194.117.157.4   192.5.41.40      2 u   97  128  377    7.849    1.548  30.157
*82.219.3.1      195.66.241.2     2 u  101  128  377   17.755    0.794  24.722
 82.133.58.132   .INIT.          16 u    - 1024    0    0.000    0.000   0.000
+194.153.168.75  195.66.241.3     2 u   37  128  377   23.475    3.259  12.203
+82.68.126.114   209.81.9.7       2 u  101  128  377   44.567   -1.366  46.922
+194.88.2.88     194.159.73.44    3 u   90  128  377   17.208   -5.569  27.527
+130.226.232.145 213.112.52.151   3 u   89  128  377   62.130   -0.797  39.999
 127.127.1.0     .LOCL.          10 l   18   64  377    0.000    0.000   0.001
 192.168.3.255   .BCST.          16 u    -   64    0    0.000    0.000   0.001
</pre>


				<p>Звезда (*) в третьей строке в этом примере (*82.219.3.1) показывает активный временной сервер, какой просматривается системой как самый подходящий. Он ставит время при использовании порта 123. Примером строки iptables является:</p>
<pre>
# Network Time Protocol (NTP) Server
$IPT -A udp_inbound -p UDP -s 0/0 --destination-port 123 -j ACCEPT
$IPT -A INPUT -j ACCEPT -p tcp --dport 123
</pre>

	</div>
	<div class="spacer25"></div>

</div>
</body>
</html>
