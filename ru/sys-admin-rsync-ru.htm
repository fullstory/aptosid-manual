<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru">
<head>
	<title>Руководство sidux - Срипт rsync-ru</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<!-- Last translation revision by RoEn 30/05/2009 0045 hrs UTC-->
<div id="menu"> <!-- menu starts here ru language maintained by kostiagol, RoEn -->
<!--sidux-manual Operating System Manual menu-version-01.98.2009.12.07 -->
<!-- menu last updated by bluewater 2009.12.07 0330 hrs UTC -->
	<div id="menu-header">
	      <a href="http://sidux.com/"><img src="../lib/logos/manual-sidux-logo.png" title="Главная страница sidux.com, форума и вики" alt="sidux.com logo" /></a>
	</div>
	<ul id="top-list">
		<li><a href="manual-search-ru.htm#search-on"><img src="../lib/logos/manual-search-22x22.png" title="Пойск в руководстве" alt="Search" />Варианты пойска</a> </li>
		<li><a href="http://manual.sidux.com/meta-manual">Обзор ПО рекомендованного сообществом sidux</a></li>
	</ul>
	<div id="flags-2">
			<a href="../flag-index.html"><img src="../lib/logos/sidux-lang-100x64.png" title="Выбор языка - Choose another language" alt="Переключение языка" /></a>
	</div>
	<ul>
		<li  onmouseover="showHide( 1 );" onmouseout="startTime();" ><a href="welcome-ru.htm">Руководство sidux</a>
			<ul class="sub-menu" id="sm1">
				<li><a href="welcome-ru.htm#welcome-gen">Добро пожаловать!</a></li>
				<li><a href="welcome-ru.htm#how-to">Об использовании</a></li>
				<li><a href="welcome-ru.htm#table-contents">Содержание</a></li>
				<li><a href="help-ru.htm#help-gen">Где получить помощь</a></li>
				<li><a href="help-ru.htm#paste">IRC !paste</a></li>
				<li><a href="credits-ru.htm#cred-team">Благодарности</a></li>
				<li><a href="wel-quickstart-ru.htm#welcome-quick">Краткое руководство sidux</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 2 );" onmouseout="startTime();" ><a href="cd-dl-burning-ru.htm">Содержание ISO-образа, выпуски, список зеркал и запись</a>
			<ul class="sub-menu" id="sm2">
				<li><a href="cd-content-ru.htm#cd-content">Содержание ISO-образа и системные требования</a></li>
				<li><a href="sys-admin-release-ru.htm#rolling">Замечания</a></li>
				<li><a href="cd-dl-burning-ru.htm#download-ISO и сsidux">Скачивание ISO-образа и список зеркал</a></li>
				<li><a href="cd-dl-burning-ru.htm#md5">Проверка ISO-образа с md5</a></li>
				<li><a href="cd-dl-burning-ru.htm#burn-nero">Запись ISO-образа в Windows</a></li>
				<li><a href="cd-dl-burning-ru.htm#burn-linux">Запись ISO-образа в Linux</a></li>
				<li><a href="cd-no-gui-burn-ru.htm#burning-no-gui">Скрипт burniso</a></li>
				<li><a href="cd-no-gui-burn-ru.htm#burning-no-gen">Запись ISO-образа в консоли</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 3 );" onmouseout="startTime();" ><a href="live-mode-ru.htm">Режим ISO-образа</a>
			<ul class="sub-menu" id="sm3">
				<li><a href="live-mode-ru.htm#rootpw">Пароль root</a></li>
				<li><a href="live-mode-ru.htm#live-cd-installsoft">ISO-образ: установка ПО</a></li>
				<li><a href="live-mode-ru.htm#ntfs-3g">Запись на раздел NTFS: ntfs-3g</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 4 );" onmouseout="startTime();" ><a href="term-konsole-ru.htm">Терминал и оболочка</a>
			<ul class="sub-menu" id="sm4">
				<li><a href="term-konsole-ru.htm#sux"> Команда:  sux / sudo</a></li>
				<li><a href="term-konsole-ru.htm#term-kon">Терминал и оболочка</a></li>
				<li><a href="term-konsole-ru.htm#cli-help">Помощь в терминале</a></li>
				<li><a href="help-ru.htm#init3-tools">Полезные инструменты в текстовом режиме (tty) - init 3</a></li>
				<li><a href="term-konsole-ru.htm#term-cmds">Команды в терминале</a></li>
				<li><a href="term-konsole-ru.htm#shell-scripts">"Скрипт scripts.sh"</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 5 );" onmouseout="startTime();" ><a href="cheatcodes-ru.htm">Чит-коды</a>
			<ul class="sub-menu" id="sm5">
				<li><a href="cheatcodes-ru.htm#cheatcodes">Особые для sidux ISO-образа чит-коды</a></li>
				<li><a href="cheatcodes-ru.htm#cheatcodes-linux">Общие для параметров ядра чит-коды</a></li>
				<li><a href="cheatcodes-vga-ru.htm#vga">Общие для видеокарты коды</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 6 );" onmouseout="startTime();" ><a href="part-gparted-ru.htm">Разметка диска</a>
			<ul class="sub-menu" id="sm6">
				<li><a href="part-gparted-ru.htm#partition">Разметка диска: GParted</a></li>
				<li><a href="part-gparted-ru.htm#ntfs">Разделы NTFS: GParted</a></li>
				<li><a href="part-uuid-ru.htm#uuid">Актуализация, UUID и метки раздела: fstab </a></li>
				<li><a href="part-cfdisk-ru.htm#disknames">Имена жестких дисков</a></li>
				<li><a href="part-cfdisk-ru.htm#partition">Разметка диска: cfdisk</a></li>
				<li><a href="part-cfdisk-ru.htm#formating">Форматирование разделов</a></li>
				<li><a href="part-size-examp-ru.htm#part-example">Примеры разметки диска</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 7 );" onmouseout="startTime();" ><a href="hd-install-ru.htm">Установка sidux</a>
			<ul class="sub-menu" id="sm7">
				<li><a href="hd-install-ru.htm#Inst-prep">Подготовка</a></li>
				<li><a href="hd-install-ru.htm#Installation">Инсталляция на HD</a></li>
				<li><a href="hd-install-ru.htm#first-hd-boot">Первая загрузка</a></li>
				<li><a href="hd-install-opts-ru.htm#fromiso">Инсталляция 'fromiso' - Overview</a></li>
				<li><a href="hd-install-opts-ru.htm#fromiso-grub-leg">Booting 'fromiso' with grub-legacy</a></li>
				<li><a href="hd-install-opts-ru.htm#grub2-fromiso">Booting 'fromiso' with Grub 2</a></li>
				<li><a href="hd-install-opts-ru.htm#fromiso-persist">Способы 'fromiso' и 'persist'</a></li>
				<li><a href="hd-install-opts-ru.htm#usb-hd">Инсталляция на USB-HD</a></li>
				<li><a href="hd-install-opts-ru.htm#vtbox">Инсталляция в VirtualBox</a></li>
				<li><a href="hd-install-opts-ru.htm#qemu">Инсталляция в QEMU</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 8 );" onmouseout="startTime();" ><a href="hw-dev-hw-dri-ru.htm">Оборудование, &amp; Xorg</a>
			<ul class="sub-menu" id="sm8">
				<li><a href="hw-dev-hw-dri-ru.htm#hd-ntfs3g">Запись на раздел NTFS: ntfs-3g</a></li>
				<li><a href="hw-dev-mon-ru.htm#mon-res">Разрешение экрана и мониторы</a></li>
				<li><a href="hw-dev-mon-ru.htm#xrandr">Двойные экраны и xrandr</a></li>
				<li><a href="hw-dev-mon-ru.htm#mon-binary">Двойные экраны (используя двоичные файлы)</a></li>
				<li><a href="hw-dev-hw-dri-ru.htm#non-free-3d">Драйверы от NVIDIA &amp; xorg.conf</a></li>
				<li><a href="hw-dev-hw-dri-ru.htm#non-free-3d-2">Несвободные драйверы для ATI, Radeon и других</a></li>
				<li><a href="hw-dev-hw-dri-ru.htm#non-free-firmware">Аппаратное, нуждающееся в несвободной микропрограмме</a></li>
				<li><a href="hw-dev-hw-dri-ru.htm#non-free">Добавление 'non-free' в файл sources.list</a></li>
				<li><a href="hw-dev-hw-dri-ru.htm#native-nv-ati">Свободные драйверы xorg для nVidia, ATI, Radeon и Intel &amp; xorg.conf</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 9 );" onmouseout="startTime();" ><a href="wm-kde-ru.htm">Оконный менеджер</a>
			<ul class="sub-menu" id="sm9">
				<li><a href="wm-xfce-ru.htm#xfce-notes">Полезные инструменты для Xfce</a></li>
				<li><a href="wm-kde-ru.htm#install-add">Полезные инструменты для KDE</a></li>
				<li><a href="wm-kde-ru.htm#desk-freeze">Рабочий стол зависает</a></li>
				<li><a href="wm-kde-ru.htm#kde-login">Проблемы входа в KDE</a></li>
				<li><a href="wm-kde-ru.htm#ch-th">Управление темами</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 10 );" onmouseout="startTime();" ><a href="lamp-apache-ru.htm">Мета-пакет LAMP</a>
			<ul class="sub-menu" id="sm10">
				<li><a href="lamp-apache-ru.htm#serv-apache">Что такое LAMP</a></li>
				<li><a href="lamp-apache-ru.htm#serv-ftp">Клиенты FTP</a></li>
				<li><a href="lamp-apache-ru.htm#serv-sec">Защищенные протоколы</a></li>
				<li><a href="lamp-apache-ru.htm#serv-ssl">SSL</a></li>
				<li><a href="lamp-sql-ru.htm#serv-mysql">Установка MySQL</a></li>
				<li><a href="lamp-ppp-ru.htm#serv-php">PHP и Apache</a></li>
				<li><a href="ntp-server-ru.htm#ntp-server">Сервер времени</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 11 );" onmouseout="startTime();" ><a href="internet-connecting-ru.htm">Интернет и локальная сеть</a>
			<ul class="sub-menu" id="sm11">
				<li><a href="tor-privoxy-ru.htm#tor">Маршрутизатор Tor</a></li>
				<li><a href="tor-privoxy-ru.htm#privoxy"> Веб-прокси Privoxy</a></li>
				<li><a href="internet-connecting-ru.htm#firewalls">Брандмауэры</a></li>
				<li><a href="samba-ru.htm#configure">Интеграции в сеть Windows</a></li>
				<li><a href="samba-ru.htm#setup">Сервер Samba</a></li>
				<li><a href="ssh-ru.htm#ssh-fs">Удаленное монтирование: SSH</a></li>
				<li><a href="ssh-ru.htm#ssh-x">Приложения X-Windows: SSH</a></li>
				<li><a href="ssh-ru.htm#ssh-f">SSH и Konqueror</a></li>
				<li><a href="ssh-ru.htm#ssh-w">SSH X-Forwarding</a></li>
				<li><a href="ssh-ru.htm#ssh">Безопасность с SSH</a></li>
				<li><a href="internet-connecting-ru.htm#dial-mod">56килобитовые модемы</a></li>
				<li><a href="internet-connecting-wpagui-ru.htm#wpa-roaming-gui">WiFi - roaming WPA-GUI</a></li>
				<li><a href="internet-connecting-wpa-ru.htm#wpa-basic">WiFi - основные конфигурации</a></li>
				<li><a href="internet-connecting-wpa-ru.htm#wpa">WiFi - wpasupplicant</a></li>
				<li><a href="internet-connecting-ru.htm#netcardconfig">Настройка сетевых карт - Ceni</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 12 );" onmouseout="startTime();" ><a href="sys-admin-apt-ru.htm">Обновление системы и  управление пакетами</a>
			<ul class="sub-menu" id="sm12">
				<li><a href="sys-admin-apt-ru.htm#apt-cook">APT и репозитории</a></li>
				<li><a href="sys-admin-apt-ru.htm#apt-install">Установка</a></li>
				<li><a href="sys-admin-apt-ru.htm#apt-delete">Удаление</a></li>
				<li><a href="sys-admin-apt-ru.htm#apt-downgrade">Понижение hold версии</a></li>
				<li><a href="sys-admin-apt-ru.htm#apt-cache">Поиск информации о пакете</a></li>
				<li><a href="sys-admin-apt-ru.htm#gui-pacsea">Пакет поиска информации о </a></li>
				<li><a href="siduxcc-ru.htm#siduxcc">Центр управления</a></li>
				<li><a href="sys-admin-upgrade-ru.htm#live-cd-upgrade">Обновление с Live ISO</a></li>
				<li><a href="sys-admin-apt-locarmirr-ru.htm#approx">Обновление нескольких компьютерах в локальной сети</a></li>
				<li><a href="sys-admin-kern-upg-ru.htm#kern-upgrade">Обновление ядра</a></li>
				<li><a href="sys-admin-apt-ru.htm#apt-upgrade">Краткий обзор oбновления системы - dist-upgrade</a></li>
				<li><a href="sys-admin-apt-ru.htm#du-st">Шаги обновления системы -  dist-upgrade</a></li>
			</ul>
		</li>
		<li  onmouseover="showHide( 13 );" onmouseout="startTime();" ><a href="sys-admin-gen-ru.htm">Системное администрирование</a>
			<ul class="sub-menu" id="sm13">
				<li><a href="hd-install-ru.htm#adduser">Добавление нового пользователя</a></li>
				<li><a href="home-ru.htm#home-bu">Перемещение /home</a></li>
				<li><a href="siduxcc-ru.htm#siduxcc">sidux центр управления</a></li>
				<li><a href="sys-admin-rdiff-ru.htm#rdiff">Резервирование: rdiff</a></li>
				<li><a href="sys-admin-rsync-ru.htm#rsync">Резервирование: rsync</a></li>
				<li><a href="vir-rkits-ru.htm#virus-rkits">Сканер безопасности</a></li>
				<li><a href="sys-admin-gen-ru.htm#start-services">Выбор служб</a></li>
				<li><a href="sys-admin-gen-ru.htm#pw-lost">Восстановление root-пароля</a></li>
				<li><a href="sys-admin-gen-ru.htm#fonts">Шрифты</a></li>
				<li><a href="sys-admin-gen-ru.htm#cups">Сервер CUPS</a></li>
				<li><a href="sys-admin-gen-ru.htm#sound">Sound Mixers</a></li>
				<li><a href="sys-admin-gen-ru.htm#init">sidux режимы загрузки - init</a></li>
				<li><a href="bios-freedos-ru.htm#bois-prep">Обновление BIOS с FreeDOS</a></li>
				<li><a href="sys-admin-grub-bootman2-ru.htm#boot-grub-floppy">Загрузочная дискета</a></li>
				<li><a href="sys-admin-grub-bootman2-ru.htm#mbr-grub-boot">Grub1 - Восстановление MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-ru.htm#dual-boot">Grub1 - Мультизагрузка</a></li>
				<li><a href="sys-admin-grub-bootman2-ru.htm#remove-grub">Удаление GRUB из MBR</a></li>
				<li><a href="sys-admin-grub-bootman2-ru.htm#what-is-grub">Менеджер загрузки GRUB</a></li>
				<li><a href="sys-admin-grub2-ru.htm#chroot">Grub2 - MBR Overwritten</a></li>
				<li><a href="sys-admin-grub2-ru.htm#multi-os">Grub2 - Dual and Multibooting</a></li>
				<li><a href="sys-admin-grub2-ru.htm#grub1-grub2">Grub2 -Upgrading from Grub1</a></li>
				<li><a href="sys-admin-grub2-ru.htm#grub2">Grub2 - Overview</a></li>
			</ul>
		</li>
	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
	<div class="divider" id="rsync">
			<h2 id="top-header">Резервное копирование с rsync</h2>
							<p>Rsync является утилитой для синхронизации файлов и их резервного копирования. Она работает на многих *nix системах).</p>
							
							 <p class="highlight-2">Ограничение rsync состоит в том, что данные не могут копироваться между 2 удалёнными (remote) системами. В этом случае Вам пришлось бы скопировать данные с одной удалённой системы, а потом перенести на другую.</p>
							
							 <p>В sidux у Вас есть различные возможности запускать процесс синхронизации. Можете запускать rsync командой в терминале, либо установите дополнительные пакеты из Debian Sid:</p>
							 
				<h5>Чтобы установить deb пакет:</h5>
<pre>
apt-get install luckybackup
</pre>
							<p><a href="http://luckybackup.sourceforge.net/">Дополнительную информацию о luckybackup найдете на его веб-странице.</a></p>

				    <h6>Инструкция по использованию в терминале</h6>
							<p>В следующем разделе мы представляем rsync, возможности этой программы и несколько примеров, как rsync может использоваться с собственным скриптом резервного копирования.</p>

				<p>rsync является программой быстрого резервного &nbsp;копирования каталогов и файлов. rsync при этом вычисляет измененные файлы и каталоги с помощью таких атрибутов, как величина или дата, вследствие чего&nbsp;синхронизация может быть очень быстрой. Данные архивируются перед копированием и распаковываются в пункте назначения.</p>

				<p>rsync может копировать данные:<br />* с локальной системы на локальную систему,<br />* с локальной системы на удалённую (remote) систему, <br />* с удаленной (remote) системы на локальную систему.</p>
				<p>При этом использует клиент <a href="ssh-ru.htm">ssh</a> (входит в основную установку), либо rsync-daemon, которые работают на исходной и на целевой системе. В manpages rsync говорится, если системы&nbsp;могут связываться по ssh, ssh также может использоваться для rsync.</p>

				<p class="highlight-3">Ограничение с rsync состоит в том, что данные не могут копироваться между 2 удалёнными (remote) системами. В этом случае Вам придётся скопировать данные с одной удалённой системы, а потом перенести с rsync на другую.</p>

				<p>Чтобы пояснить это, рассмотрим следующий пример с 3 компьютерами:</p>
<pre>
neo – локальная система
morpheus – удаленная система
trinity – удаленная система
</pre>
				<p>
          Каждый пользователь знает имя другого пользователя, и rsync работает исключительно на neo, локальной системе:
        </p>
<pre>
Имя пользователя на neo является cuddles,
Имя пользователя на morpheus является tartie,
Имя пользователя на trinity является taylar.
</pre>
				<p>Целью является синхронизация каталогов /home/$user/Daten:</p>

<pre>
neo:/home/cuddles/данные с morpheus и trinity,
morpheus:/home/tartie/данные с neo и trinity,
trinity:/home/taylar/данные с neo и morpheus.
</pre>

				<p>Теперь возникает проблема, что rsync не может быть применён между 2 удалёнными
компьютерами:</p>

				
<pre>
neo-&gt; morpheus - с локальной на удалённую, получится
neo-&gt; trinity - с локальной на удалённую, получится
morpheus-&gt; neo - с отдаленной на локальную, получится
trinity-&gt; neo - с отдаленной на локальную, получится
morpheus-&gt; trinity - нельзя, с удалённой на удаленную
trinity-&gt; morpheus - нельзя, с удалённой на удаленную
</pre>
				<p>Чтобы обойти это ограничение, поступаем как указано ниже:</p>
<pre>
morpheus --&gt; trinity - станет: morpheus --&gt; neo и neo --&gt; trinity
trinity --&gt; morpheus - станет: trinity --&gt; neo и neo --&gt; morpheus
</pre>
				<p>Этот дополнительный шаг не изменяет ничего в конечном итоге. Тем не менее, указывает на то, что:</p>

				<p class="highlight-3">Это ограничение с rsync должно быть учтено при планировании процесса резервного копирования.</p>

				<h5>Применение имён хоста&nbsp;с именами хоста в rsync.</h5>

				<p>Применение имён хостов neo, morpheus, и trinity, вместо IP-адресов, может позволить сделать процесс копирования нагляднее и Вам будет легче разобраться.</p>

				<p>Для этого должны отредактировать /etc/hosts и вставить имена хостов и ему принадлежащие IP-адреса. Таким образом в нашем примере файл /etc/hosts будет выглядеть так:</p>
<pre>
192.168.1.15 neo
192.168.1.16 morpheus
192.168.1.17 trinity
</pre>
				<p>Первая строка переводит IP-адрес 192.168.1.15 на “neo”, вторая 192.168.1.16 на “morpheus” и третья 192.168.1.17 на “trinity”. После записи может использоваться дополнительно имя хоста вместо IP-адреса. Этот особенно удобно, если изменяются распределённые IP-адреса, например, у "neo" с 192.168.1.15 на 192.168.1.25 Это облегчает работу со скриптами, так как они в случае изменения IP-адресов не должны изменяться, а только файл /etc/hosts.</p>

				<h4>Два способа использования rsync.</h4>

				<p>Первый способ - данные <b>“толкают (push)”</b> на целевую машину; другой - данные <b>“вытягиваются (pull)”</b> с источника. Каждый метод имеет свои за и&nbsp;против, которые будут рассмотрены ниже. В нашем примере используются локальная и удаленная системы, чтобы более отчетливо объяснить терминологию.</p>

				<p><b>“push”</b> - локальная система несет исходные каталоги и файлы, целью&nbsp;является удаленная система. Команда rsync запускается на локальной системе и "толкает" данные на целевую систему.</p>

				<p>Преимущества:<br /> &nbsp;* Больше чем одна исходная система может иметь резервное копирование на целевой. &nbsp;* Процесс резервного копирования на нескольких компьютерах может проходить одновременно. &nbsp;* Если система заканчивает процесс резервного копирования быстрее, это позволяет использовать ресурсы для других заданий.</p>

				<p>Недостатки:<br /> &nbsp;* Если скрипт используется с синхронизацией через cron, то crontab-ы должны задаваться на каждой системе. При модификации скрипта необходимо вносить соответствующие изменения на каждой системе, при изменениях календарного плана должен изменяться каждый crontab на каждом компьютере. Вследствие этого административное обслуживание становится очень громоздким и запутанным. * Процесс резервного копирования не возможно проверить, был ли целевой раздел смонтирован целевой системой. Если он не смонтирован, резервного копирования не произойдёт.</p>

				<p><b>“pull”</b> - удаленная система несет исходные каталоги и файлы, целью является локальная система. Команда rsync запускается на локальной системе и "вытягивает" данные из исходной системы.</p>

				<p>Преимущества:<br /> * Система станет сервером, который управляет всеми процессами резервного копирования всех других систем. Процессы резервного копирования централизуются.<br /> * При применении скрипта, он должен находится только на одной системе, что упрощает любые модификации. При изменении календарного плана должен изменяться только один crontab.<br /> * Скрипт может проверить, смонтирован ли целевой раздел и при случае его смонтирует.</p>

				<h5>Синтаксис&nbsp;rsync (часть&nbsp;из "man rsync"):</h5>
<pre>
       rsync [OPTION]... SRC [SRC]... DEST

       rsync [OPTION]... SRC [SRC]... [USER@]HOST:DEST

       rsync [OPTION]... SRC [SRC]... [USER@]HOST::DEST

       rsync [OPTION]... SRC [SRC]... rsync://[USER@]HOST[:PORT]/DEST

       rsync [OPTION]... SRC

       rsync [OPTION]... [USER@]HOST:SRC [DEST]

       rsync [OPTION]... [USER@]HOST::SRC [DEST]

       rsync [OPTION]... rsync://[USER@]HOST[:PORT]/SRC [DEST]
</pre>
				<h5>Рабочие примеры команд rsync:</h5>
<pre>
rsync -agEvz --delete-after --exclude=”*~” morpheus:/home/tartie /media/sda7/SysBackups/morpheus/home
</pre>
				<p>Объяснение составных частей этой команды:</p>
<pre>
Источник: (/путь/файл)  morpheus:/home/tartie,   целью является: /media/sda7/SysBackups/morpheus/home
</pre>
				<p>Каталог/home/tartie (включая подкаталоги) будет сохранен в /media/sda7/SysBackups/morpheus/home, что после rsync будет выглядеть таким образом:</p>
<pre>
/media/sda7/SysBackups/morpheus/home/tartie
</pre>
				<p>Обратите внимание, копируется только каталог /tartie, в путь указанный rsync /media/sda7/SysBackups/morpheus/home. "Источник" выбирает только, откуда прибывают данные, а "Цель" указывает rsync, куда должны копироваться данные из "источника" он воспринимает уже не /home/tartie, а просто /tartie, направить в /media/sda7/SysBackups/morpheus/home. Ещё пример:</p>
<pre>
rsync [...] /home/user/data/files /media/sda7/SysBackups/neo
</pre>
				<p>Здесь будет копироваться исходный каталог /files и все в нём находящиеся каталоги и файлы в целевую папку /media/sda7/SysBackups/neo/ &nbsp;- а не в /media/sda7/SysBackups/neo/home/user/data/files.</p>

				<p>На это необходимо обращать внимание при использовании резервного копирования с rsync.</p>

				<h5>Объяснение опций (черновой перевод из англоязычного "man rsync"):</h5>
<pre>
-a для способа с архивацией. manpage по этому поводу говорит: “проще говоря, этот метод, для создания рекурсивного резервного копирования и копирования почти всех атрибутов. Не сохраняются только жёсткие ссылки &nbsp;из-за сложности процесса. Опция -a соответствует: -rlptgoD, что это значит:
  -r = rekursiv - копировать подкаталоги и файлы в них из "исходного места".
  -l = Links - символические ссылки восстанавливаются в пункте назначения.
  -p = права - права идентичны с ними в исходном месте.
  -t = временной штамп - временной штамп в исходном месте идентичен с ним .
  -q = quiet - минимальный вывод информации. Большее количество информации получают с опцией -v после опции -a. Выполнение без какого-либо ответа будет достигнуто без постановки опции -v.
  -o = владелец - если rsync проводится как root, владельцы исходных файлов остаются соответствующим образом сохранёнными.
-D = соответствует этим обеим командам: --devices --specials
 --devices = символьные файлы и файлы блочного устройства будут копироваться в удаленную систему, чтобы затем восстанавливаться. Нужно обратить внимание, что без опции --super , опция --devices не работает.
 --specials = rsync копирует специальные файлы как sockets и fifos.
--g: группы сохраняются соответственно исходным файлам.
-E: сохраняется атрибут "выполнимо".
-v: для подробного вывода. Если подробности не важны, эта опция может быть опущена. Тем не менее, если необходимо видеть, что&nbsp;происходит, эта опция очень полезна.
-z: копируемые данные архивируются, что ускоряет копировальный процесс, так как перемещённый объем данных будет меньше.
--delete-after= целевые каталоги или целевые файлы, которых больше нет в источнике, удаляются после перемещения, а не перед этим. В случае проблем или катастроф будет “after” использован&nbsp;, "delete” предотвращает использование лишнего пространства больше ненужными файлами и каталогами в пункте назначения.
-- exclude = указывает на файлы или каталоги исключаемые из копировального процесса. В примере, --exclude = “*~” были бы ВСЕ файлы с окончанием “~” из процесса резервного копирования исключены. С одной опцией --exclude может передаваться только один аргумент, при большем количестве&nbsp;аргументов исключения необходимо использовать несколько опций --exclude.
</pre>
				<h5>Дополнительные команды:</h5>
<pre>
-c - проводит дальнейшие сравнительные проверки, что требует большого времени. Так как rsync уже проводит сравнительные проверки, эта команда не была интегрирована в --a из-за её избыточности, а также для экономии времени. В этой опции, как правило, нет нужды.
--super - целевая система попытается проводить действия суперпользователя (root) (смотрите manpage)
--dry-run - тестовый запуск: просто показывает, что должно копироваться. Никакие файлы не копируются.
</pre>
				<p>И напоследок, варианты указания исходных и целевых каталогов.</p>

				<h5>Примерные команды:</h5>
<pre>
rsync -agEvz --delete-after --exclude=”*~” morpheus:/home/tartie /media/sda7/SysBackups/morpheus/home
</pre>
				<p>Эта команда копирует все каталоги и файлы ниже от /home/tartie на систему "morpheus" и размещает их в этот каталог /media/sda7/SysBackups/morpheus/home. Структура каталога tartie сохраняется.</p>
<pre>
rsync -agEvz --delete-after --exclude=”*~” /home/tartie neo:/media/sda7/SysBackups/morpheus/home
</pre>
				<p>Это - противоположная команда первого примера. Она "двигает" каталог /home/tartie и его содержание в указанный каталог системы "neo" - отметим, что систему рассматривают как "удаленную (remote)", если ставится “:” двоеточие перед путем.</p>
<pre>
rsync -agEvz --delete-after --exclude=”*~” /home/cuddles /media/sda7/SysBackups/neo/home
</pre>
				<p>Это - процесс резервного копирования на локальном компьютере. Здесь нужно обращать внимание на то, что никакое двоеточие не установлено. Локальный каталог /home/cuddles копируется на /media/sda7/SysBackups/neo/home на том же самом локальном компьютере.</p>

				<h5>rsync с многими опциями --exclude:</h5>
<pre>
rsync -agEvz --delete-after --exclude=”*~” --exclude=”*.c” --exclude=”*.o” "/*" /media/sda7/SysBackups/neo
</pre>
				<p>Эта команда копирует все из каталога root локальной системы (все каталоги и файлы) на /media/sda7/SysBackups/neo - исключенными из этого являются все файлы и каталоги, которые кончаются на “~”, “.c” или “.o”.</p>

				<h5>Замена имени хоста IP-адресом:</h5>

				<p>Первая команда установлена с методом имени хоста, второй с методом IP-адресов. Обе команды идентичны в своём выполнении:</p>
<pre>
rsync -agEvz --delete-after --exclude=”*~” morpheus:/home/tartie /media/sda7/SysBackups/morpheus/home
</pre>
<pre>
rsync -agEvz --delete-after --exclude=”*~” 192.168.1.16:/home/tartie /media/sda7/SysBackups/morpheus/home
</pre>
				<p>Метод имён хоста не должен применяться, но по нашему мнению он упрощает резервное копирование с rsync в сетях.</p>

				<h5 class="highlight-2">Невозможная команда:</h5>
<pre>
rsync -agEvz --delete-after --exclude=”*~” morpheus:/home/tartie trinity:/home
</pre>
				
				<p class="highlight-2">Как было уже сказано, ограничение rsync в том, что этой командой нельзя копировать между 2 удаленными компьютерами. На это мы бы хотели еще раз обратить внимание.</p>

				<p>Мы надеемся, с этим маленьким руководством Вам будет легче приступить к использованию rsync, это очень удачная программа резервного копирования.</p>
	</div>
			<div id="rev">Содержание, последний раз пересмотрено 28/05/2009 0915 UTC</div>


</div>
</body>
</html>
